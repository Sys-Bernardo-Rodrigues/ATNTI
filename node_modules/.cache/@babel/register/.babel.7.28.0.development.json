{"{\"assumptions\":{},\"sourceRoot\":\"/home/bernardo/sistema-atendimento-ti/ATNTI/test/\",\"caller\":{\"name\":\"@babel/register\"},\"cwd\":\"/home/bernardo/sistema-atendimento-ti/ATNTI\",\"filename\":\"/home/bernardo/sistema-atendimento-ti/ATNTI/test/auth.test.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/home/bernardo/sistema-atendimento-ti/ATNTI\",\"rootMode\":\"root\",\"plugins\":[],\"presets\":[]}:7.28.0:development":{"value":{"code":"const chai = require('chai');\nconst chaiHttp = require('chai-http');\nconst app = require('../src/index'); // Importe a sua aplicação Express\nconst expect = chai.expect;\n\n// Configura o chai para usar o plugin de requisições HTTP\nchai.use(chaiHttp);\ndescribe('API de Autenticação', () => {\n  it('deve retornar um token e dados do usuário ao fazer login com sucesso', async () => {\n    const res = await chai.request(app).post('/login').send({\n      email: 'admin@ti.com',\n      // Use um e-mail de um usuário que você criou\n      senha: 'senha123' // Use a senha correta\n    });\n\n    // Asserções para a resposta\n    expect(res).to.have.status(200);\n    expect(res.body).to.have.property('token');\n    expect(res.body.usuario).to.have.property('id');\n    expect(res.body.usuario).to.have.property('nome');\n    expect(res.body.usuario).to.have.property('email').to.equal('usuario.existente@exemplo.com');\n  });\n  it('deve retornar 401 para credenciais inválidas', async () => {\n    const res = await chai.request(app).post('/login').send({\n      email: 'usuario.nao.existe@exemplo.com',\n      senha: 'senha_incorreta'\n    });\n\n    // Asserção para o status de erro\n    expect(res).to.have.status(401);\n    expect(res.body).to.have.property('erro').to.equal('Email ou senha inválidos');\n  });\n});\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJjaGFpIiwicmVxdWlyZSIsImNoYWlIdHRwIiwiYXBwIiwiZXhwZWN0IiwidXNlIiwiZGVzY3JpYmUiLCJpdCIsInJlcyIsInJlcXVlc3QiLCJwb3N0Iiwic2VuZCIsImVtYWlsIiwic2VuaGEiLCJ0byIsImhhdmUiLCJzdGF0dXMiLCJib2R5IiwicHJvcGVydHkiLCJ1c3VhcmlvIiwiZXF1YWwiXSwic291cmNlUm9vdCI6Ii9ob21lL2Jlcm5hcmRvL3Npc3RlbWEtYXRlbmRpbWVudG8tdGkvQVROVEkvdGVzdC8iLCJzb3VyY2VzIjpbImF1dGgudGVzdC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBjaGFpID0gcmVxdWlyZSgnY2hhaScpO1xuY29uc3QgY2hhaUh0dHAgPSByZXF1aXJlKCdjaGFpLWh0dHAnKTtcbmNvbnN0IGFwcCA9IHJlcXVpcmUoJy4uL3NyYy9pbmRleCcpOyAvLyBJbXBvcnRlIGEgc3VhIGFwbGljYcOnw6NvIEV4cHJlc3NcbmNvbnN0IGV4cGVjdCA9IGNoYWkuZXhwZWN0O1xuXG4vLyBDb25maWd1cmEgbyBjaGFpIHBhcmEgdXNhciBvIHBsdWdpbiBkZSByZXF1aXNpw6fDtWVzIEhUVFBcbmNoYWkudXNlKGNoYWlIdHRwKTtcblxuZGVzY3JpYmUoJ0FQSSBkZSBBdXRlbnRpY2HDp8OjbycsICgpID0+IHtcbiAgaXQoJ2RldmUgcmV0b3JuYXIgdW0gdG9rZW4gZSBkYWRvcyBkbyB1c3XDoXJpbyBhbyBmYXplciBsb2dpbiBjb20gc3VjZXNzbycsIGFzeW5jICgpID0+IHtcbiAgICBjb25zdCByZXMgPSBhd2FpdCBjaGFpLnJlcXVlc3QoYXBwKVxuICAgICAgLnBvc3QoJy9sb2dpbicpXG4gICAgICAuc2VuZCh7XG4gICAgICAgIGVtYWlsOiAnYWRtaW5AdGkuY29tJywgLy8gVXNlIHVtIGUtbWFpbCBkZSB1bSB1c3XDoXJpbyBxdWUgdm9jw6ogY3Jpb3VcbiAgICAgICAgc2VuaGE6ICdzZW5oYTEyMycgICAgICAgICAgICAgICAgICAgICAgIC8vIFVzZSBhIHNlbmhhIGNvcnJldGFcbiAgICAgIH0pO1xuXG4gICAgLy8gQXNzZXLDp8O1ZXMgcGFyYSBhIHJlc3Bvc3RhXG4gICAgZXhwZWN0KHJlcykudG8uaGF2ZS5zdGF0dXMoMjAwKTtcbiAgICBleHBlY3QocmVzLmJvZHkpLnRvLmhhdmUucHJvcGVydHkoJ3Rva2VuJyk7XG4gICAgZXhwZWN0KHJlcy5ib2R5LnVzdWFyaW8pLnRvLmhhdmUucHJvcGVydHkoJ2lkJyk7XG4gICAgZXhwZWN0KHJlcy5ib2R5LnVzdWFyaW8pLnRvLmhhdmUucHJvcGVydHkoJ25vbWUnKTtcbiAgICBleHBlY3QocmVzLmJvZHkudXN1YXJpbykudG8uaGF2ZS5wcm9wZXJ0eSgnZW1haWwnKS50by5lcXVhbCgndXN1YXJpby5leGlzdGVudGVAZXhlbXBsby5jb20nKTtcbiAgfSk7XG5cbiAgaXQoJ2RldmUgcmV0b3JuYXIgNDAxIHBhcmEgY3JlZGVuY2lhaXMgaW52w6FsaWRhcycsIGFzeW5jICgpID0+IHtcbiAgICBjb25zdCByZXMgPSBhd2FpdCBjaGFpLnJlcXVlc3QoYXBwKVxuICAgICAgLnBvc3QoJy9sb2dpbicpXG4gICAgICAuc2VuZCh7XG4gICAgICAgIGVtYWlsOiAndXN1YXJpby5uYW8uZXhpc3RlQGV4ZW1wbG8uY29tJyxcbiAgICAgICAgc2VuaGE6ICdzZW5oYV9pbmNvcnJldGEnXG4gICAgICB9KTtcbiAgICAgIFxuICAgIC8vIEFzc2Vyw6fDo28gcGFyYSBvIHN0YXR1cyBkZSBlcnJvXG4gICAgZXhwZWN0KHJlcykudG8uaGF2ZS5zdGF0dXMoNDAxKTtcbiAgICBleHBlY3QocmVzLmJvZHkpLnRvLmhhdmUucHJvcGVydHkoJ2Vycm8nKS50by5lcXVhbCgnRW1haWwgb3Ugc2VuaGEgaW52w6FsaWRvcycpO1xuICB9KTtcbn0pOyJdLCJtYXBwaW5ncyI6IkFBQUEsTUFBTUEsSUFBSSxHQUFHQyxPQUFPLENBQUMsTUFBTSxDQUFDO0FBQzVCLE1BQU1DLFFBQVEsR0FBR0QsT0FBTyxDQUFDLFdBQVcsQ0FBQztBQUNyQyxNQUFNRSxHQUFHLEdBQUdGLE9BQU8sQ0FBQyxjQUFjLENBQUMsQ0FBQyxDQUFDO0FBQ3JDLE1BQU1HLE1BQU0sR0FBR0osSUFBSSxDQUFDSSxNQUFNOztBQUUxQjtBQUNBSixJQUFJLENBQUNLLEdBQUcsQ0FBQ0gsUUFBUSxDQUFDO0FBRWxCSSxRQUFRLENBQUMscUJBQXFCLEVBQUUsTUFBTTtFQUNwQ0MsRUFBRSxDQUFDLHNFQUFzRSxFQUFFLFlBQVk7SUFDckYsTUFBTUMsR0FBRyxHQUFHLE1BQU1SLElBQUksQ0FBQ1MsT0FBTyxDQUFDTixHQUFHLENBQUMsQ0FDaENPLElBQUksQ0FBQyxRQUFRLENBQUMsQ0FDZEMsSUFBSSxDQUFDO01BQ0pDLEtBQUssRUFBRSxjQUFjO01BQUU7TUFDdkJDLEtBQUssRUFBRSxVQUFVLENBQXVCO0lBQzFDLENBQUMsQ0FBQzs7SUFFSjtJQUNBVCxNQUFNLENBQUNJLEdBQUcsQ0FBQyxDQUFDTSxFQUFFLENBQUNDLElBQUksQ0FBQ0MsTUFBTSxDQUFDLEdBQUcsQ0FBQztJQUMvQlosTUFBTSxDQUFDSSxHQUFHLENBQUNTLElBQUksQ0FBQyxDQUFDSCxFQUFFLENBQUNDLElBQUksQ0FBQ0csUUFBUSxDQUFDLE9BQU8sQ0FBQztJQUMxQ2QsTUFBTSxDQUFDSSxHQUFHLENBQUNTLElBQUksQ0FBQ0UsT0FBTyxDQUFDLENBQUNMLEVBQUUsQ0FBQ0MsSUFBSSxDQUFDRyxRQUFRLENBQUMsSUFBSSxDQUFDO0lBQy9DZCxNQUFNLENBQUNJLEdBQUcsQ0FBQ1MsSUFBSSxDQUFDRSxPQUFPLENBQUMsQ0FBQ0wsRUFBRSxDQUFDQyxJQUFJLENBQUNHLFFBQVEsQ0FBQyxNQUFNLENBQUM7SUFDakRkLE1BQU0sQ0FBQ0ksR0FBRyxDQUFDUyxJQUFJLENBQUNFLE9BQU8sQ0FBQyxDQUFDTCxFQUFFLENBQUNDLElBQUksQ0FBQ0csUUFBUSxDQUFDLE9BQU8sQ0FBQyxDQUFDSixFQUFFLENBQUNNLEtBQUssQ0FBQywrQkFBK0IsQ0FBQztFQUM5RixDQUFDLENBQUM7RUFFRmIsRUFBRSxDQUFDLDhDQUE4QyxFQUFFLFlBQVk7SUFDN0QsTUFBTUMsR0FBRyxHQUFHLE1BQU1SLElBQUksQ0FBQ1MsT0FBTyxDQUFDTixHQUFHLENBQUMsQ0FDaENPLElBQUksQ0FBQyxRQUFRLENBQUMsQ0FDZEMsSUFBSSxDQUFDO01BQ0pDLEtBQUssRUFBRSxnQ0FBZ0M7TUFDdkNDLEtBQUssRUFBRTtJQUNULENBQUMsQ0FBQzs7SUFFSjtJQUNBVCxNQUFNLENBQUNJLEdBQUcsQ0FBQyxDQUFDTSxFQUFFLENBQUNDLElBQUksQ0FBQ0MsTUFBTSxDQUFDLEdBQUcsQ0FBQztJQUMvQlosTUFBTSxDQUFDSSxHQUFHLENBQUNTLElBQUksQ0FBQyxDQUFDSCxFQUFFLENBQUNDLElBQUksQ0FBQ0csUUFBUSxDQUFDLE1BQU0sQ0FBQyxDQUFDSixFQUFFLENBQUNNLEtBQUssQ0FBQywwQkFBMEIsQ0FBQztFQUNoRixDQUFDLENBQUM7QUFDSixDQUFDLENBQUMiLCJpZ25vcmVMaXN0IjpbXX0=","map":{"version":3,"names":["chai","require","chaiHttp","app","expect","use","describe","it","res","request","post","send","email","senha","to","have","status","body","property","usuario","equal"],"sourceRoot":"/home/bernardo/sistema-atendimento-ti/ATNTI/test/","sources":["auth.test.js"],"sourcesContent":["const chai = require('chai');\nconst chaiHttp = require('chai-http');\nconst app = require('../src/index'); // Importe a sua aplicação Express\nconst expect = chai.expect;\n\n// Configura o chai para usar o plugin de requisições HTTP\nchai.use(chaiHttp);\n\ndescribe('API de Autenticação', () => {\n  it('deve retornar um token e dados do usuário ao fazer login com sucesso', async () => {\n    const res = await chai.request(app)\n      .post('/login')\n      .send({\n        email: 'admin@ti.com', // Use um e-mail de um usuário que você criou\n        senha: 'senha123'                       // Use a senha correta\n      });\n\n    // Asserções para a resposta\n    expect(res).to.have.status(200);\n    expect(res.body).to.have.property('token');\n    expect(res.body.usuario).to.have.property('id');\n    expect(res.body.usuario).to.have.property('nome');\n    expect(res.body.usuario).to.have.property('email').to.equal('usuario.existente@exemplo.com');\n  });\n\n  it('deve retornar 401 para credenciais inválidas', async () => {\n    const res = await chai.request(app)\n      .post('/login')\n      .send({\n        email: 'usuario.nao.existe@exemplo.com',\n        senha: 'senha_incorreta'\n      });\n      \n    // Asserção para o status de erro\n    expect(res).to.have.status(401);\n    expect(res.body).to.have.property('erro').to.equal('Email ou senha inválidos');\n  });\n});"],"mappings":"AAAA,MAAMA,IAAI,GAAGC,OAAO,CAAC,MAAM,CAAC;AAC5B,MAAMC,QAAQ,GAAGD,OAAO,CAAC,WAAW,CAAC;AACrC,MAAME,GAAG,GAAGF,OAAO,CAAC,cAAc,CAAC,CAAC,CAAC;AACrC,MAAMG,MAAM,GAAGJ,IAAI,CAACI,MAAM;;AAE1B;AACAJ,IAAI,CAACK,GAAG,CAACH,QAAQ,CAAC;AAElBI,QAAQ,CAAC,qBAAqB,EAAE,MAAM;EACpCC,EAAE,CAAC,sEAAsE,EAAE,YAAY;IACrF,MAAMC,GAAG,GAAG,MAAMR,IAAI,CAACS,OAAO,CAACN,GAAG,CAAC,CAChCO,IAAI,CAAC,QAAQ,CAAC,CACdC,IAAI,CAAC;MACJC,KAAK,EAAE,cAAc;MAAE;MACvBC,KAAK,EAAE,UAAU,CAAuB;IAC1C,CAAC,CAAC;;IAEJ;IACAT,MAAM,CAACI,GAAG,CAAC,CAACM,EAAE,CAACC,IAAI,CAACC,MAAM,CAAC,GAAG,CAAC;IAC/BZ,MAAM,CAACI,GAAG,CAACS,IAAI,CAAC,CAACH,EAAE,CAACC,IAAI,CAACG,QAAQ,CAAC,OAAO,CAAC;IAC1Cd,MAAM,CAACI,GAAG,CAACS,IAAI,CAACE,OAAO,CAAC,CAACL,EAAE,CAACC,IAAI,CAACG,QAAQ,CAAC,IAAI,CAAC;IAC/Cd,MAAM,CAACI,GAAG,CAACS,IAAI,CAACE,OAAO,CAAC,CAACL,EAAE,CAACC,IAAI,CAACG,QAAQ,CAAC,MAAM,CAAC;IACjDd,MAAM,CAACI,GAAG,CAACS,IAAI,CAACE,OAAO,CAAC,CAACL,EAAE,CAACC,IAAI,CAACG,QAAQ,CAAC,OAAO,CAAC,CAACJ,EAAE,CAACM,KAAK,CAAC,+BAA+B,CAAC;EAC9F,CAAC,CAAC;EAEFb,EAAE,CAAC,8CAA8C,EAAE,YAAY;IAC7D,MAAMC,GAAG,GAAG,MAAMR,IAAI,CAACS,OAAO,CAACN,GAAG,CAAC,CAChCO,IAAI,CAAC,QAAQ,CAAC,CACdC,IAAI,CAAC;MACJC,KAAK,EAAE,gCAAgC;MACvCC,KAAK,EAAE;IACT,CAAC,CAAC;;IAEJ;IACAT,MAAM,CAACI,GAAG,CAAC,CAACM,EAAE,CAACC,IAAI,CAACC,MAAM,CAAC,GAAG,CAAC;IAC/BZ,MAAM,CAACI,GAAG,CAACS,IAAI,CAAC,CAACH,EAAE,CAACC,IAAI,CAACG,QAAQ,CAAC,MAAM,CAAC,CAACJ,EAAE,CAACM,KAAK,CAAC,0BAA0B,CAAC;EAChF,CAAC,CAAC;AACJ,CAAC,CAAC","ignoreList":[]}},"mtime":1754600578366},"{\"assumptions\":{},\"sourceRoot\":\"/home/bernardo/sistema-atendimento-ti/ATNTI/src/\",\"caller\":{\"name\":\"@babel/register\"},\"cwd\":\"/home/bernardo/sistema-atendimento-ti/ATNTI\",\"filename\":\"/home/bernardo/sistema-atendimento-ti/ATNTI/src/index.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/home/bernardo/sistema-atendimento-ti/ATNTI\",\"rootMode\":\"root\",\"plugins\":[],\"presets\":[]}:7.28.0:development":{"value":{"code":"const express = require('express');\nconst dotenv = require('dotenv');\ndotenv.config();\nconst swaggerUi = require('swagger-ui-express');\nconst swaggerSpec = require('./config/swagger');\nconst app = express();\nconst port = process.env.PORT || 3000;\n\n// Middleware para JSON\napp.use(express.json());\n\n// ============================\n// 📚 Documentação Swagger\n// ============================\napp.use('/docs', swaggerUi.serve, swaggerUi.setup(swaggerSpec));\n\n// ============================\n// 🔐 Rotas protegidas e públicas\n// ============================\n\nconst authRoutes = require('./routes/authRoutes');\napp.use(authRoutes);\nconst userRoutes = require('./routes/userRoutes');\napp.use('/usuarios', userRoutes);\nconst chamadoRoutes = require('./routes/chamadoRoutes');\napp.use('/chamados', chamadoRoutes);\nconst statusRoutes = require('./routes/statusRoutes');\napp.use('/chamados/:chamado_id/status', statusRoutes);\nconst anexoRoutes = require('./routes/anexoRoutes');\napp.use('/chamados/:chamado_id/anexos', anexoRoutes);\nconst notificacaoRoutes = require('./routes/notificacaoRoutes');\napp.use('/notificacoes', notificacaoRoutes);\n\n// ============================\n// 🌐 Rota base\n// ============================\napp.get('/', (req, res) => {\n  res.send('API do Sistema de Atendimento T.I. está no ar 🚀');\n});\n\n// ============================\n// ❌ Rota não encontrada\n// ============================\napp.use((req, res) => {\n  res.status(404).json({\n    erro: 'Rota não encontrada.'\n  });\n});\n\n// ============================\n// ❗Erro interno (NOVO)\n// ============================\nconst errorMiddleware = require('./middlewares/errorMiddleware');\napp.use(errorMiddleware);\napp.listen(port, () => {\n  console.log(`Servidor rodando em http://localhost:${port}`);\n});\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJleHByZXNzIiwicmVxdWlyZSIsImRvdGVudiIsImNvbmZpZyIsInN3YWdnZXJVaSIsInN3YWdnZXJTcGVjIiwiYXBwIiwicG9ydCIsInByb2Nlc3MiLCJlbnYiLCJQT1JUIiwidXNlIiwianNvbiIsInNlcnZlIiwic2V0dXAiLCJhdXRoUm91dGVzIiwidXNlclJvdXRlcyIsImNoYW1hZG9Sb3V0ZXMiLCJzdGF0dXNSb3V0ZXMiLCJhbmV4b1JvdXRlcyIsIm5vdGlmaWNhY2FvUm91dGVzIiwiZ2V0IiwicmVxIiwicmVzIiwic2VuZCIsInN0YXR1cyIsImVycm8iLCJlcnJvck1pZGRsZXdhcmUiLCJsaXN0ZW4iLCJjb25zb2xlIiwibG9nIl0sInNvdXJjZVJvb3QiOiIvaG9tZS9iZXJuYXJkby9zaXN0ZW1hLWF0ZW5kaW1lbnRvLXRpL0FUTlRJL3NyYy8iLCJzb3VyY2VzIjpbImluZGV4LmpzIl0sInNvdXJjZXNDb250ZW50IjpbImNvbnN0IGV4cHJlc3MgPSByZXF1aXJlKCdleHByZXNzJyk7XG5jb25zdCBkb3RlbnYgPSByZXF1aXJlKCdkb3RlbnYnKTtcbmRvdGVudi5jb25maWcoKTtcblxuY29uc3Qgc3dhZ2dlclVpID0gcmVxdWlyZSgnc3dhZ2dlci11aS1leHByZXNzJyk7XG5jb25zdCBzd2FnZ2VyU3BlYyA9IHJlcXVpcmUoJy4vY29uZmlnL3N3YWdnZXInKTtcblxuY29uc3QgYXBwID0gZXhwcmVzcygpO1xuY29uc3QgcG9ydCA9IHByb2Nlc3MuZW52LlBPUlQgfHwgMzAwMDtcblxuLy8gTWlkZGxld2FyZSBwYXJhIEpTT05cbmFwcC51c2UoZXhwcmVzcy5qc29uKCkpO1xuXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vLyDwn5OaIERvY3VtZW50YcOnw6NvIFN3YWdnZXJcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbmFwcC51c2UoJy9kb2NzJywgc3dhZ2dlclVpLnNlcnZlLCBzd2FnZ2VyVWkuc2V0dXAoc3dhZ2dlclNwZWMpKTtcblxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLy8g8J+UkCBSb3RhcyBwcm90ZWdpZGFzIGUgcMO6YmxpY2FzXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbmNvbnN0IGF1dGhSb3V0ZXMgPSByZXF1aXJlKCcuL3JvdXRlcy9hdXRoUm91dGVzJyk7XG5hcHAudXNlKGF1dGhSb3V0ZXMpO1xuXG5jb25zdCB1c2VyUm91dGVzID0gcmVxdWlyZSgnLi9yb3V0ZXMvdXNlclJvdXRlcycpO1xuYXBwLnVzZSgnL3VzdWFyaW9zJywgdXNlclJvdXRlcyk7XG5cbmNvbnN0IGNoYW1hZG9Sb3V0ZXMgPSByZXF1aXJlKCcuL3JvdXRlcy9jaGFtYWRvUm91dGVzJyk7XG5hcHAudXNlKCcvY2hhbWFkb3MnLCBjaGFtYWRvUm91dGVzKTtcblxuY29uc3Qgc3RhdHVzUm91dGVzID0gcmVxdWlyZSgnLi9yb3V0ZXMvc3RhdHVzUm91dGVzJyk7XG5hcHAudXNlKCcvY2hhbWFkb3MvOmNoYW1hZG9faWQvc3RhdHVzJywgc3RhdHVzUm91dGVzKTtcblxuY29uc3QgYW5leG9Sb3V0ZXMgPSByZXF1aXJlKCcuL3JvdXRlcy9hbmV4b1JvdXRlcycpO1xuYXBwLnVzZSgnL2NoYW1hZG9zLzpjaGFtYWRvX2lkL2FuZXhvcycsIGFuZXhvUm91dGVzKTtcblxuY29uc3Qgbm90aWZpY2FjYW9Sb3V0ZXMgPSByZXF1aXJlKCcuL3JvdXRlcy9ub3RpZmljYWNhb1JvdXRlcycpO1xuYXBwLnVzZSgnL25vdGlmaWNhY29lcycsIG5vdGlmaWNhY2FvUm91dGVzKTtcblxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLy8g8J+MkCBSb3RhIGJhc2Vcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbmFwcC5nZXQoJy8nLCAocmVxLCByZXMpID0+IHtcbiAgcmVzLnNlbmQoJ0FQSSBkbyBTaXN0ZW1hIGRlIEF0ZW5kaW1lbnRvIFQuSS4gZXN0w6Egbm8gYXIg8J+agCcpO1xufSk7XG5cbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIOKdjCBSb3RhIG7Do28gZW5jb250cmFkYVxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuYXBwLnVzZSgocmVxLCByZXMpID0+IHtcbiAgcmVzLnN0YXR1cyg0MDQpLmpzb24oeyBlcnJvOiAnUm90YSBuw6NvIGVuY29udHJhZGEuJyB9KTtcbn0pO1xuXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vLyDinZdFcnJvIGludGVybm8gKE5PVk8pXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5jb25zdCBlcnJvck1pZGRsZXdhcmUgPSByZXF1aXJlKCcuL21pZGRsZXdhcmVzL2Vycm9yTWlkZGxld2FyZScpO1xuYXBwLnVzZShlcnJvck1pZGRsZXdhcmUpO1xuXG5hcHAubGlzdGVuKHBvcnQsICgpID0+IHtcbiAgY29uc29sZS5sb2coYFNlcnZpZG9yIHJvZGFuZG8gZW0gaHR0cDovL2xvY2FsaG9zdDoke3BvcnR9YCk7XG59KTsiXSwibWFwcGluZ3MiOiJBQUFBLE1BQU1BLE9BQU8sR0FBR0MsT0FBTyxDQUFDLFNBQVMsQ0FBQztBQUNsQyxNQUFNQyxNQUFNLEdBQUdELE9BQU8sQ0FBQyxRQUFRLENBQUM7QUFDaENDLE1BQU0sQ0FBQ0MsTUFBTSxDQUFDLENBQUM7QUFFZixNQUFNQyxTQUFTLEdBQUdILE9BQU8sQ0FBQyxvQkFBb0IsQ0FBQztBQUMvQyxNQUFNSSxXQUFXLEdBQUdKLE9BQU8sQ0FBQyxrQkFBa0IsQ0FBQztBQUUvQyxNQUFNSyxHQUFHLEdBQUdOLE9BQU8sQ0FBQyxDQUFDO0FBQ3JCLE1BQU1PLElBQUksR0FBR0MsT0FBTyxDQUFDQyxHQUFHLENBQUNDLElBQUksSUFBSSxJQUFJOztBQUVyQztBQUNBSixHQUFHLENBQUNLLEdBQUcsQ0FBQ1gsT0FBTyxDQUFDWSxJQUFJLENBQUMsQ0FBQyxDQUFDOztBQUV2QjtBQUNBO0FBQ0E7QUFDQU4sR0FBRyxDQUFDSyxHQUFHLENBQUMsT0FBTyxFQUFFUCxTQUFTLENBQUNTLEtBQUssRUFBRVQsU0FBUyxDQUFDVSxLQUFLLENBQUNULFdBQVcsQ0FBQyxDQUFDOztBQUUvRDtBQUNBO0FBQ0E7O0FBRUEsTUFBTVUsVUFBVSxHQUFHZCxPQUFPLENBQUMscUJBQXFCLENBQUM7QUFDakRLLEdBQUcsQ0FBQ0ssR0FBRyxDQUFDSSxVQUFVLENBQUM7QUFFbkIsTUFBTUMsVUFBVSxHQUFHZixPQUFPLENBQUMscUJBQXFCLENBQUM7QUFDakRLLEdBQUcsQ0FBQ0ssR0FBRyxDQUFDLFdBQVcsRUFBRUssVUFBVSxDQUFDO0FBRWhDLE1BQU1DLGFBQWEsR0FBR2hCLE9BQU8sQ0FBQyx3QkFBd0IsQ0FBQztBQUN2REssR0FBRyxDQUFDSyxHQUFHLENBQUMsV0FBVyxFQUFFTSxhQUFhLENBQUM7QUFFbkMsTUFBTUMsWUFBWSxHQUFHakIsT0FBTyxDQUFDLHVCQUF1QixDQUFDO0FBQ3JESyxHQUFHLENBQUNLLEdBQUcsQ0FBQyw4QkFBOEIsRUFBRU8sWUFBWSxDQUFDO0FBRXJELE1BQU1DLFdBQVcsR0FBR2xCLE9BQU8sQ0FBQyxzQkFBc0IsQ0FBQztBQUNuREssR0FBRyxDQUFDSyxHQUFHLENBQUMsOEJBQThCLEVBQUVRLFdBQVcsQ0FBQztBQUVwRCxNQUFNQyxpQkFBaUIsR0FBR25CLE9BQU8sQ0FBQyw0QkFBNEIsQ0FBQztBQUMvREssR0FBRyxDQUFDSyxHQUFHLENBQUMsZUFBZSxFQUFFUyxpQkFBaUIsQ0FBQzs7QUFFM0M7QUFDQTtBQUNBO0FBQ0FkLEdBQUcsQ0FBQ2UsR0FBRyxDQUFDLEdBQUcsRUFBRSxDQUFDQyxHQUFHLEVBQUVDLEdBQUcsS0FBSztFQUN6QkEsR0FBRyxDQUFDQyxJQUFJLENBQUMsa0RBQWtELENBQUM7QUFDOUQsQ0FBQyxDQUFDOztBQUVGO0FBQ0E7QUFDQTtBQUNBbEIsR0FBRyxDQUFDSyxHQUFHLENBQUMsQ0FBQ1csR0FBRyxFQUFFQyxHQUFHLEtBQUs7RUFDcEJBLEdBQUcsQ0FBQ0UsTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDYixJQUFJLENBQUM7SUFBRWMsSUFBSSxFQUFFO0VBQXVCLENBQUMsQ0FBQztBQUN4RCxDQUFDLENBQUM7O0FBRUY7QUFDQTtBQUNBO0FBQ0EsTUFBTUMsZUFBZSxHQUFHMUIsT0FBTyxDQUFDLCtCQUErQixDQUFDO0FBQ2hFSyxHQUFHLENBQUNLLEdBQUcsQ0FBQ2dCLGVBQWUsQ0FBQztBQUV4QnJCLEdBQUcsQ0FBQ3NCLE1BQU0sQ0FBQ3JCLElBQUksRUFBRSxNQUFNO0VBQ3JCc0IsT0FBTyxDQUFDQyxHQUFHLENBQUMsd0NBQXdDdkIsSUFBSSxFQUFFLENBQUM7QUFDN0QsQ0FBQyxDQUFDIiwiaWdub3JlTGlzdCI6W119","map":{"version":3,"names":["express","require","dotenv","config","swaggerUi","swaggerSpec","app","port","process","env","PORT","use","json","serve","setup","authRoutes","userRoutes","chamadoRoutes","statusRoutes","anexoRoutes","notificacaoRoutes","get","req","res","send","status","erro","errorMiddleware","listen","console","log"],"sourceRoot":"/home/bernardo/sistema-atendimento-ti/ATNTI/src/","sources":["index.js"],"sourcesContent":["const express = require('express');\nconst dotenv = require('dotenv');\ndotenv.config();\n\nconst swaggerUi = require('swagger-ui-express');\nconst swaggerSpec = require('./config/swagger');\n\nconst app = express();\nconst port = process.env.PORT || 3000;\n\n// Middleware para JSON\napp.use(express.json());\n\n// ============================\n// 📚 Documentação Swagger\n// ============================\napp.use('/docs', swaggerUi.serve, swaggerUi.setup(swaggerSpec));\n\n// ============================\n// 🔐 Rotas protegidas e públicas\n// ============================\n\nconst authRoutes = require('./routes/authRoutes');\napp.use(authRoutes);\n\nconst userRoutes = require('./routes/userRoutes');\napp.use('/usuarios', userRoutes);\n\nconst chamadoRoutes = require('./routes/chamadoRoutes');\napp.use('/chamados', chamadoRoutes);\n\nconst statusRoutes = require('./routes/statusRoutes');\napp.use('/chamados/:chamado_id/status', statusRoutes);\n\nconst anexoRoutes = require('./routes/anexoRoutes');\napp.use('/chamados/:chamado_id/anexos', anexoRoutes);\n\nconst notificacaoRoutes = require('./routes/notificacaoRoutes');\napp.use('/notificacoes', notificacaoRoutes);\n\n// ============================\n// 🌐 Rota base\n// ============================\napp.get('/', (req, res) => {\n  res.send('API do Sistema de Atendimento T.I. está no ar 🚀');\n});\n\n// ============================\n// ❌ Rota não encontrada\n// ============================\napp.use((req, res) => {\n  res.status(404).json({ erro: 'Rota não encontrada.' });\n});\n\n// ============================\n// ❗Erro interno (NOVO)\n// ============================\nconst errorMiddleware = require('./middlewares/errorMiddleware');\napp.use(errorMiddleware);\n\napp.listen(port, () => {\n  console.log(`Servidor rodando em http://localhost:${port}`);\n});"],"mappings":"AAAA,MAAMA,OAAO,GAAGC,OAAO,CAAC,SAAS,CAAC;AAClC,MAAMC,MAAM,GAAGD,OAAO,CAAC,QAAQ,CAAC;AAChCC,MAAM,CAACC,MAAM,CAAC,CAAC;AAEf,MAAMC,SAAS,GAAGH,OAAO,CAAC,oBAAoB,CAAC;AAC/C,MAAMI,WAAW,GAAGJ,OAAO,CAAC,kBAAkB,CAAC;AAE/C,MAAMK,GAAG,GAAGN,OAAO,CAAC,CAAC;AACrB,MAAMO,IAAI,GAAGC,OAAO,CAACC,GAAG,CAACC,IAAI,IAAI,IAAI;;AAErC;AACAJ,GAAG,CAACK,GAAG,CAACX,OAAO,CAACY,IAAI,CAAC,CAAC,CAAC;;AAEvB;AACA;AACA;AACAN,GAAG,CAACK,GAAG,CAAC,OAAO,EAAEP,SAAS,CAACS,KAAK,EAAET,SAAS,CAACU,KAAK,CAACT,WAAW,CAAC,CAAC;;AAE/D;AACA;AACA;;AAEA,MAAMU,UAAU,GAAGd,OAAO,CAAC,qBAAqB,CAAC;AACjDK,GAAG,CAACK,GAAG,CAACI,UAAU,CAAC;AAEnB,MAAMC,UAAU,GAAGf,OAAO,CAAC,qBAAqB,CAAC;AACjDK,GAAG,CAACK,GAAG,CAAC,WAAW,EAAEK,UAAU,CAAC;AAEhC,MAAMC,aAAa,GAAGhB,OAAO,CAAC,wBAAwB,CAAC;AACvDK,GAAG,CAACK,GAAG,CAAC,WAAW,EAAEM,aAAa,CAAC;AAEnC,MAAMC,YAAY,GAAGjB,OAAO,CAAC,uBAAuB,CAAC;AACrDK,GAAG,CAACK,GAAG,CAAC,8BAA8B,EAAEO,YAAY,CAAC;AAErD,MAAMC,WAAW,GAAGlB,OAAO,CAAC,sBAAsB,CAAC;AACnDK,GAAG,CAACK,GAAG,CAAC,8BAA8B,EAAEQ,WAAW,CAAC;AAEpD,MAAMC,iBAAiB,GAAGnB,OAAO,CAAC,4BAA4B,CAAC;AAC/DK,GAAG,CAACK,GAAG,CAAC,eAAe,EAAES,iBAAiB,CAAC;;AAE3C;AACA;AACA;AACAd,GAAG,CAACe,GAAG,CAAC,GAAG,EAAE,CAACC,GAAG,EAAEC,GAAG,KAAK;EACzBA,GAAG,CAACC,IAAI,CAAC,kDAAkD,CAAC;AAC9D,CAAC,CAAC;;AAEF;AACA;AACA;AACAlB,GAAG,CAACK,GAAG,CAAC,CAACW,GAAG,EAAEC,GAAG,KAAK;EACpBA,GAAG,CAACE,MAAM,CAAC,GAAG,CAAC,CAACb,IAAI,CAAC;IAAEc,IAAI,EAAE;EAAuB,CAAC,CAAC;AACxD,CAAC,CAAC;;AAEF;AACA;AACA;AACA,MAAMC,eAAe,GAAG1B,OAAO,CAAC,+BAA+B,CAAC;AAChEK,GAAG,CAACK,GAAG,CAACgB,eAAe,CAAC;AAExBrB,GAAG,CAACsB,MAAM,CAACrB,IAAI,EAAE,MAAM;EACrBsB,OAAO,CAACC,GAAG,CAAC,wCAAwCvB,IAAI,EAAE,CAAC;AAC7D,CAAC,CAAC","ignoreList":[]}},"mtime":1754590524964},"{\"assumptions\":{},\"sourceRoot\":\"/home/bernardo/sistema-atendimento-ti/ATNTI/src/config/\",\"caller\":{\"name\":\"@babel/register\"},\"cwd\":\"/home/bernardo/sistema-atendimento-ti/ATNTI\",\"filename\":\"/home/bernardo/sistema-atendimento-ti/ATNTI/src/config/swagger.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/home/bernardo/sistema-atendimento-ti/ATNTI\",\"rootMode\":\"root\",\"plugins\":[],\"presets\":[]}:7.28.0:development":{"value":{"code":"const swaggerJSDoc = require('swagger-jsdoc');\nconst swaggerDefinition = {\n  openapi: '3.0.0',\n  info: {\n    title: 'Sistema de Atendimento T.I.',\n    version: '1.0.0',\n    description: 'Documentação da API de atendimento técnico interno'\n  },\n  servers: [{\n    url: 'http://localhost:3000',\n    description: 'Servidor local'\n  }],\n  components: {\n    securitySchemes: {\n      bearerAuth: {\n        type: 'http',\n        scheme: 'bearer',\n        bearerFormat: 'JWT'\n      }\n    }\n  },\n  security: [{\n    bearerAuth: []\n  }]\n};\nconst options = {\n  swaggerDefinition,\n  apis: ['./src/routes/*.js'] // onde estão as anotações (YAML nos comentários)\n};\nconst swaggerSpec = swaggerJSDoc(options);\nmodule.exports = swaggerSpec;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJzd2FnZ2VySlNEb2MiLCJyZXF1aXJlIiwic3dhZ2dlckRlZmluaXRpb24iLCJvcGVuYXBpIiwiaW5mbyIsInRpdGxlIiwidmVyc2lvbiIsImRlc2NyaXB0aW9uIiwic2VydmVycyIsInVybCIsImNvbXBvbmVudHMiLCJzZWN1cml0eVNjaGVtZXMiLCJiZWFyZXJBdXRoIiwidHlwZSIsInNjaGVtZSIsImJlYXJlckZvcm1hdCIsInNlY3VyaXR5Iiwib3B0aW9ucyIsImFwaXMiLCJzd2FnZ2VyU3BlYyIsIm1vZHVsZSIsImV4cG9ydHMiXSwic291cmNlUm9vdCI6Ii9ob21lL2Jlcm5hcmRvL3Npc3RlbWEtYXRlbmRpbWVudG8tdGkvQVROVEkvc3JjL2NvbmZpZy8iLCJzb3VyY2VzIjpbInN3YWdnZXIuanMiXSwic291cmNlc0NvbnRlbnQiOlsiY29uc3Qgc3dhZ2dlckpTRG9jID0gcmVxdWlyZSgnc3dhZ2dlci1qc2RvYycpO1xuXG5jb25zdCBzd2FnZ2VyRGVmaW5pdGlvbiA9IHtcbiAgb3BlbmFwaTogJzMuMC4wJyxcbiAgaW5mbzoge1xuICAgIHRpdGxlOiAnU2lzdGVtYSBkZSBBdGVuZGltZW50byBULkkuJyxcbiAgICB2ZXJzaW9uOiAnMS4wLjAnLFxuICAgIGRlc2NyaXB0aW9uOiAnRG9jdW1lbnRhw6fDo28gZGEgQVBJIGRlIGF0ZW5kaW1lbnRvIHTDqWNuaWNvIGludGVybm8nLFxuICB9LFxuICBzZXJ2ZXJzOiBbXG4gICAge1xuICAgICAgdXJsOiAnaHR0cDovL2xvY2FsaG9zdDozMDAwJyxcbiAgICAgIGRlc2NyaXB0aW9uOiAnU2Vydmlkb3IgbG9jYWwnLFxuICAgIH0sXG4gIF0sXG4gIGNvbXBvbmVudHM6IHtcbiAgICBzZWN1cml0eVNjaGVtZXM6IHtcbiAgICAgIGJlYXJlckF1dGg6IHtcbiAgICAgICAgdHlwZTogJ2h0dHAnLFxuICAgICAgICBzY2hlbWU6ICdiZWFyZXInLFxuICAgICAgICBiZWFyZXJGb3JtYXQ6ICdKV1QnXG4gICAgICB9XG4gICAgfVxuICB9LFxuICBzZWN1cml0eTogW3tcbiAgICBiZWFyZXJBdXRoOiBbXVxuICB9XVxufTtcblxuY29uc3Qgb3B0aW9ucyA9IHtcbiAgc3dhZ2dlckRlZmluaXRpb24sXG4gIGFwaXM6IFsnLi9zcmMvcm91dGVzLyouanMnXSwgLy8gb25kZSBlc3TDo28gYXMgYW5vdGHDp8O1ZXMgKFlBTUwgbm9zIGNvbWVudMOhcmlvcylcbn07XG5cbmNvbnN0IHN3YWdnZXJTcGVjID0gc3dhZ2dlckpTRG9jKG9wdGlvbnMpO1xuXG5tb2R1bGUuZXhwb3J0cyA9IHN3YWdnZXJTcGVjO1xuIl0sIm1hcHBpbmdzIjoiQUFBQSxNQUFNQSxZQUFZLEdBQUdDLE9BQU8sQ0FBQyxlQUFlLENBQUM7QUFFN0MsTUFBTUMsaUJBQWlCLEdBQUc7RUFDeEJDLE9BQU8sRUFBRSxPQUFPO0VBQ2hCQyxJQUFJLEVBQUU7SUFDSkMsS0FBSyxFQUFFLDZCQUE2QjtJQUNwQ0MsT0FBTyxFQUFFLE9BQU87SUFDaEJDLFdBQVcsRUFBRTtFQUNmLENBQUM7RUFDREMsT0FBTyxFQUFFLENBQ1A7SUFDRUMsR0FBRyxFQUFFLHVCQUF1QjtJQUM1QkYsV0FBVyxFQUFFO0VBQ2YsQ0FBQyxDQUNGO0VBQ0RHLFVBQVUsRUFBRTtJQUNWQyxlQUFlLEVBQUU7TUFDZkMsVUFBVSxFQUFFO1FBQ1ZDLElBQUksRUFBRSxNQUFNO1FBQ1pDLE1BQU0sRUFBRSxRQUFRO1FBQ2hCQyxZQUFZLEVBQUU7TUFDaEI7SUFDRjtFQUNGLENBQUM7RUFDREMsUUFBUSxFQUFFLENBQUM7SUFDVEosVUFBVSxFQUFFO0VBQ2QsQ0FBQztBQUNILENBQUM7QUFFRCxNQUFNSyxPQUFPLEdBQUc7RUFDZGYsaUJBQWlCO0VBQ2pCZ0IsSUFBSSxFQUFFLENBQUMsbUJBQW1CLENBQUMsQ0FBRTtBQUMvQixDQUFDO0FBRUQsTUFBTUMsV0FBVyxHQUFHbkIsWUFBWSxDQUFDaUIsT0FBTyxDQUFDO0FBRXpDRyxNQUFNLENBQUNDLE9BQU8sR0FBR0YsV0FBVyIsImlnbm9yZUxpc3QiOltdfQ==","map":{"version":3,"names":["swaggerJSDoc","require","swaggerDefinition","openapi","info","title","version","description","servers","url","components","securitySchemes","bearerAuth","type","scheme","bearerFormat","security","options","apis","swaggerSpec","module","exports"],"sourceRoot":"/home/bernardo/sistema-atendimento-ti/ATNTI/src/config/","sources":["swagger.js"],"sourcesContent":["const swaggerJSDoc = require('swagger-jsdoc');\n\nconst swaggerDefinition = {\n  openapi: '3.0.0',\n  info: {\n    title: 'Sistema de Atendimento T.I.',\n    version: '1.0.0',\n    description: 'Documentação da API de atendimento técnico interno',\n  },\n  servers: [\n    {\n      url: 'http://localhost:3000',\n      description: 'Servidor local',\n    },\n  ],\n  components: {\n    securitySchemes: {\n      bearerAuth: {\n        type: 'http',\n        scheme: 'bearer',\n        bearerFormat: 'JWT'\n      }\n    }\n  },\n  security: [{\n    bearerAuth: []\n  }]\n};\n\nconst options = {\n  swaggerDefinition,\n  apis: ['./src/routes/*.js'], // onde estão as anotações (YAML nos comentários)\n};\n\nconst swaggerSpec = swaggerJSDoc(options);\n\nmodule.exports = swaggerSpec;\n"],"mappings":"AAAA,MAAMA,YAAY,GAAGC,OAAO,CAAC,eAAe,CAAC;AAE7C,MAAMC,iBAAiB,GAAG;EACxBC,OAAO,EAAE,OAAO;EAChBC,IAAI,EAAE;IACJC,KAAK,EAAE,6BAA6B;IACpCC,OAAO,EAAE,OAAO;IAChBC,WAAW,EAAE;EACf,CAAC;EACDC,OAAO,EAAE,CACP;IACEC,GAAG,EAAE,uBAAuB;IAC5BF,WAAW,EAAE;EACf,CAAC,CACF;EACDG,UAAU,EAAE;IACVC,eAAe,EAAE;MACfC,UAAU,EAAE;QACVC,IAAI,EAAE,MAAM;QACZC,MAAM,EAAE,QAAQ;QAChBC,YAAY,EAAE;MAChB;IACF;EACF,CAAC;EACDC,QAAQ,EAAE,CAAC;IACTJ,UAAU,EAAE;EACd,CAAC;AACH,CAAC;AAED,MAAMK,OAAO,GAAG;EACdf,iBAAiB;EACjBgB,IAAI,EAAE,CAAC,mBAAmB,CAAC,CAAE;AAC/B,CAAC;AAED,MAAMC,WAAW,GAAGnB,YAAY,CAACiB,OAAO,CAAC;AAEzCG,MAAM,CAACC,OAAO,GAAGF,WAAW","ignoreList":[]}},"mtime":1754576033490},"{\"assumptions\":{},\"sourceRoot\":\"/home/bernardo/sistema-atendimento-ti/ATNTI/src/routes/\",\"caller\":{\"name\":\"@babel/register\"},\"cwd\":\"/home/bernardo/sistema-atendimento-ti/ATNTI\",\"filename\":\"/home/bernardo/sistema-atendimento-ti/ATNTI/src/routes/authRoutes.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/home/bernardo/sistema-atendimento-ti/ATNTI\",\"rootMode\":\"root\",\"plugins\":[],\"presets\":[]}:7.28.0:development":{"value":{"code":"const express = require(\"express\");\nconst router = express.Router();\nconst authController = require(\"../controllers/authController\");\nconst validarRequisicao = require(\"../middlewares/validarRequisicao\");\nconst schemaLogin = require(\"../validators/loginValidator\");\n\n/**\n * @swagger\n * /login:\n *   post:\n *     summary: Realiza login do usuário e retorna token JWT\n *     tags: [Autenticação]\n *     requestBody:\n *       required: true\n *       content:\n *         application/json:\n *           schema:\n *             type: object\n *             required:\n *               - email\n *               - senha\n *             properties:\n *               email:\n *                 type: string\n *               senha:\n *                 type: string\n *     responses:\n *       200:\n *         description: Login realizado com sucesso\n *       401:\n *         description: Credenciais inválidas\n */\n\nrouter.post(\"/login\", validarRequisicao(schemaLogin), authController.login);\nmodule.exports = router;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJleHByZXNzIiwicmVxdWlyZSIsInJvdXRlciIsIlJvdXRlciIsImF1dGhDb250cm9sbGVyIiwidmFsaWRhclJlcXVpc2ljYW8iLCJzY2hlbWFMb2dpbiIsInBvc3QiLCJsb2dpbiIsIm1vZHVsZSIsImV4cG9ydHMiXSwic291cmNlUm9vdCI6Ii9ob21lL2Jlcm5hcmRvL3Npc3RlbWEtYXRlbmRpbWVudG8tdGkvQVROVEkvc3JjL3JvdXRlcy8iLCJzb3VyY2VzIjpbImF1dGhSb3V0ZXMuanMiXSwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgZXhwcmVzcyA9IHJlcXVpcmUoXCJleHByZXNzXCIpO1xuY29uc3Qgcm91dGVyID0gZXhwcmVzcy5Sb3V0ZXIoKTtcbmNvbnN0IGF1dGhDb250cm9sbGVyID0gcmVxdWlyZShcIi4uL2NvbnRyb2xsZXJzL2F1dGhDb250cm9sbGVyXCIpO1xuY29uc3QgdmFsaWRhclJlcXVpc2ljYW8gPSByZXF1aXJlKFwiLi4vbWlkZGxld2FyZXMvdmFsaWRhclJlcXVpc2ljYW9cIik7XG5jb25zdCBzY2hlbWFMb2dpbiA9IHJlcXVpcmUoXCIuLi92YWxpZGF0b3JzL2xvZ2luVmFsaWRhdG9yXCIpO1xuXG5cbi8qKlxuICogQHN3YWdnZXJcbiAqIC9sb2dpbjpcbiAqICAgcG9zdDpcbiAqICAgICBzdW1tYXJ5OiBSZWFsaXphIGxvZ2luIGRvIHVzdcOhcmlvIGUgcmV0b3JuYSB0b2tlbiBKV1RcbiAqICAgICB0YWdzOiBbQXV0ZW50aWNhw6fDo29dXG4gKiAgICAgcmVxdWVzdEJvZHk6XG4gKiAgICAgICByZXF1aXJlZDogdHJ1ZVxuICogICAgICAgY29udGVudDpcbiAqICAgICAgICAgYXBwbGljYXRpb24vanNvbjpcbiAqICAgICAgICAgICBzY2hlbWE6XG4gKiAgICAgICAgICAgICB0eXBlOiBvYmplY3RcbiAqICAgICAgICAgICAgIHJlcXVpcmVkOlxuICogICAgICAgICAgICAgICAtIGVtYWlsXG4gKiAgICAgICAgICAgICAgIC0gc2VuaGFcbiAqICAgICAgICAgICAgIHByb3BlcnRpZXM6XG4gKiAgICAgICAgICAgICAgIGVtYWlsOlxuICogICAgICAgICAgICAgICAgIHR5cGU6IHN0cmluZ1xuICogICAgICAgICAgICAgICBzZW5oYTpcbiAqICAgICAgICAgICAgICAgICB0eXBlOiBzdHJpbmdcbiAqICAgICByZXNwb25zZXM6XG4gKiAgICAgICAyMDA6XG4gKiAgICAgICAgIGRlc2NyaXB0aW9uOiBMb2dpbiByZWFsaXphZG8gY29tIHN1Y2Vzc29cbiAqICAgICAgIDQwMTpcbiAqICAgICAgICAgZGVzY3JpcHRpb246IENyZWRlbmNpYWlzIGludsOhbGlkYXNcbiAqL1xuXG5yb3V0ZXIucG9zdChcIi9sb2dpblwiLCB2YWxpZGFyUmVxdWlzaWNhbyhzY2hlbWFMb2dpbiksIGF1dGhDb250cm9sbGVyLmxvZ2luKTtcblxubW9kdWxlLmV4cG9ydHMgPSByb3V0ZXI7XG4iXSwibWFwcGluZ3MiOiJBQUFBLE1BQU1BLE9BQU8sR0FBR0MsT0FBTyxDQUFDLFNBQVMsQ0FBQztBQUNsQyxNQUFNQyxNQUFNLEdBQUdGLE9BQU8sQ0FBQ0csTUFBTSxDQUFDLENBQUM7QUFDL0IsTUFBTUMsY0FBYyxHQUFHSCxPQUFPLENBQUMsK0JBQStCLENBQUM7QUFDL0QsTUFBTUksaUJBQWlCLEdBQUdKLE9BQU8sQ0FBQyxrQ0FBa0MsQ0FBQztBQUNyRSxNQUFNSyxXQUFXLEdBQUdMLE9BQU8sQ0FBQyw4QkFBOEIsQ0FBQzs7QUFHM0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQUMsTUFBTSxDQUFDSyxJQUFJLENBQUMsUUFBUSxFQUFFRixpQkFBaUIsQ0FBQ0MsV0FBVyxDQUFDLEVBQUVGLGNBQWMsQ0FBQ0ksS0FBSyxDQUFDO0FBRTNFQyxNQUFNLENBQUNDLE9BQU8sR0FBR1IsTUFBTSIsImlnbm9yZUxpc3QiOltdfQ==","map":{"version":3,"names":["express","require","router","Router","authController","validarRequisicao","schemaLogin","post","login","module","exports"],"sourceRoot":"/home/bernardo/sistema-atendimento-ti/ATNTI/src/routes/","sources":["authRoutes.js"],"sourcesContent":["const express = require(\"express\");\nconst router = express.Router();\nconst authController = require(\"../controllers/authController\");\nconst validarRequisicao = require(\"../middlewares/validarRequisicao\");\nconst schemaLogin = require(\"../validators/loginValidator\");\n\n\n/**\n * @swagger\n * /login:\n *   post:\n *     summary: Realiza login do usuário e retorna token JWT\n *     tags: [Autenticação]\n *     requestBody:\n *       required: true\n *       content:\n *         application/json:\n *           schema:\n *             type: object\n *             required:\n *               - email\n *               - senha\n *             properties:\n *               email:\n *                 type: string\n *               senha:\n *                 type: string\n *     responses:\n *       200:\n *         description: Login realizado com sucesso\n *       401:\n *         description: Credenciais inválidas\n */\n\nrouter.post(\"/login\", validarRequisicao(schemaLogin), authController.login);\n\nmodule.exports = router;\n"],"mappings":"AAAA,MAAMA,OAAO,GAAGC,OAAO,CAAC,SAAS,CAAC;AAClC,MAAMC,MAAM,GAAGF,OAAO,CAACG,MAAM,CAAC,CAAC;AAC/B,MAAMC,cAAc,GAAGH,OAAO,CAAC,+BAA+B,CAAC;AAC/D,MAAMI,iBAAiB,GAAGJ,OAAO,CAAC,kCAAkC,CAAC;AACrE,MAAMK,WAAW,GAAGL,OAAO,CAAC,8BAA8B,CAAC;;AAG3D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEAC,MAAM,CAACK,IAAI,CAAC,QAAQ,EAAEF,iBAAiB,CAACC,WAAW,CAAC,EAAEF,cAAc,CAACI,KAAK,CAAC;AAE3EC,MAAM,CAACC,OAAO,GAAGR,MAAM","ignoreList":[]}},"mtime":1754576033491},"{\"assumptions\":{},\"sourceRoot\":\"/home/bernardo/sistema-atendimento-ti/ATNTI/src/controllers/\",\"caller\":{\"name\":\"@babel/register\"},\"cwd\":\"/home/bernardo/sistema-atendimento-ti/ATNTI\",\"filename\":\"/home/bernardo/sistema-atendimento-ti/ATNTI/src/controllers/authController.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/home/bernardo/sistema-atendimento-ti/ATNTI\",\"rootMode\":\"root\",\"plugins\":[],\"presets\":[]}:7.28.0:development":{"value":{"code":"const bcrypt = require('bcrypt');\nconst jwt = require('jsonwebtoken');\nconst db = require('../config/db');\nrequire('dotenv').config();\nconst AuthController = {\n  async login(req, res, next) {\n    const {\n      email,\n      senha\n    } = req.body;\n    try {\n      const result = await db.query('SELECT * FROM usuarios WHERE email = $1', [email]);\n      const user = result.rows[0];\n      if (!user) {\n        return res.status(401).json({\n          erro: 'Email ou senha inválidos'\n        });\n      }\n      const senhaValida = await bcrypt.compare(senha, user.senha);\n      if (!senhaValida) {\n        return res.status(401).json({\n          erro: 'Email ou senha inválidos'\n        });\n      }\n      const token = jwt.sign({\n        id: user.id,\n        email: user.email,\n        tipo: user.tipo\n      }, process.env.JWT_SECRET, {\n        expiresIn: process.env.JWT_EXPIRES_IN\n      });\n      res.json({\n        token,\n        usuario: {\n          id: user.id,\n          nome: user.nome,\n          email: user.email\n        }\n      });\n    } catch (err) {\n      next(err);\n    }\n  }\n};\nmodule.exports = AuthController;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJiY3J5cHQiLCJyZXF1aXJlIiwiand0IiwiZGIiLCJjb25maWciLCJBdXRoQ29udHJvbGxlciIsImxvZ2luIiwicmVxIiwicmVzIiwibmV4dCIsImVtYWlsIiwic2VuaGEiLCJib2R5IiwicmVzdWx0IiwicXVlcnkiLCJ1c2VyIiwicm93cyIsInN0YXR1cyIsImpzb24iLCJlcnJvIiwic2VuaGFWYWxpZGEiLCJjb21wYXJlIiwidG9rZW4iLCJzaWduIiwiaWQiLCJ0aXBvIiwicHJvY2VzcyIsImVudiIsIkpXVF9TRUNSRVQiLCJleHBpcmVzSW4iLCJKV1RfRVhQSVJFU19JTiIsInVzdWFyaW8iLCJub21lIiwiZXJyIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJzb3VyY2VSb290IjoiL2hvbWUvYmVybmFyZG8vc2lzdGVtYS1hdGVuZGltZW50by10aS9BVE5USS9zcmMvY29udHJvbGxlcnMvIiwic291cmNlcyI6WyJhdXRoQ29udHJvbGxlci5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBiY3J5cHQgPSByZXF1aXJlKCdiY3J5cHQnKTtcbmNvbnN0IGp3dCA9IHJlcXVpcmUoJ2pzb253ZWJ0b2tlbicpO1xuY29uc3QgZGIgPSByZXF1aXJlKCcuLi9jb25maWcvZGInKTtcbnJlcXVpcmUoJ2RvdGVudicpLmNvbmZpZygpO1xuXG5jb25zdCBBdXRoQ29udHJvbGxlciA9IHtcbiAgYXN5bmMgbG9naW4ocmVxLCByZXMsIG5leHQpIHtcbiAgICBjb25zdCB7IGVtYWlsLCBzZW5oYSB9ID0gcmVxLmJvZHk7XG5cbiAgICB0cnkge1xuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZGIucXVlcnkoJ1NFTEVDVCAqIEZST00gdXN1YXJpb3MgV0hFUkUgZW1haWwgPSAkMScsIFtlbWFpbF0pO1xuICAgICAgY29uc3QgdXNlciA9IHJlc3VsdC5yb3dzWzBdO1xuXG4gICAgICBpZiAoIXVzZXIpIHtcbiAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAxKS5qc29uKHsgZXJybzogJ0VtYWlsIG91IHNlbmhhIGludsOhbGlkb3MnIH0pO1xuICAgICAgfVxuXG4gICAgICBjb25zdCBzZW5oYVZhbGlkYSA9IGF3YWl0IGJjcnlwdC5jb21wYXJlKHNlbmhhLCB1c2VyLnNlbmhhKTtcbiAgICAgIGlmICghc2VuaGFWYWxpZGEpIHtcbiAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAxKS5qc29uKHsgZXJybzogJ0VtYWlsIG91IHNlbmhhIGludsOhbGlkb3MnIH0pO1xuICAgICAgfVxuXG4gICAgICBjb25zdCB0b2tlbiA9IGp3dC5zaWduKFxuICAgICAgICB7XG4gICAgICAgICAgICBpZDogdXNlci5pZCxcbiAgICAgICAgICAgIGVtYWlsOiB1c2VyLmVtYWlsLFxuICAgICAgICAgICAgdGlwbzogdXNlci50aXBvXG4gICAgICAgIH0sXG4gICAgICAgIHByb2Nlc3MuZW52LkpXVF9TRUNSRVQsXG4gICAgICAgIHsgZXhwaXJlc0luOiBwcm9jZXNzLmVudi5KV1RfRVhQSVJFU19JTiB9XG4gICAgICAgICk7XG5cbiAgICAgIHJlcy5qc29uKHtcbiAgICAgICAgdG9rZW4sXG4gICAgICAgIHVzdWFyaW86IHtcbiAgICAgICAgICBpZDogdXNlci5pZCxcbiAgICAgICAgICBub21lOiB1c2VyLm5vbWUsXG4gICAgICAgICAgZW1haWw6IHVzZXIuZW1haWxcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICBuZXh0KGVycik7XG4gICAgfVxuICB9XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IEF1dGhDb250cm9sbGVyOyJdLCJtYXBwaW5ncyI6IkFBQUEsTUFBTUEsTUFBTSxHQUFHQyxPQUFPLENBQUMsUUFBUSxDQUFDO0FBQ2hDLE1BQU1DLEdBQUcsR0FBR0QsT0FBTyxDQUFDLGNBQWMsQ0FBQztBQUNuQyxNQUFNRSxFQUFFLEdBQUdGLE9BQU8sQ0FBQyxjQUFjLENBQUM7QUFDbENBLE9BQU8sQ0FBQyxRQUFRLENBQUMsQ0FBQ0csTUFBTSxDQUFDLENBQUM7QUFFMUIsTUFBTUMsY0FBYyxHQUFHO0VBQ3JCLE1BQU1DLEtBQUtBLENBQUNDLEdBQUcsRUFBRUMsR0FBRyxFQUFFQyxJQUFJLEVBQUU7SUFDMUIsTUFBTTtNQUFFQyxLQUFLO01BQUVDO0lBQU0sQ0FBQyxHQUFHSixHQUFHLENBQUNLLElBQUk7SUFFakMsSUFBSTtNQUNGLE1BQU1DLE1BQU0sR0FBRyxNQUFNVixFQUFFLENBQUNXLEtBQUssQ0FBQyx5Q0FBeUMsRUFBRSxDQUFDSixLQUFLLENBQUMsQ0FBQztNQUNqRixNQUFNSyxJQUFJLEdBQUdGLE1BQU0sQ0FBQ0csSUFBSSxDQUFDLENBQUMsQ0FBQztNQUUzQixJQUFJLENBQUNELElBQUksRUFBRTtRQUNULE9BQU9QLEdBQUcsQ0FBQ1MsTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDQyxJQUFJLENBQUM7VUFBRUMsSUFBSSxFQUFFO1FBQTJCLENBQUMsQ0FBQztNQUNuRTtNQUVBLE1BQU1DLFdBQVcsR0FBRyxNQUFNcEIsTUFBTSxDQUFDcUIsT0FBTyxDQUFDVixLQUFLLEVBQUVJLElBQUksQ0FBQ0osS0FBSyxDQUFDO01BQzNELElBQUksQ0FBQ1MsV0FBVyxFQUFFO1FBQ2hCLE9BQU9aLEdBQUcsQ0FBQ1MsTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDQyxJQUFJLENBQUM7VUFBRUMsSUFBSSxFQUFFO1FBQTJCLENBQUMsQ0FBQztNQUNuRTtNQUVBLE1BQU1HLEtBQUssR0FBR3BCLEdBQUcsQ0FBQ3FCLElBQUksQ0FDcEI7UUFDSUMsRUFBRSxFQUFFVCxJQUFJLENBQUNTLEVBQUU7UUFDWGQsS0FBSyxFQUFFSyxJQUFJLENBQUNMLEtBQUs7UUFDakJlLElBQUksRUFBRVYsSUFBSSxDQUFDVTtNQUNmLENBQUMsRUFDREMsT0FBTyxDQUFDQyxHQUFHLENBQUNDLFVBQVUsRUFDdEI7UUFBRUMsU0FBUyxFQUFFSCxPQUFPLENBQUNDLEdBQUcsQ0FBQ0c7TUFBZSxDQUN4QyxDQUFDO01BRUh0QixHQUFHLENBQUNVLElBQUksQ0FBQztRQUNQSSxLQUFLO1FBQ0xTLE9BQU8sRUFBRTtVQUNQUCxFQUFFLEVBQUVULElBQUksQ0FBQ1MsRUFBRTtVQUNYUSxJQUFJLEVBQUVqQixJQUFJLENBQUNpQixJQUFJO1VBQ2Z0QixLQUFLLEVBQUVLLElBQUksQ0FBQ0w7UUFDZDtNQUNGLENBQUMsQ0FBQztJQUNKLENBQUMsQ0FBQyxPQUFPdUIsR0FBRyxFQUFFO01BQ1p4QixJQUFJLENBQUN3QixHQUFHLENBQUM7SUFDWDtFQUNGO0FBQ0YsQ0FBQztBQUVEQyxNQUFNLENBQUNDLE9BQU8sR0FBRzlCLGNBQWMiLCJpZ25vcmVMaXN0IjpbXX0=","map":{"version":3,"names":["bcrypt","require","jwt","db","config","AuthController","login","req","res","next","email","senha","body","result","query","user","rows","status","json","erro","senhaValida","compare","token","sign","id","tipo","process","env","JWT_SECRET","expiresIn","JWT_EXPIRES_IN","usuario","nome","err","module","exports"],"sourceRoot":"/home/bernardo/sistema-atendimento-ti/ATNTI/src/controllers/","sources":["authController.js"],"sourcesContent":["const bcrypt = require('bcrypt');\nconst jwt = require('jsonwebtoken');\nconst db = require('../config/db');\nrequire('dotenv').config();\n\nconst AuthController = {\n  async login(req, res, next) {\n    const { email, senha } = req.body;\n\n    try {\n      const result = await db.query('SELECT * FROM usuarios WHERE email = $1', [email]);\n      const user = result.rows[0];\n\n      if (!user) {\n        return res.status(401).json({ erro: 'Email ou senha inválidos' });\n      }\n\n      const senhaValida = await bcrypt.compare(senha, user.senha);\n      if (!senhaValida) {\n        return res.status(401).json({ erro: 'Email ou senha inválidos' });\n      }\n\n      const token = jwt.sign(\n        {\n            id: user.id,\n            email: user.email,\n            tipo: user.tipo\n        },\n        process.env.JWT_SECRET,\n        { expiresIn: process.env.JWT_EXPIRES_IN }\n        );\n\n      res.json({\n        token,\n        usuario: {\n          id: user.id,\n          nome: user.nome,\n          email: user.email\n        }\n      });\n    } catch (err) {\n      next(err);\n    }\n  }\n};\n\nmodule.exports = AuthController;"],"mappings":"AAAA,MAAMA,MAAM,GAAGC,OAAO,CAAC,QAAQ,CAAC;AAChC,MAAMC,GAAG,GAAGD,OAAO,CAAC,cAAc,CAAC;AACnC,MAAME,EAAE,GAAGF,OAAO,CAAC,cAAc,CAAC;AAClCA,OAAO,CAAC,QAAQ,CAAC,CAACG,MAAM,CAAC,CAAC;AAE1B,MAAMC,cAAc,GAAG;EACrB,MAAMC,KAAKA,CAACC,GAAG,EAAEC,GAAG,EAAEC,IAAI,EAAE;IAC1B,MAAM;MAAEC,KAAK;MAAEC;IAAM,CAAC,GAAGJ,GAAG,CAACK,IAAI;IAEjC,IAAI;MACF,MAAMC,MAAM,GAAG,MAAMV,EAAE,CAACW,KAAK,CAAC,yCAAyC,EAAE,CAACJ,KAAK,CAAC,CAAC;MACjF,MAAMK,IAAI,GAAGF,MAAM,CAACG,IAAI,CAAC,CAAC,CAAC;MAE3B,IAAI,CAACD,IAAI,EAAE;QACT,OAAOP,GAAG,CAACS,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;UAAEC,IAAI,EAAE;QAA2B,CAAC,CAAC;MACnE;MAEA,MAAMC,WAAW,GAAG,MAAMpB,MAAM,CAACqB,OAAO,CAACV,KAAK,EAAEI,IAAI,CAACJ,KAAK,CAAC;MAC3D,IAAI,CAACS,WAAW,EAAE;QAChB,OAAOZ,GAAG,CAACS,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;UAAEC,IAAI,EAAE;QAA2B,CAAC,CAAC;MACnE;MAEA,MAAMG,KAAK,GAAGpB,GAAG,CAACqB,IAAI,CACpB;QACIC,EAAE,EAAET,IAAI,CAACS,EAAE;QACXd,KAAK,EAAEK,IAAI,CAACL,KAAK;QACjBe,IAAI,EAAEV,IAAI,CAACU;MACf,CAAC,EACDC,OAAO,CAACC,GAAG,CAACC,UAAU,EACtB;QAAEC,SAAS,EAAEH,OAAO,CAACC,GAAG,CAACG;MAAe,CACxC,CAAC;MAEHtB,GAAG,CAACU,IAAI,CAAC;QACPI,KAAK;QACLS,OAAO,EAAE;UACPP,EAAE,EAAET,IAAI,CAACS,EAAE;UACXQ,IAAI,EAAEjB,IAAI,CAACiB,IAAI;UACftB,KAAK,EAAEK,IAAI,CAACL;QACd;MACF,CAAC,CAAC;IACJ,CAAC,CAAC,OAAOuB,GAAG,EAAE;MACZxB,IAAI,CAACwB,GAAG,CAAC;IACX;EACF;AACF,CAAC;AAEDC,MAAM,CAACC,OAAO,GAAG9B,cAAc","ignoreList":[]}},"mtime":1754590699200},"{\"assumptions\":{},\"sourceRoot\":\"/home/bernardo/sistema-atendimento-ti/ATNTI/src/config/\",\"caller\":{\"name\":\"@babel/register\"},\"cwd\":\"/home/bernardo/sistema-atendimento-ti/ATNTI\",\"filename\":\"/home/bernardo/sistema-atendimento-ti/ATNTI/src/config/db.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/home/bernardo/sistema-atendimento-ti/ATNTI\",\"rootMode\":\"root\",\"plugins\":[],\"presets\":[]}:7.28.0:development":{"value":{"code":"const {\n  Pool\n} = require('pg');\nrequire('dotenv').config();\nconst pool = new Pool({\n  connectionString: process.env.DATABASE_URL\n});\nmodule.exports = pool;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJQb29sIiwicmVxdWlyZSIsImNvbmZpZyIsInBvb2wiLCJjb25uZWN0aW9uU3RyaW5nIiwicHJvY2VzcyIsImVudiIsIkRBVEFCQVNFX1VSTCIsIm1vZHVsZSIsImV4cG9ydHMiXSwic291cmNlUm9vdCI6Ii9ob21lL2Jlcm5hcmRvL3Npc3RlbWEtYXRlbmRpbWVudG8tdGkvQVROVEkvc3JjL2NvbmZpZy8iLCJzb3VyY2VzIjpbImRiLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImNvbnN0IHsgUG9vbCB9ID0gcmVxdWlyZSgncGcnKTtcbnJlcXVpcmUoJ2RvdGVudicpLmNvbmZpZygpO1xuXG5jb25zdCBwb29sID0gbmV3IFBvb2woe1xuICBjb25uZWN0aW9uU3RyaW5nOiBwcm9jZXNzLmVudi5EQVRBQkFTRV9VUkwsXG59KTtcblxubW9kdWxlLmV4cG9ydHMgPSBwb29sO1xuIl0sIm1hcHBpbmdzIjoiQUFBQSxNQUFNO0VBQUVBO0FBQUssQ0FBQyxHQUFHQyxPQUFPLENBQUMsSUFBSSxDQUFDO0FBQzlCQSxPQUFPLENBQUMsUUFBUSxDQUFDLENBQUNDLE1BQU0sQ0FBQyxDQUFDO0FBRTFCLE1BQU1DLElBQUksR0FBRyxJQUFJSCxJQUFJLENBQUM7RUFDcEJJLGdCQUFnQixFQUFFQyxPQUFPLENBQUNDLEdBQUcsQ0FBQ0M7QUFDaEMsQ0FBQyxDQUFDO0FBRUZDLE1BQU0sQ0FBQ0MsT0FBTyxHQUFHTixJQUFJIiwiaWdub3JlTGlzdCI6W119","map":{"version":3,"names":["Pool","require","config","pool","connectionString","process","env","DATABASE_URL","module","exports"],"sourceRoot":"/home/bernardo/sistema-atendimento-ti/ATNTI/src/config/","sources":["db.js"],"sourcesContent":["const { Pool } = require('pg');\nrequire('dotenv').config();\n\nconst pool = new Pool({\n  connectionString: process.env.DATABASE_URL,\n});\n\nmodule.exports = pool;\n"],"mappings":"AAAA,MAAM;EAAEA;AAAK,CAAC,GAAGC,OAAO,CAAC,IAAI,CAAC;AAC9BA,OAAO,CAAC,QAAQ,CAAC,CAACC,MAAM,CAAC,CAAC;AAE1B,MAAMC,IAAI,GAAG,IAAIH,IAAI,CAAC;EACpBI,gBAAgB,EAAEC,OAAO,CAACC,GAAG,CAACC;AAChC,CAAC,CAAC;AAEFC,MAAM,CAACC,OAAO,GAAGN,IAAI","ignoreList":[]}},"mtime":1754576033490},"{\"assumptions\":{},\"sourceRoot\":\"/home/bernardo/sistema-atendimento-ti/ATNTI/src/middlewares/\",\"caller\":{\"name\":\"@babel/register\"},\"cwd\":\"/home/bernardo/sistema-atendimento-ti/ATNTI\",\"filename\":\"/home/bernardo/sistema-atendimento-ti/ATNTI/src/middlewares/validarRequisicao.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/home/bernardo/sistema-atendimento-ti/ATNTI\",\"rootMode\":\"root\",\"plugins\":[],\"presets\":[]}:7.28.0:development":{"value":{"code":"module.exports = function validarRequisicao(schema) {\n  return (req, res, next) => {\n    const {\n      error\n    } = schema.validate(req.body, {\n      abortEarly: false\n    });\n    if (error) {\n      const mensagens = error.details.map(d => d.message);\n      return res.status(400).json({\n        erro: \"Validação falhou\",\n        detalhes: mensagens\n      });\n    }\n    next();\n  };\n};\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJtb2R1bGUiLCJleHBvcnRzIiwidmFsaWRhclJlcXVpc2ljYW8iLCJzY2hlbWEiLCJyZXEiLCJyZXMiLCJuZXh0IiwiZXJyb3IiLCJ2YWxpZGF0ZSIsImJvZHkiLCJhYm9ydEVhcmx5IiwibWVuc2FnZW5zIiwiZGV0YWlscyIsIm1hcCIsImQiLCJtZXNzYWdlIiwic3RhdHVzIiwianNvbiIsImVycm8iLCJkZXRhbGhlcyJdLCJzb3VyY2VSb290IjoiL2hvbWUvYmVybmFyZG8vc2lzdGVtYS1hdGVuZGltZW50by10aS9BVE5USS9zcmMvbWlkZGxld2FyZXMvIiwic291cmNlcyI6WyJ2YWxpZGFyUmVxdWlzaWNhby5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJtb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIHZhbGlkYXJSZXF1aXNpY2FvKHNjaGVtYSkge1xuICByZXR1cm4gKHJlcSwgcmVzLCBuZXh0KSA9PiB7XG4gICAgY29uc3QgeyBlcnJvciB9ID0gc2NoZW1hLnZhbGlkYXRlKHJlcS5ib2R5LCB7IGFib3J0RWFybHk6IGZhbHNlIH0pO1xuXG4gICAgaWYgKGVycm9yKSB7XG4gICAgICBjb25zdCBtZW5zYWdlbnMgPSBlcnJvci5kZXRhaWxzLm1hcChkID0+IGQubWVzc2FnZSk7XG4gICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLmpzb24oeyBlcnJvOiBcIlZhbGlkYcOnw6NvIGZhbGhvdVwiLCBkZXRhbGhlczogbWVuc2FnZW5zIH0pO1xuICAgIH1cblxuICAgIG5leHQoKTtcbiAgfTtcbn07XG4iXSwibWFwcGluZ3MiOiJBQUFBQSxNQUFNLENBQUNDLE9BQU8sR0FBRyxTQUFTQyxpQkFBaUJBLENBQUNDLE1BQU0sRUFBRTtFQUNsRCxPQUFPLENBQUNDLEdBQUcsRUFBRUMsR0FBRyxFQUFFQyxJQUFJLEtBQUs7SUFDekIsTUFBTTtNQUFFQztJQUFNLENBQUMsR0FBR0osTUFBTSxDQUFDSyxRQUFRLENBQUNKLEdBQUcsQ0FBQ0ssSUFBSSxFQUFFO01BQUVDLFVBQVUsRUFBRTtJQUFNLENBQUMsQ0FBQztJQUVsRSxJQUFJSCxLQUFLLEVBQUU7TUFDVCxNQUFNSSxTQUFTLEdBQUdKLEtBQUssQ0FBQ0ssT0FBTyxDQUFDQyxHQUFHLENBQUNDLENBQUMsSUFBSUEsQ0FBQyxDQUFDQyxPQUFPLENBQUM7TUFDbkQsT0FBT1YsR0FBRyxDQUFDVyxNQUFNLENBQUMsR0FBRyxDQUFDLENBQUNDLElBQUksQ0FBQztRQUFFQyxJQUFJLEVBQUUsa0JBQWtCO1FBQUVDLFFBQVEsRUFBRVI7TUFBVSxDQUFDLENBQUM7SUFDaEY7SUFFQUwsSUFBSSxDQUFDLENBQUM7RUFDUixDQUFDO0FBQ0gsQ0FBQyIsImlnbm9yZUxpc3QiOltdfQ==","map":{"version":3,"names":["module","exports","validarRequisicao","schema","req","res","next","error","validate","body","abortEarly","mensagens","details","map","d","message","status","json","erro","detalhes"],"sourceRoot":"/home/bernardo/sistema-atendimento-ti/ATNTI/src/middlewares/","sources":["validarRequisicao.js"],"sourcesContent":["module.exports = function validarRequisicao(schema) {\n  return (req, res, next) => {\n    const { error } = schema.validate(req.body, { abortEarly: false });\n\n    if (error) {\n      const mensagens = error.details.map(d => d.message);\n      return res.status(400).json({ erro: \"Validação falhou\", detalhes: mensagens });\n    }\n\n    next();\n  };\n};\n"],"mappings":"AAAAA,MAAM,CAACC,OAAO,GAAG,SAASC,iBAAiBA,CAACC,MAAM,EAAE;EAClD,OAAO,CAACC,GAAG,EAAEC,GAAG,EAAEC,IAAI,KAAK;IACzB,MAAM;MAAEC;IAAM,CAAC,GAAGJ,MAAM,CAACK,QAAQ,CAACJ,GAAG,CAACK,IAAI,EAAE;MAAEC,UAAU,EAAE;IAAM,CAAC,CAAC;IAElE,IAAIH,KAAK,EAAE;MACT,MAAMI,SAAS,GAAGJ,KAAK,CAACK,OAAO,CAACC,GAAG,CAACC,CAAC,IAAIA,CAAC,CAACC,OAAO,CAAC;MACnD,OAAOV,GAAG,CAACW,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;QAAEC,IAAI,EAAE,kBAAkB;QAAEC,QAAQ,EAAER;MAAU,CAAC,CAAC;IAChF;IAEAL,IAAI,CAAC,CAAC;EACR,CAAC;AACH,CAAC","ignoreList":[]}},"mtime":1754576033491},"{\"assumptions\":{},\"sourceRoot\":\"/home/bernardo/sistema-atendimento-ti/ATNTI/src/validators/\",\"caller\":{\"name\":\"@babel/register\"},\"cwd\":\"/home/bernardo/sistema-atendimento-ti/ATNTI\",\"filename\":\"/home/bernardo/sistema-atendimento-ti/ATNTI/src/validators/loginValidator.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/home/bernardo/sistema-atendimento-ti/ATNTI\",\"rootMode\":\"root\",\"plugins\":[],\"presets\":[]}:7.28.0:development":{"value":{"code":"const Joi = require(\"joi\");\nconst schemaLogin = Joi.object({\n  email: Joi.string().email().required(),\n  senha: Joi.string().min(6).required()\n});\nmodule.exports = schemaLogin;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJKb2kiLCJyZXF1aXJlIiwic2NoZW1hTG9naW4iLCJvYmplY3QiLCJlbWFpbCIsInN0cmluZyIsInJlcXVpcmVkIiwic2VuaGEiLCJtaW4iLCJtb2R1bGUiLCJleHBvcnRzIl0sInNvdXJjZVJvb3QiOiIvaG9tZS9iZXJuYXJkby9zaXN0ZW1hLWF0ZW5kaW1lbnRvLXRpL0FUTlRJL3NyYy92YWxpZGF0b3JzLyIsInNvdXJjZXMiOlsibG9naW5WYWxpZGF0b3IuanMiXSwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgSm9pID0gcmVxdWlyZShcImpvaVwiKTtcblxuY29uc3Qgc2NoZW1hTG9naW4gPSBKb2kub2JqZWN0KHtcbiAgZW1haWw6IEpvaS5zdHJpbmcoKS5lbWFpbCgpLnJlcXVpcmVkKCksXG4gIHNlbmhhOiBKb2kuc3RyaW5nKCkubWluKDYpLnJlcXVpcmVkKClcbn0pO1xuXG5tb2R1bGUuZXhwb3J0cyA9IHNjaGVtYUxvZ2luO1xuIl0sIm1hcHBpbmdzIjoiQUFBQSxNQUFNQSxHQUFHLEdBQUdDLE9BQU8sQ0FBQyxLQUFLLENBQUM7QUFFMUIsTUFBTUMsV0FBVyxHQUFHRixHQUFHLENBQUNHLE1BQU0sQ0FBQztFQUM3QkMsS0FBSyxFQUFFSixHQUFHLENBQUNLLE1BQU0sQ0FBQyxDQUFDLENBQUNELEtBQUssQ0FBQyxDQUFDLENBQUNFLFFBQVEsQ0FBQyxDQUFDO0VBQ3RDQyxLQUFLLEVBQUVQLEdBQUcsQ0FBQ0ssTUFBTSxDQUFDLENBQUMsQ0FBQ0csR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDRixRQUFRLENBQUM7QUFDdEMsQ0FBQyxDQUFDO0FBRUZHLE1BQU0sQ0FBQ0MsT0FBTyxHQUFHUixXQUFXIiwiaWdub3JlTGlzdCI6W119","map":{"version":3,"names":["Joi","require","schemaLogin","object","email","string","required","senha","min","module","exports"],"sourceRoot":"/home/bernardo/sistema-atendimento-ti/ATNTI/src/validators/","sources":["loginValidator.js"],"sourcesContent":["const Joi = require(\"joi\");\n\nconst schemaLogin = Joi.object({\n  email: Joi.string().email().required(),\n  senha: Joi.string().min(6).required()\n});\n\nmodule.exports = schemaLogin;\n"],"mappings":"AAAA,MAAMA,GAAG,GAAGC,OAAO,CAAC,KAAK,CAAC;AAE1B,MAAMC,WAAW,GAAGF,GAAG,CAACG,MAAM,CAAC;EAC7BC,KAAK,EAAEJ,GAAG,CAACK,MAAM,CAAC,CAAC,CAACD,KAAK,CAAC,CAAC,CAACE,QAAQ,CAAC,CAAC;EACtCC,KAAK,EAAEP,GAAG,CAACK,MAAM,CAAC,CAAC,CAACG,GAAG,CAAC,CAAC,CAAC,CAACF,QAAQ,CAAC;AACtC,CAAC,CAAC;AAEFG,MAAM,CAACC,OAAO,GAAGR,WAAW","ignoreList":[]}},"mtime":1754576033491},"{\"assumptions\":{},\"sourceRoot\":\"/home/bernardo/sistema-atendimento-ti/ATNTI/src/routes/\",\"caller\":{\"name\":\"@babel/register\"},\"cwd\":\"/home/bernardo/sistema-atendimento-ti/ATNTI\",\"filename\":\"/home/bernardo/sistema-atendimento-ti/ATNTI/src/routes/userRoutes.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/home/bernardo/sistema-atendimento-ti/ATNTI\",\"rootMode\":\"root\",\"plugins\":[],\"presets\":[]}:7.28.0:development":{"value":{"code":"const express = require('express');\nconst router = express.Router();\nconst UserController = require('../controllers/userController');\nconst autenticarToken = require('../middlewares/authMiddleware');\nconst verificarAdmin = require('../middlewares/isAdmin');\nconst validarRequisicao = require('../middlewares/validarRequisicao');\nconst {\n  schemaUsuarioCreate,\n  schemaUsuarioUpdate,\n  schemaSenhaUpdate\n} = require('../validators/usuarioValidator');\n\n/**\n * @swagger\n * tags:\n *   - name: Usuários\n *     description: Endpoints para gerenciamento de usuários (restrito a administradores)\n *   - name: Perfil\n *     description: Endpoints para o usuário gerenciar seu próprio perfil\n *\n * paths:\n *   /usuarios:\n *     post:\n *       summary: Cadastra um novo usuário (apenas administradores)\n *       tags: [Usuários]\n *       security:\n *         - bearerAuth: []\n *       requestBody:\n *         required: true\n *         content:\n *           application/json:\n *             schema:\n *               type: object\n *               required: [nome, email, senha, tipo]\n *               properties:\n *                 nome:  { type: string }\n *                 email: { type: string }\n *                 senha: { type: string }\n *                 tipo:\n *                   type: string\n *                   enum: [comum, admin]\n *       responses:\n *         '201': { description: Usuário criado com sucesso }\n *         '400': { description: Dados inválidos ou e-mail duplicado }\n *         '403': { description: Acesso negado }\n *\n *     get:\n *       summary: Lista todos os usuários (admin)\n *       tags: [Usuários]\n *       security:\n *         - bearerAuth: []\n *       responses:\n *         '200': { description: Lista de usuários }\n *         '403': { description: Acesso negado }\n *\n *   /usuarios/{id}:\n *     parameters:\n *       - in: path\n *         name: id\n *         required: true\n *         schema: { type: integer }\n *\n *     get:\n *       summary: Obtém um usuário por ID (admin)\n *       tags: [Usuários]\n *       security:\n *         - bearerAuth: []\n *       responses:\n *         '200': { description: Dados do usuário }\n *         '403': { description: Acesso negado }\n *         '404': { description: Usuário não encontrado }\n *\n *     put:\n *       summary: Atualiza um usuário existente (admin)\n *       tags: [Usuários]\n *       security:\n *         - bearerAuth: []\n *       requestBody:\n *         required: true\n *         content:\n *           application/json:\n *             schema:\n *               type: object\n *               required: [nome, email]\n *               properties:\n *                 nome:  { type: string }\n *                 email: { type: string }\n *       responses:\n *         '200': { description: Usuário atualizado }\n *         '403': { description: Acesso negado }\n *         '404': { description: Usuário não encontrado }\n *\n *     delete:\n *       summary: Deleta um usuário por ID (admin)\n *       tags: [Usuários]\n *       security:\n *         - bearerAuth: []\n *       responses:\n *         '204': { description: Usuário deletado com sucesso }\n *         '403': { description: Acesso negado }\n *         '404': { description: Usuário não encontrado }\n *\n *   /usuarios/{id}/chamados:\n *     get:\n *       summary: Lista todos os chamados abertos por um usuário (admin)\n *       tags: [Usuários]\n *       security:\n *         - bearerAuth: []\n *       parameters:\n *         - in: path\n *           name: id\n *           required: true\n *           schema: { type: integer }\n *           description: ID do usuário para buscar os chamados\n *       responses:\n *         '200': { description: Lista de chamados do usuário }\n *         '404': { description: Nenhum chamado encontrado para este usuário }\n *         '403': { description: Acesso negado }\n *\n *   /perfil:\n *     put:\n *       summary: Atualiza o perfil do usuário logado\n *       tags: [Perfil]\n *       security:\n *         - bearerAuth: []\n *       requestBody:\n *         required: true\n *         content:\n *           application/json:\n *             schema:\n *               type: object\n *               required: [nome, email]\n *               properties:\n *                 nome:  { type: string }\n *                 email: { type: string }\n *       responses:\n *         '200': { description: Perfil atualizado com sucesso }\n *         '401': { description: Não autorizado }\n *\n *   /perfil/senha:\n *     put:\n *       summary: Altera a senha do usuário logado\n *       tags: [Perfil]\n *       security:\n *         - bearerAuth: []\n *       requestBody:\n *         required: true\n *         content:\n *           application/json:\n *             schema:\n *               type: object\n *               required: [senhaAntiga, novaSenha]\n *               properties:\n *                 senhaAntiga: { type: string }\n *                 novaSenha:   { type: string }\n *       responses:\n *         '204': { description: Senha alterada com sucesso }\n *         '400': { description: Senha antiga incorreta ou dados inválidos }\n *         '401': { description: Não autorizado }\n */\n\nrouter.post('/', autenticarToken, verificarAdmin, validarRequisicao(schemaUsuarioCreate), UserController.create);\nrouter.get('/', autenticarToken, verificarAdmin, UserController.index);\nrouter.get('/:id', autenticarToken, verificarAdmin, UserController.show);\nrouter.put('/:id', autenticarToken, verificarAdmin, validarRequisicao(schemaUsuarioUpdate), UserController.update);\nrouter.delete('/:id', autenticarToken, verificarAdmin, UserController.delete);\nrouter.put('/perfil', autenticarToken, validarRequisicao(schemaUsuarioUpdate), UserController.updateProfile);\nrouter.put('/perfil/senha', autenticarToken, validarRequisicao(schemaSenhaUpdate), UserController.updatePassword);\n// NOVO: Rota para buscar os chamados de um usuário\nrouter.get('/:id/chamados', autenticarToken, verificarAdmin, UserController.getChamadosDoUsuario);\nmodule.exports = router;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJleHByZXNzIiwicmVxdWlyZSIsInJvdXRlciIsIlJvdXRlciIsIlVzZXJDb250cm9sbGVyIiwiYXV0ZW50aWNhclRva2VuIiwidmVyaWZpY2FyQWRtaW4iLCJ2YWxpZGFyUmVxdWlzaWNhbyIsInNjaGVtYVVzdWFyaW9DcmVhdGUiLCJzY2hlbWFVc3VhcmlvVXBkYXRlIiwic2NoZW1hU2VuaGFVcGRhdGUiLCJwb3N0IiwiY3JlYXRlIiwiZ2V0IiwiaW5kZXgiLCJzaG93IiwicHV0IiwidXBkYXRlIiwiZGVsZXRlIiwidXBkYXRlUHJvZmlsZSIsInVwZGF0ZVBhc3N3b3JkIiwiZ2V0Q2hhbWFkb3NEb1VzdWFyaW8iLCJtb2R1bGUiLCJleHBvcnRzIl0sInNvdXJjZVJvb3QiOiIvaG9tZS9iZXJuYXJkby9zaXN0ZW1hLWF0ZW5kaW1lbnRvLXRpL0FUTlRJL3NyYy9yb3V0ZXMvIiwic291cmNlcyI6WyJ1c2VyUm91dGVzLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImNvbnN0IGV4cHJlc3MgPSByZXF1aXJlKCdleHByZXNzJyk7XG5jb25zdCByb3V0ZXIgPSBleHByZXNzLlJvdXRlcigpO1xuXG5jb25zdCBVc2VyQ29udHJvbGxlciA9IHJlcXVpcmUoJy4uL2NvbnRyb2xsZXJzL3VzZXJDb250cm9sbGVyJyk7XG5jb25zdCBhdXRlbnRpY2FyVG9rZW4gPSByZXF1aXJlKCcuLi9taWRkbGV3YXJlcy9hdXRoTWlkZGxld2FyZScpO1xuY29uc3QgdmVyaWZpY2FyQWRtaW4gPSByZXF1aXJlKCcuLi9taWRkbGV3YXJlcy9pc0FkbWluJyk7XG5jb25zdCB2YWxpZGFyUmVxdWlzaWNhbyA9IHJlcXVpcmUoJy4uL21pZGRsZXdhcmVzL3ZhbGlkYXJSZXF1aXNpY2FvJyk7XG5jb25zdCB7IHNjaGVtYVVzdWFyaW9DcmVhdGUsIHNjaGVtYVVzdWFyaW9VcGRhdGUsIHNjaGVtYVNlbmhhVXBkYXRlIH0gPSByZXF1aXJlKCcuLi92YWxpZGF0b3JzL3VzdWFyaW9WYWxpZGF0b3InKTtcblxuLyoqXG4gKiBAc3dhZ2dlclxuICogdGFnczpcbiAqICAgLSBuYW1lOiBVc3XDoXJpb3NcbiAqICAgICBkZXNjcmlwdGlvbjogRW5kcG9pbnRzIHBhcmEgZ2VyZW5jaWFtZW50byBkZSB1c3XDoXJpb3MgKHJlc3RyaXRvIGEgYWRtaW5pc3RyYWRvcmVzKVxuICogICAtIG5hbWU6IFBlcmZpbFxuICogICAgIGRlc2NyaXB0aW9uOiBFbmRwb2ludHMgcGFyYSBvIHVzdcOhcmlvIGdlcmVuY2lhciBzZXUgcHLDs3ByaW8gcGVyZmlsXG4gKlxuICogcGF0aHM6XG4gKiAgIC91c3VhcmlvczpcbiAqICAgICBwb3N0OlxuICogICAgICAgc3VtbWFyeTogQ2FkYXN0cmEgdW0gbm92byB1c3XDoXJpbyAoYXBlbmFzIGFkbWluaXN0cmFkb3JlcylcbiAqICAgICAgIHRhZ3M6IFtVc3XDoXJpb3NdXG4gKiAgICAgICBzZWN1cml0eTpcbiAqICAgICAgICAgLSBiZWFyZXJBdXRoOiBbXVxuICogICAgICAgcmVxdWVzdEJvZHk6XG4gKiAgICAgICAgIHJlcXVpcmVkOiB0cnVlXG4gKiAgICAgICAgIGNvbnRlbnQ6XG4gKiAgICAgICAgICAgYXBwbGljYXRpb24vanNvbjpcbiAqICAgICAgICAgICAgIHNjaGVtYTpcbiAqICAgICAgICAgICAgICAgdHlwZTogb2JqZWN0XG4gKiAgICAgICAgICAgICAgIHJlcXVpcmVkOiBbbm9tZSwgZW1haWwsIHNlbmhhLCB0aXBvXVxuICogICAgICAgICAgICAgICBwcm9wZXJ0aWVzOlxuICogICAgICAgICAgICAgICAgIG5vbWU6ICB7IHR5cGU6IHN0cmluZyB9XG4gKiAgICAgICAgICAgICAgICAgZW1haWw6IHsgdHlwZTogc3RyaW5nIH1cbiAqICAgICAgICAgICAgICAgICBzZW5oYTogeyB0eXBlOiBzdHJpbmcgfVxuICogICAgICAgICAgICAgICAgIHRpcG86XG4gKiAgICAgICAgICAgICAgICAgICB0eXBlOiBzdHJpbmdcbiAqICAgICAgICAgICAgICAgICAgIGVudW06IFtjb211bSwgYWRtaW5dXG4gKiAgICAgICByZXNwb25zZXM6XG4gKiAgICAgICAgICcyMDEnOiB7IGRlc2NyaXB0aW9uOiBVc3XDoXJpbyBjcmlhZG8gY29tIHN1Y2Vzc28gfVxuICogICAgICAgICAnNDAwJzogeyBkZXNjcmlwdGlvbjogRGFkb3MgaW52w6FsaWRvcyBvdSBlLW1haWwgZHVwbGljYWRvIH1cbiAqICAgICAgICAgJzQwMyc6IHsgZGVzY3JpcHRpb246IEFjZXNzbyBuZWdhZG8gfVxuICpcbiAqICAgICBnZXQ6XG4gKiAgICAgICBzdW1tYXJ5OiBMaXN0YSB0b2RvcyBvcyB1c3XDoXJpb3MgKGFkbWluKVxuICogICAgICAgdGFnczogW1VzdcOhcmlvc11cbiAqICAgICAgIHNlY3VyaXR5OlxuICogICAgICAgICAtIGJlYXJlckF1dGg6IFtdXG4gKiAgICAgICByZXNwb25zZXM6XG4gKiAgICAgICAgICcyMDAnOiB7IGRlc2NyaXB0aW9uOiBMaXN0YSBkZSB1c3XDoXJpb3MgfVxuICogICAgICAgICAnNDAzJzogeyBkZXNjcmlwdGlvbjogQWNlc3NvIG5lZ2FkbyB9XG4gKlxuICogICAvdXN1YXJpb3Mve2lkfTpcbiAqICAgICBwYXJhbWV0ZXJzOlxuICogICAgICAgLSBpbjogcGF0aFxuICogICAgICAgICBuYW1lOiBpZFxuICogICAgICAgICByZXF1aXJlZDogdHJ1ZVxuICogICAgICAgICBzY2hlbWE6IHsgdHlwZTogaW50ZWdlciB9XG4gKlxuICogICAgIGdldDpcbiAqICAgICAgIHN1bW1hcnk6IE9idMOpbSB1bSB1c3XDoXJpbyBwb3IgSUQgKGFkbWluKVxuICogICAgICAgdGFnczogW1VzdcOhcmlvc11cbiAqICAgICAgIHNlY3VyaXR5OlxuICogICAgICAgICAtIGJlYXJlckF1dGg6IFtdXG4gKiAgICAgICByZXNwb25zZXM6XG4gKiAgICAgICAgICcyMDAnOiB7IGRlc2NyaXB0aW9uOiBEYWRvcyBkbyB1c3XDoXJpbyB9XG4gKiAgICAgICAgICc0MDMnOiB7IGRlc2NyaXB0aW9uOiBBY2Vzc28gbmVnYWRvIH1cbiAqICAgICAgICAgJzQwNCc6IHsgZGVzY3JpcHRpb246IFVzdcOhcmlvIG7Do28gZW5jb250cmFkbyB9XG4gKlxuICogICAgIHB1dDpcbiAqICAgICAgIHN1bW1hcnk6IEF0dWFsaXphIHVtIHVzdcOhcmlvIGV4aXN0ZW50ZSAoYWRtaW4pXG4gKiAgICAgICB0YWdzOiBbVXN1w6FyaW9zXVxuICogICAgICAgc2VjdXJpdHk6XG4gKiAgICAgICAgIC0gYmVhcmVyQXV0aDogW11cbiAqICAgICAgIHJlcXVlc3RCb2R5OlxuICogICAgICAgICByZXF1aXJlZDogdHJ1ZVxuICogICAgICAgICBjb250ZW50OlxuICogICAgICAgICAgIGFwcGxpY2F0aW9uL2pzb246XG4gKiAgICAgICAgICAgICBzY2hlbWE6XG4gKiAgICAgICAgICAgICAgIHR5cGU6IG9iamVjdFxuICogICAgICAgICAgICAgICByZXF1aXJlZDogW25vbWUsIGVtYWlsXVxuICogICAgICAgICAgICAgICBwcm9wZXJ0aWVzOlxuICogICAgICAgICAgICAgICAgIG5vbWU6ICB7IHR5cGU6IHN0cmluZyB9XG4gKiAgICAgICAgICAgICAgICAgZW1haWw6IHsgdHlwZTogc3RyaW5nIH1cbiAqICAgICAgIHJlc3BvbnNlczpcbiAqICAgICAgICAgJzIwMCc6IHsgZGVzY3JpcHRpb246IFVzdcOhcmlvIGF0dWFsaXphZG8gfVxuICogICAgICAgICAnNDAzJzogeyBkZXNjcmlwdGlvbjogQWNlc3NvIG5lZ2FkbyB9XG4gKiAgICAgICAgICc0MDQnOiB7IGRlc2NyaXB0aW9uOiBVc3XDoXJpbyBuw6NvIGVuY29udHJhZG8gfVxuICpcbiAqICAgICBkZWxldGU6XG4gKiAgICAgICBzdW1tYXJ5OiBEZWxldGEgdW0gdXN1w6FyaW8gcG9yIElEIChhZG1pbilcbiAqICAgICAgIHRhZ3M6IFtVc3XDoXJpb3NdXG4gKiAgICAgICBzZWN1cml0eTpcbiAqICAgICAgICAgLSBiZWFyZXJBdXRoOiBbXVxuICogICAgICAgcmVzcG9uc2VzOlxuICogICAgICAgICAnMjA0JzogeyBkZXNjcmlwdGlvbjogVXN1w6FyaW8gZGVsZXRhZG8gY29tIHN1Y2Vzc28gfVxuICogICAgICAgICAnNDAzJzogeyBkZXNjcmlwdGlvbjogQWNlc3NvIG5lZ2FkbyB9XG4gKiAgICAgICAgICc0MDQnOiB7IGRlc2NyaXB0aW9uOiBVc3XDoXJpbyBuw6NvIGVuY29udHJhZG8gfVxuICpcbiAqICAgL3VzdWFyaW9zL3tpZH0vY2hhbWFkb3M6XG4gKiAgICAgZ2V0OlxuICogICAgICAgc3VtbWFyeTogTGlzdGEgdG9kb3Mgb3MgY2hhbWFkb3MgYWJlcnRvcyBwb3IgdW0gdXN1w6FyaW8gKGFkbWluKVxuICogICAgICAgdGFnczogW1VzdcOhcmlvc11cbiAqICAgICAgIHNlY3VyaXR5OlxuICogICAgICAgICAtIGJlYXJlckF1dGg6IFtdXG4gKiAgICAgICBwYXJhbWV0ZXJzOlxuICogICAgICAgICAtIGluOiBwYXRoXG4gKiAgICAgICAgICAgbmFtZTogaWRcbiAqICAgICAgICAgICByZXF1aXJlZDogdHJ1ZVxuICogICAgICAgICAgIHNjaGVtYTogeyB0eXBlOiBpbnRlZ2VyIH1cbiAqICAgICAgICAgICBkZXNjcmlwdGlvbjogSUQgZG8gdXN1w6FyaW8gcGFyYSBidXNjYXIgb3MgY2hhbWFkb3NcbiAqICAgICAgIHJlc3BvbnNlczpcbiAqICAgICAgICAgJzIwMCc6IHsgZGVzY3JpcHRpb246IExpc3RhIGRlIGNoYW1hZG9zIGRvIHVzdcOhcmlvIH1cbiAqICAgICAgICAgJzQwNCc6IHsgZGVzY3JpcHRpb246IE5lbmh1bSBjaGFtYWRvIGVuY29udHJhZG8gcGFyYSBlc3RlIHVzdcOhcmlvIH1cbiAqICAgICAgICAgJzQwMyc6IHsgZGVzY3JpcHRpb246IEFjZXNzbyBuZWdhZG8gfVxuICpcbiAqICAgL3BlcmZpbDpcbiAqICAgICBwdXQ6XG4gKiAgICAgICBzdW1tYXJ5OiBBdHVhbGl6YSBvIHBlcmZpbCBkbyB1c3XDoXJpbyBsb2dhZG9cbiAqICAgICAgIHRhZ3M6IFtQZXJmaWxdXG4gKiAgICAgICBzZWN1cml0eTpcbiAqICAgICAgICAgLSBiZWFyZXJBdXRoOiBbXVxuICogICAgICAgcmVxdWVzdEJvZHk6XG4gKiAgICAgICAgIHJlcXVpcmVkOiB0cnVlXG4gKiAgICAgICAgIGNvbnRlbnQ6XG4gKiAgICAgICAgICAgYXBwbGljYXRpb24vanNvbjpcbiAqICAgICAgICAgICAgIHNjaGVtYTpcbiAqICAgICAgICAgICAgICAgdHlwZTogb2JqZWN0XG4gKiAgICAgICAgICAgICAgIHJlcXVpcmVkOiBbbm9tZSwgZW1haWxdXG4gKiAgICAgICAgICAgICAgIHByb3BlcnRpZXM6XG4gKiAgICAgICAgICAgICAgICAgbm9tZTogIHsgdHlwZTogc3RyaW5nIH1cbiAqICAgICAgICAgICAgICAgICBlbWFpbDogeyB0eXBlOiBzdHJpbmcgfVxuICogICAgICAgcmVzcG9uc2VzOlxuICogICAgICAgICAnMjAwJzogeyBkZXNjcmlwdGlvbjogUGVyZmlsIGF0dWFsaXphZG8gY29tIHN1Y2Vzc28gfVxuICogICAgICAgICAnNDAxJzogeyBkZXNjcmlwdGlvbjogTsOjbyBhdXRvcml6YWRvIH1cbiAqXG4gKiAgIC9wZXJmaWwvc2VuaGE6XG4gKiAgICAgcHV0OlxuICogICAgICAgc3VtbWFyeTogQWx0ZXJhIGEgc2VuaGEgZG8gdXN1w6FyaW8gbG9nYWRvXG4gKiAgICAgICB0YWdzOiBbUGVyZmlsXVxuICogICAgICAgc2VjdXJpdHk6XG4gKiAgICAgICAgIC0gYmVhcmVyQXV0aDogW11cbiAqICAgICAgIHJlcXVlc3RCb2R5OlxuICogICAgICAgICByZXF1aXJlZDogdHJ1ZVxuICogICAgICAgICBjb250ZW50OlxuICogICAgICAgICAgIGFwcGxpY2F0aW9uL2pzb246XG4gKiAgICAgICAgICAgICBzY2hlbWE6XG4gKiAgICAgICAgICAgICAgIHR5cGU6IG9iamVjdFxuICogICAgICAgICAgICAgICByZXF1aXJlZDogW3NlbmhhQW50aWdhLCBub3ZhU2VuaGFdXG4gKiAgICAgICAgICAgICAgIHByb3BlcnRpZXM6XG4gKiAgICAgICAgICAgICAgICAgc2VuaGFBbnRpZ2E6IHsgdHlwZTogc3RyaW5nIH1cbiAqICAgICAgICAgICAgICAgICBub3ZhU2VuaGE6ICAgeyB0eXBlOiBzdHJpbmcgfVxuICogICAgICAgcmVzcG9uc2VzOlxuICogICAgICAgICAnMjA0JzogeyBkZXNjcmlwdGlvbjogU2VuaGEgYWx0ZXJhZGEgY29tIHN1Y2Vzc28gfVxuICogICAgICAgICAnNDAwJzogeyBkZXNjcmlwdGlvbjogU2VuaGEgYW50aWdhIGluY29ycmV0YSBvdSBkYWRvcyBpbnbDoWxpZG9zIH1cbiAqICAgICAgICAgJzQwMSc6IHsgZGVzY3JpcHRpb246IE7Do28gYXV0b3JpemFkbyB9XG4gKi9cblxucm91dGVyLnBvc3QoJy8nLCBhdXRlbnRpY2FyVG9rZW4sIHZlcmlmaWNhckFkbWluLCB2YWxpZGFyUmVxdWlzaWNhbyhzY2hlbWFVc3VhcmlvQ3JlYXRlKSwgVXNlckNvbnRyb2xsZXIuY3JlYXRlKTtcbnJvdXRlci5nZXQoJy8nLCBhdXRlbnRpY2FyVG9rZW4sIHZlcmlmaWNhckFkbWluLCBVc2VyQ29udHJvbGxlci5pbmRleCk7XG5yb3V0ZXIuZ2V0KCcvOmlkJywgYXV0ZW50aWNhclRva2VuLCB2ZXJpZmljYXJBZG1pbiwgVXNlckNvbnRyb2xsZXIuc2hvdyk7XG5yb3V0ZXIucHV0KCcvOmlkJywgYXV0ZW50aWNhclRva2VuLCB2ZXJpZmljYXJBZG1pbiwgdmFsaWRhclJlcXVpc2ljYW8oc2NoZW1hVXN1YXJpb1VwZGF0ZSksIFVzZXJDb250cm9sbGVyLnVwZGF0ZSk7XG5yb3V0ZXIuZGVsZXRlKCcvOmlkJywgYXV0ZW50aWNhclRva2VuLCB2ZXJpZmljYXJBZG1pbiwgVXNlckNvbnRyb2xsZXIuZGVsZXRlKTtcbnJvdXRlci5wdXQoJy9wZXJmaWwnLCBhdXRlbnRpY2FyVG9rZW4sIHZhbGlkYXJSZXF1aXNpY2FvKHNjaGVtYVVzdWFyaW9VcGRhdGUpLCBVc2VyQ29udHJvbGxlci51cGRhdGVQcm9maWxlKTtcbnJvdXRlci5wdXQoJy9wZXJmaWwvc2VuaGEnLCBhdXRlbnRpY2FyVG9rZW4sIHZhbGlkYXJSZXF1aXNpY2FvKHNjaGVtYVNlbmhhVXBkYXRlKSwgVXNlckNvbnRyb2xsZXIudXBkYXRlUGFzc3dvcmQpO1xuLy8gTk9WTzogUm90YSBwYXJhIGJ1c2NhciBvcyBjaGFtYWRvcyBkZSB1bSB1c3XDoXJpb1xucm91dGVyLmdldCgnLzppZC9jaGFtYWRvcycsIGF1dGVudGljYXJUb2tlbiwgdmVyaWZpY2FyQWRtaW4sIFVzZXJDb250cm9sbGVyLmdldENoYW1hZG9zRG9Vc3VhcmlvKTtcblxubW9kdWxlLmV4cG9ydHMgPSByb3V0ZXI7Il0sIm1hcHBpbmdzIjoiQUFBQSxNQUFNQSxPQUFPLEdBQUdDLE9BQU8sQ0FBQyxTQUFTLENBQUM7QUFDbEMsTUFBTUMsTUFBTSxHQUFHRixPQUFPLENBQUNHLE1BQU0sQ0FBQyxDQUFDO0FBRS9CLE1BQU1DLGNBQWMsR0FBR0gsT0FBTyxDQUFDLCtCQUErQixDQUFDO0FBQy9ELE1BQU1JLGVBQWUsR0FBR0osT0FBTyxDQUFDLCtCQUErQixDQUFDO0FBQ2hFLE1BQU1LLGNBQWMsR0FBR0wsT0FBTyxDQUFDLHdCQUF3QixDQUFDO0FBQ3hELE1BQU1NLGlCQUFpQixHQUFHTixPQUFPLENBQUMsa0NBQWtDLENBQUM7QUFDckUsTUFBTTtFQUFFTyxtQkFBbUI7RUFBRUMsbUJBQW1CO0VBQUVDO0FBQWtCLENBQUMsR0FBR1QsT0FBTyxDQUFDLGdDQUFnQyxDQUFDOztBQUVqSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQUMsTUFBTSxDQUFDUyxJQUFJLENBQUMsR0FBRyxFQUFFTixlQUFlLEVBQUVDLGNBQWMsRUFBRUMsaUJBQWlCLENBQUNDLG1CQUFtQixDQUFDLEVBQUVKLGNBQWMsQ0FBQ1EsTUFBTSxDQUFDO0FBQ2hIVixNQUFNLENBQUNXLEdBQUcsQ0FBQyxHQUFHLEVBQUVSLGVBQWUsRUFBRUMsY0FBYyxFQUFFRixjQUFjLENBQUNVLEtBQUssQ0FBQztBQUN0RVosTUFBTSxDQUFDVyxHQUFHLENBQUMsTUFBTSxFQUFFUixlQUFlLEVBQUVDLGNBQWMsRUFBRUYsY0FBYyxDQUFDVyxJQUFJLENBQUM7QUFDeEViLE1BQU0sQ0FBQ2MsR0FBRyxDQUFDLE1BQU0sRUFBRVgsZUFBZSxFQUFFQyxjQUFjLEVBQUVDLGlCQUFpQixDQUFDRSxtQkFBbUIsQ0FBQyxFQUFFTCxjQUFjLENBQUNhLE1BQU0sQ0FBQztBQUNsSGYsTUFBTSxDQUFDZ0IsTUFBTSxDQUFDLE1BQU0sRUFBRWIsZUFBZSxFQUFFQyxjQUFjLEVBQUVGLGNBQWMsQ0FBQ2MsTUFBTSxDQUFDO0FBQzdFaEIsTUFBTSxDQUFDYyxHQUFHLENBQUMsU0FBUyxFQUFFWCxlQUFlLEVBQUVFLGlCQUFpQixDQUFDRSxtQkFBbUIsQ0FBQyxFQUFFTCxjQUFjLENBQUNlLGFBQWEsQ0FBQztBQUM1R2pCLE1BQU0sQ0FBQ2MsR0FBRyxDQUFDLGVBQWUsRUFBRVgsZUFBZSxFQUFFRSxpQkFBaUIsQ0FBQ0csaUJBQWlCLENBQUMsRUFBRU4sY0FBYyxDQUFDZ0IsY0FBYyxDQUFDO0FBQ2pIO0FBQ0FsQixNQUFNLENBQUNXLEdBQUcsQ0FBQyxlQUFlLEVBQUVSLGVBQWUsRUFBRUMsY0FBYyxFQUFFRixjQUFjLENBQUNpQixvQkFBb0IsQ0FBQztBQUVqR0MsTUFBTSxDQUFDQyxPQUFPLEdBQUdyQixNQUFNIiwiaWdub3JlTGlzdCI6W119","map":{"version":3,"names":["express","require","router","Router","UserController","autenticarToken","verificarAdmin","validarRequisicao","schemaUsuarioCreate","schemaUsuarioUpdate","schemaSenhaUpdate","post","create","get","index","show","put","update","delete","updateProfile","updatePassword","getChamadosDoUsuario","module","exports"],"sourceRoot":"/home/bernardo/sistema-atendimento-ti/ATNTI/src/routes/","sources":["userRoutes.js"],"sourcesContent":["const express = require('express');\nconst router = express.Router();\n\nconst UserController = require('../controllers/userController');\nconst autenticarToken = require('../middlewares/authMiddleware');\nconst verificarAdmin = require('../middlewares/isAdmin');\nconst validarRequisicao = require('../middlewares/validarRequisicao');\nconst { schemaUsuarioCreate, schemaUsuarioUpdate, schemaSenhaUpdate } = require('../validators/usuarioValidator');\n\n/**\n * @swagger\n * tags:\n *   - name: Usuários\n *     description: Endpoints para gerenciamento de usuários (restrito a administradores)\n *   - name: Perfil\n *     description: Endpoints para o usuário gerenciar seu próprio perfil\n *\n * paths:\n *   /usuarios:\n *     post:\n *       summary: Cadastra um novo usuário (apenas administradores)\n *       tags: [Usuários]\n *       security:\n *         - bearerAuth: []\n *       requestBody:\n *         required: true\n *         content:\n *           application/json:\n *             schema:\n *               type: object\n *               required: [nome, email, senha, tipo]\n *               properties:\n *                 nome:  { type: string }\n *                 email: { type: string }\n *                 senha: { type: string }\n *                 tipo:\n *                   type: string\n *                   enum: [comum, admin]\n *       responses:\n *         '201': { description: Usuário criado com sucesso }\n *         '400': { description: Dados inválidos ou e-mail duplicado }\n *         '403': { description: Acesso negado }\n *\n *     get:\n *       summary: Lista todos os usuários (admin)\n *       tags: [Usuários]\n *       security:\n *         - bearerAuth: []\n *       responses:\n *         '200': { description: Lista de usuários }\n *         '403': { description: Acesso negado }\n *\n *   /usuarios/{id}:\n *     parameters:\n *       - in: path\n *         name: id\n *         required: true\n *         schema: { type: integer }\n *\n *     get:\n *       summary: Obtém um usuário por ID (admin)\n *       tags: [Usuários]\n *       security:\n *         - bearerAuth: []\n *       responses:\n *         '200': { description: Dados do usuário }\n *         '403': { description: Acesso negado }\n *         '404': { description: Usuário não encontrado }\n *\n *     put:\n *       summary: Atualiza um usuário existente (admin)\n *       tags: [Usuários]\n *       security:\n *         - bearerAuth: []\n *       requestBody:\n *         required: true\n *         content:\n *           application/json:\n *             schema:\n *               type: object\n *               required: [nome, email]\n *               properties:\n *                 nome:  { type: string }\n *                 email: { type: string }\n *       responses:\n *         '200': { description: Usuário atualizado }\n *         '403': { description: Acesso negado }\n *         '404': { description: Usuário não encontrado }\n *\n *     delete:\n *       summary: Deleta um usuário por ID (admin)\n *       tags: [Usuários]\n *       security:\n *         - bearerAuth: []\n *       responses:\n *         '204': { description: Usuário deletado com sucesso }\n *         '403': { description: Acesso negado }\n *         '404': { description: Usuário não encontrado }\n *\n *   /usuarios/{id}/chamados:\n *     get:\n *       summary: Lista todos os chamados abertos por um usuário (admin)\n *       tags: [Usuários]\n *       security:\n *         - bearerAuth: []\n *       parameters:\n *         - in: path\n *           name: id\n *           required: true\n *           schema: { type: integer }\n *           description: ID do usuário para buscar os chamados\n *       responses:\n *         '200': { description: Lista de chamados do usuário }\n *         '404': { description: Nenhum chamado encontrado para este usuário }\n *         '403': { description: Acesso negado }\n *\n *   /perfil:\n *     put:\n *       summary: Atualiza o perfil do usuário logado\n *       tags: [Perfil]\n *       security:\n *         - bearerAuth: []\n *       requestBody:\n *         required: true\n *         content:\n *           application/json:\n *             schema:\n *               type: object\n *               required: [nome, email]\n *               properties:\n *                 nome:  { type: string }\n *                 email: { type: string }\n *       responses:\n *         '200': { description: Perfil atualizado com sucesso }\n *         '401': { description: Não autorizado }\n *\n *   /perfil/senha:\n *     put:\n *       summary: Altera a senha do usuário logado\n *       tags: [Perfil]\n *       security:\n *         - bearerAuth: []\n *       requestBody:\n *         required: true\n *         content:\n *           application/json:\n *             schema:\n *               type: object\n *               required: [senhaAntiga, novaSenha]\n *               properties:\n *                 senhaAntiga: { type: string }\n *                 novaSenha:   { type: string }\n *       responses:\n *         '204': { description: Senha alterada com sucesso }\n *         '400': { description: Senha antiga incorreta ou dados inválidos }\n *         '401': { description: Não autorizado }\n */\n\nrouter.post('/', autenticarToken, verificarAdmin, validarRequisicao(schemaUsuarioCreate), UserController.create);\nrouter.get('/', autenticarToken, verificarAdmin, UserController.index);\nrouter.get('/:id', autenticarToken, verificarAdmin, UserController.show);\nrouter.put('/:id', autenticarToken, verificarAdmin, validarRequisicao(schemaUsuarioUpdate), UserController.update);\nrouter.delete('/:id', autenticarToken, verificarAdmin, UserController.delete);\nrouter.put('/perfil', autenticarToken, validarRequisicao(schemaUsuarioUpdate), UserController.updateProfile);\nrouter.put('/perfil/senha', autenticarToken, validarRequisicao(schemaSenhaUpdate), UserController.updatePassword);\n// NOVO: Rota para buscar os chamados de um usuário\nrouter.get('/:id/chamados', autenticarToken, verificarAdmin, UserController.getChamadosDoUsuario);\n\nmodule.exports = router;"],"mappings":"AAAA,MAAMA,OAAO,GAAGC,OAAO,CAAC,SAAS,CAAC;AAClC,MAAMC,MAAM,GAAGF,OAAO,CAACG,MAAM,CAAC,CAAC;AAE/B,MAAMC,cAAc,GAAGH,OAAO,CAAC,+BAA+B,CAAC;AAC/D,MAAMI,eAAe,GAAGJ,OAAO,CAAC,+BAA+B,CAAC;AAChE,MAAMK,cAAc,GAAGL,OAAO,CAAC,wBAAwB,CAAC;AACxD,MAAMM,iBAAiB,GAAGN,OAAO,CAAC,kCAAkC,CAAC;AACrE,MAAM;EAAEO,mBAAmB;EAAEC,mBAAmB;EAAEC;AAAkB,CAAC,GAAGT,OAAO,CAAC,gCAAgC,CAAC;;AAEjH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEAC,MAAM,CAACS,IAAI,CAAC,GAAG,EAAEN,eAAe,EAAEC,cAAc,EAAEC,iBAAiB,CAACC,mBAAmB,CAAC,EAAEJ,cAAc,CAACQ,MAAM,CAAC;AAChHV,MAAM,CAACW,GAAG,CAAC,GAAG,EAAER,eAAe,EAAEC,cAAc,EAAEF,cAAc,CAACU,KAAK,CAAC;AACtEZ,MAAM,CAACW,GAAG,CAAC,MAAM,EAAER,eAAe,EAAEC,cAAc,EAAEF,cAAc,CAACW,IAAI,CAAC;AACxEb,MAAM,CAACc,GAAG,CAAC,MAAM,EAAEX,eAAe,EAAEC,cAAc,EAAEC,iBAAiB,CAACE,mBAAmB,CAAC,EAAEL,cAAc,CAACa,MAAM,CAAC;AAClHf,MAAM,CAACgB,MAAM,CAAC,MAAM,EAAEb,eAAe,EAAEC,cAAc,EAAEF,cAAc,CAACc,MAAM,CAAC;AAC7EhB,MAAM,CAACc,GAAG,CAAC,SAAS,EAAEX,eAAe,EAAEE,iBAAiB,CAACE,mBAAmB,CAAC,EAAEL,cAAc,CAACe,aAAa,CAAC;AAC5GjB,MAAM,CAACc,GAAG,CAAC,eAAe,EAAEX,eAAe,EAAEE,iBAAiB,CAACG,iBAAiB,CAAC,EAAEN,cAAc,CAACgB,cAAc,CAAC;AACjH;AACAlB,MAAM,CAACW,GAAG,CAAC,eAAe,EAAER,eAAe,EAAEC,cAAc,EAAEF,cAAc,CAACiB,oBAAoB,CAAC;AAEjGC,MAAM,CAACC,OAAO,GAAGrB,MAAM","ignoreList":[]}},"mtime":1754589088705},"{\"assumptions\":{},\"sourceRoot\":\"/home/bernardo/sistema-atendimento-ti/ATNTI/src/controllers/\",\"caller\":{\"name\":\"@babel/register\"},\"cwd\":\"/home/bernardo/sistema-atendimento-ti/ATNTI\",\"filename\":\"/home/bernardo/sistema-atendimento-ti/ATNTI/src/controllers/userController.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/home/bernardo/sistema-atendimento-ti/ATNTI\",\"rootMode\":\"root\",\"plugins\":[],\"presets\":[]}:7.28.0:development":{"value":{"code":"const bcrypt = require('bcrypt');\nconst UserModel = require('../models/userModel');\nconst ChamadoModel = require('../models/chamadoModel');\nconst UserController = {\n  async create(req, res, next) {\n    try {\n      const {\n        nome,\n        email,\n        senha\n      } = req.body;\n      const hashed = await bcrypt.hash(senha, 10);\n      const user = await UserModel.create({\n        nome,\n        email,\n        senha: hashed\n      });\n      res.status(201).json(user);\n    } catch (err) {\n      if (err.message === 'E-mail já cadastrado') {\n        return res.status(400).json({\n          erro: err.message\n        });\n      }\n      next(err);\n    }\n  },\n  async index(req, res, next) {\n    try {\n      const users = await UserModel.findAll();\n      res.json(users);\n    } catch (err) {\n      next(err);\n    }\n  },\n  async show(req, res, next) {\n    try {\n      const user = await UserModel.findById(req.params.id);\n      if (!user) {\n        return res.status(404).json({\n          erro: 'Usuário não encontrado'\n        });\n      }\n      res.json(user);\n    } catch (err) {\n      next(err);\n    }\n  },\n  async update(req, res, next) {\n    try {\n      const {\n        nome,\n        email\n      } = req.body;\n      const existente = await UserModel.findById(req.params.id);\n      if (!existente) {\n        return res.status(404).json({\n          erro: 'Usuário não encontrado'\n        });\n      }\n      const user = await UserModel.update(req.params.id, {\n        nome,\n        email\n      });\n      res.json(user);\n    } catch (err) {\n      next(err);\n    }\n  },\n  async updateProfile(req, res, next) {\n    try {\n      const {\n        id\n      } = req.usuario;\n      const {\n        nome,\n        email\n      } = req.body;\n      const user = await UserModel.update(id, {\n        nome,\n        email\n      });\n      res.json(user);\n    } catch (err) {\n      next(err);\n    }\n  },\n  async updatePassword(req, res, next) {\n    try {\n      const {\n        id\n      } = req.usuario;\n      const {\n        senhaAntiga,\n        novaSenha\n      } = req.body;\n      const user = await UserModel.findById(id);\n      if (!user) {\n        return res.status(404).json({\n          erro: 'Usuário não encontrado'\n        });\n      }\n      const senhaValida = await bcrypt.compare(senhaAntiga, user.senha);\n      if (!senhaValida) {\n        return res.status(400).json({\n          erro: 'Senha antiga incorreta'\n        });\n      }\n      const hashed = await bcrypt.hash(novaSenha, 10);\n      await UserModel.updatePassword(id, hashed);\n      res.status(204).send();\n    } catch (err) {\n      next(err);\n    }\n  },\n  async delete(req, res, next) {\n    try {\n      const existente = await UserModel.findById(req.params.id);\n      if (!existente) {\n        return res.status(404).json({\n          erro: 'Usuário não encontrado'\n        });\n      }\n      await UserModel.delete(req.params.id);\n      res.status(204).send();\n    } catch (err) {\n      next(err);\n    }\n  },\n  async getChamadosDoUsuario(req, res, next) {\n    try {\n      const {\n        id\n      } = req.params;\n      const chamados = await ChamadoModel.findByUsuarioId(id);\n      if (!chamados.length) {\n        return res.status(404).json({\n          erro: 'Nenhum chamado encontrado para este usuário.'\n        });\n      }\n      res.json(chamados);\n    } catch (err) {\n      next(err);\n    }\n  }\n};\nmodule.exports = UserController;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJiY3J5cHQiLCJyZXF1aXJlIiwiVXNlck1vZGVsIiwiQ2hhbWFkb01vZGVsIiwiVXNlckNvbnRyb2xsZXIiLCJjcmVhdGUiLCJyZXEiLCJyZXMiLCJuZXh0Iiwibm9tZSIsImVtYWlsIiwic2VuaGEiLCJib2R5IiwiaGFzaGVkIiwiaGFzaCIsInVzZXIiLCJzdGF0dXMiLCJqc29uIiwiZXJyIiwibWVzc2FnZSIsImVycm8iLCJpbmRleCIsInVzZXJzIiwiZmluZEFsbCIsInNob3ciLCJmaW5kQnlJZCIsInBhcmFtcyIsImlkIiwidXBkYXRlIiwiZXhpc3RlbnRlIiwidXBkYXRlUHJvZmlsZSIsInVzdWFyaW8iLCJ1cGRhdGVQYXNzd29yZCIsInNlbmhhQW50aWdhIiwibm92YVNlbmhhIiwic2VuaGFWYWxpZGEiLCJjb21wYXJlIiwic2VuZCIsImRlbGV0ZSIsImdldENoYW1hZG9zRG9Vc3VhcmlvIiwiY2hhbWFkb3MiLCJmaW5kQnlVc3VhcmlvSWQiLCJsZW5ndGgiLCJtb2R1bGUiLCJleHBvcnRzIl0sInNvdXJjZVJvb3QiOiIvaG9tZS9iZXJuYXJkby9zaXN0ZW1hLWF0ZW5kaW1lbnRvLXRpL0FUTlRJL3NyYy9jb250cm9sbGVycy8iLCJzb3VyY2VzIjpbInVzZXJDb250cm9sbGVyLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImNvbnN0IGJjcnlwdCA9IHJlcXVpcmUoJ2JjcnlwdCcpO1xuY29uc3QgVXNlck1vZGVsID0gcmVxdWlyZSgnLi4vbW9kZWxzL3VzZXJNb2RlbCcpO1xuY29uc3QgQ2hhbWFkb01vZGVsID0gcmVxdWlyZSgnLi4vbW9kZWxzL2NoYW1hZG9Nb2RlbCcpO1xuXG5jb25zdCBVc2VyQ29udHJvbGxlciA9IHtcbiAgYXN5bmMgY3JlYXRlKHJlcSwgcmVzLCBuZXh0KSB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHsgbm9tZSwgZW1haWwsIHNlbmhhIH0gPSByZXEuYm9keTtcbiAgICAgIGNvbnN0IGhhc2hlZCA9IGF3YWl0IGJjcnlwdC5oYXNoKHNlbmhhLCAxMCk7XG4gICAgICBjb25zdCB1c2VyID0gYXdhaXQgVXNlck1vZGVsLmNyZWF0ZSh7IG5vbWUsIGVtYWlsLCBzZW5oYTogaGFzaGVkIH0pO1xuICAgICAgcmVzLnN0YXR1cygyMDEpLmpzb24odXNlcik7XG4gICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICBpZiAoZXJyLm1lc3NhZ2UgPT09ICdFLW1haWwgasOhIGNhZGFzdHJhZG8nKSB7XG4gICAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuanNvbih7IGVycm86IGVyci5tZXNzYWdlIH0pO1xuICAgICAgfVxuICAgICAgbmV4dChlcnIpO1xuICAgIH1cbiAgfSxcblxuICBhc3luYyBpbmRleChyZXEsIHJlcywgbmV4dCkge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCB1c2VycyA9IGF3YWl0IFVzZXJNb2RlbC5maW5kQWxsKCk7XG4gICAgICByZXMuanNvbih1c2Vycyk7XG4gICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICBuZXh0KGVycik7XG4gICAgfVxuICB9LFxuXG4gIGFzeW5jIHNob3cocmVxLCByZXMsIG5leHQpIHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgdXNlciA9IGF3YWl0IFVzZXJNb2RlbC5maW5kQnlJZChyZXEucGFyYW1zLmlkKTtcbiAgICAgIGlmICghdXNlcikge1xuICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDQpLmpzb24oeyBlcnJvOiAnVXN1w6FyaW8gbsOjbyBlbmNvbnRyYWRvJyB9KTtcbiAgICAgIH1cbiAgICAgIHJlcy5qc29uKHVzZXIpO1xuICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgbmV4dChlcnIpO1xuICAgIH1cbiAgfSxcblxuICBhc3luYyB1cGRhdGUocmVxLCByZXMsIG5leHQpIHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgeyBub21lLCBlbWFpbCB9ID0gcmVxLmJvZHk7XG5cbiAgICAgIGNvbnN0IGV4aXN0ZW50ZSA9IGF3YWl0IFVzZXJNb2RlbC5maW5kQnlJZChyZXEucGFyYW1zLmlkKTtcbiAgICAgIGlmICghZXhpc3RlbnRlKSB7XG4gICAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwNCkuanNvbih7IGVycm86ICdVc3XDoXJpbyBuw6NvIGVuY29udHJhZG8nIH0pO1xuICAgICAgfVxuXG4gICAgICBjb25zdCB1c2VyID0gYXdhaXQgVXNlck1vZGVsLnVwZGF0ZShyZXEucGFyYW1zLmlkLCB7IG5vbWUsIGVtYWlsIH0pO1xuICAgICAgcmVzLmpzb24odXNlcik7XG4gICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICBuZXh0KGVycik7XG4gICAgfVxuICB9LFxuICBcbiAgYXN5bmMgdXBkYXRlUHJvZmlsZShyZXEsIHJlcywgbmV4dCkge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCB7IGlkIH0gPSByZXEudXN1YXJpbztcbiAgICAgIGNvbnN0IHsgbm9tZSwgZW1haWwgfSA9IHJlcS5ib2R5O1xuXG4gICAgICBjb25zdCB1c2VyID0gYXdhaXQgVXNlck1vZGVsLnVwZGF0ZShpZCwgeyBub21lLCBlbWFpbCB9KTtcbiAgICAgIHJlcy5qc29uKHVzZXIpO1xuICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgbmV4dChlcnIpO1xuICAgIH1cbiAgfSxcblxuICBhc3luYyB1cGRhdGVQYXNzd29yZChyZXEsIHJlcywgbmV4dCkge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCB7IGlkIH0gPSByZXEudXN1YXJpbztcbiAgICAgIGNvbnN0IHsgc2VuaGFBbnRpZ2EsIG5vdmFTZW5oYSB9ID0gcmVxLmJvZHk7XG5cbiAgICAgIGNvbnN0IHVzZXIgPSBhd2FpdCBVc2VyTW9kZWwuZmluZEJ5SWQoaWQpO1xuICAgICAgaWYgKCF1c2VyKSB7XG4gICAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwNCkuanNvbih7IGVycm86ICdVc3XDoXJpbyBuw6NvIGVuY29udHJhZG8nIH0pO1xuICAgICAgfVxuXG4gICAgICBjb25zdCBzZW5oYVZhbGlkYSA9IGF3YWl0IGJjcnlwdC5jb21wYXJlKHNlbmhhQW50aWdhLCB1c2VyLnNlbmhhKTtcbiAgICAgIGlmICghc2VuaGFWYWxpZGEpIHtcbiAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAwKS5qc29uKHsgZXJybzogJ1NlbmhhIGFudGlnYSBpbmNvcnJldGEnIH0pO1xuICAgICAgfVxuXG4gICAgICBjb25zdCBoYXNoZWQgPSBhd2FpdCBiY3J5cHQuaGFzaChub3ZhU2VuaGEsIDEwKTtcbiAgICAgIGF3YWl0IFVzZXJNb2RlbC51cGRhdGVQYXNzd29yZChpZCwgaGFzaGVkKTtcblxuICAgICAgcmVzLnN0YXR1cygyMDQpLnNlbmQoKTtcbiAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgIG5leHQoZXJyKTtcbiAgICB9XG4gIH0sXG5cbiAgYXN5bmMgZGVsZXRlKHJlcSwgcmVzLCBuZXh0KSB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IGV4aXN0ZW50ZSA9IGF3YWl0IFVzZXJNb2RlbC5maW5kQnlJZChyZXEucGFyYW1zLmlkKTtcbiAgICAgIGlmICghZXhpc3RlbnRlKSB7XG4gICAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwNCkuanNvbih7IGVycm86ICdVc3XDoXJpbyBuw6NvIGVuY29udHJhZG8nIH0pO1xuICAgICAgfVxuXG4gICAgICBhd2FpdCBVc2VyTW9kZWwuZGVsZXRlKHJlcS5wYXJhbXMuaWQpO1xuICAgICAgcmVzLnN0YXR1cygyMDQpLnNlbmQoKTtcbiAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgIG5leHQoZXJyKTtcbiAgICB9XG4gIH0sXG5cbiAgYXN5bmMgZ2V0Q2hhbWFkb3NEb1VzdWFyaW8ocmVxLCByZXMsIG5leHQpIHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgeyBpZCB9ID0gcmVxLnBhcmFtcztcbiAgICAgIGNvbnN0IGNoYW1hZG9zID0gYXdhaXQgQ2hhbWFkb01vZGVsLmZpbmRCeVVzdWFyaW9JZChpZCk7XG4gICAgICBpZiAoIWNoYW1hZG9zLmxlbmd0aCkge1xuICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDQpLmpzb24oeyBlcnJvOiAnTmVuaHVtIGNoYW1hZG8gZW5jb250cmFkbyBwYXJhIGVzdGUgdXN1w6FyaW8uJyB9KTtcbiAgICAgIH1cbiAgICAgIHJlcy5qc29uKGNoYW1hZG9zKTtcbiAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgIG5leHQoZXJyKTtcbiAgICB9XG4gIH1cbn07XG5cbm1vZHVsZS5leHBvcnRzID0gVXNlckNvbnRyb2xsZXI7Il0sIm1hcHBpbmdzIjoiQUFBQSxNQUFNQSxNQUFNLEdBQUdDLE9BQU8sQ0FBQyxRQUFRLENBQUM7QUFDaEMsTUFBTUMsU0FBUyxHQUFHRCxPQUFPLENBQUMscUJBQXFCLENBQUM7QUFDaEQsTUFBTUUsWUFBWSxHQUFHRixPQUFPLENBQUMsd0JBQXdCLENBQUM7QUFFdEQsTUFBTUcsY0FBYyxHQUFHO0VBQ3JCLE1BQU1DLE1BQU1BLENBQUNDLEdBQUcsRUFBRUMsR0FBRyxFQUFFQyxJQUFJLEVBQUU7SUFDM0IsSUFBSTtNQUNGLE1BQU07UUFBRUMsSUFBSTtRQUFFQyxLQUFLO1FBQUVDO01BQU0sQ0FBQyxHQUFHTCxHQUFHLENBQUNNLElBQUk7TUFDdkMsTUFBTUMsTUFBTSxHQUFHLE1BQU1iLE1BQU0sQ0FBQ2MsSUFBSSxDQUFDSCxLQUFLLEVBQUUsRUFBRSxDQUFDO01BQzNDLE1BQU1JLElBQUksR0FBRyxNQUFNYixTQUFTLENBQUNHLE1BQU0sQ0FBQztRQUFFSSxJQUFJO1FBQUVDLEtBQUs7UUFBRUMsS0FBSyxFQUFFRTtNQUFPLENBQUMsQ0FBQztNQUNuRU4sR0FBRyxDQUFDUyxNQUFNLENBQUMsR0FBRyxDQUFDLENBQUNDLElBQUksQ0FBQ0YsSUFBSSxDQUFDO0lBQzVCLENBQUMsQ0FBQyxPQUFPRyxHQUFHLEVBQUU7TUFDWixJQUFJQSxHQUFHLENBQUNDLE9BQU8sS0FBSyxzQkFBc0IsRUFBRTtRQUMxQyxPQUFPWixHQUFHLENBQUNTLE1BQU0sQ0FBQyxHQUFHLENBQUMsQ0FBQ0MsSUFBSSxDQUFDO1VBQUVHLElBQUksRUFBRUYsR0FBRyxD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","map":{"version":3,"names":["bcrypt","require","UserModel","ChamadoModel","UserController","create","req","res","next","nome","email","senha","body","hashed","hash","user","status","json","err","message","erro","index","users","findAll","show","findById","params","id","update","existente","updateProfile","usuario","updatePassword","senhaAntiga","novaSenha","senhaValida","compare","send","delete","getChamadosDoUsuario","chamados","findByUsuarioId","length","module","exports"],"sourceRoot":"/home/bernardo/sistema-atendimento-ti/ATNTI/src/controllers/","sources":["userController.js"],"sourcesContent":["const bcrypt = require('bcrypt');\nconst UserModel = require('../models/userModel');\nconst ChamadoModel = require('../models/chamadoModel');\n\nconst UserController = {\n  async create(req, res, next) {\n    try {\n      const { nome, email, senha } = req.body;\n      const hashed = await bcrypt.hash(senha, 10);\n      const user = await UserModel.create({ nome, email, senha: hashed });\n      res.status(201).json(user);\n    } catch (err) {\n      if (err.message === 'E-mail já cadastrado') {\n        return res.status(400).json({ erro: err.message });\n      }\n      next(err);\n    }\n  },\n\n  async index(req, res, next) {\n    try {\n      const users = await UserModel.findAll();\n      res.json(users);\n    } catch (err) {\n      next(err);\n    }\n  },\n\n  async show(req, res, next) {\n    try {\n      const user = await UserModel.findById(req.params.id);\n      if (!user) {\n        return res.status(404).json({ erro: 'Usuário não encontrado' });\n      }\n      res.json(user);\n    } catch (err) {\n      next(err);\n    }\n  },\n\n  async update(req, res, next) {\n    try {\n      const { nome, email } = req.body;\n\n      const existente = await UserModel.findById(req.params.id);\n      if (!existente) {\n        return res.status(404).json({ erro: 'Usuário não encontrado' });\n      }\n\n      const user = await UserModel.update(req.params.id, { nome, email });\n      res.json(user);\n    } catch (err) {\n      next(err);\n    }\n  },\n  \n  async updateProfile(req, res, next) {\n    try {\n      const { id } = req.usuario;\n      const { nome, email } = req.body;\n\n      const user = await UserModel.update(id, { nome, email });\n      res.json(user);\n    } catch (err) {\n      next(err);\n    }\n  },\n\n  async updatePassword(req, res, next) {\n    try {\n      const { id } = req.usuario;\n      const { senhaAntiga, novaSenha } = req.body;\n\n      const user = await UserModel.findById(id);\n      if (!user) {\n        return res.status(404).json({ erro: 'Usuário não encontrado' });\n      }\n\n      const senhaValida = await bcrypt.compare(senhaAntiga, user.senha);\n      if (!senhaValida) {\n        return res.status(400).json({ erro: 'Senha antiga incorreta' });\n      }\n\n      const hashed = await bcrypt.hash(novaSenha, 10);\n      await UserModel.updatePassword(id, hashed);\n\n      res.status(204).send();\n    } catch (err) {\n      next(err);\n    }\n  },\n\n  async delete(req, res, next) {\n    try {\n      const existente = await UserModel.findById(req.params.id);\n      if (!existente) {\n        return res.status(404).json({ erro: 'Usuário não encontrado' });\n      }\n\n      await UserModel.delete(req.params.id);\n      res.status(204).send();\n    } catch (err) {\n      next(err);\n    }\n  },\n\n  async getChamadosDoUsuario(req, res, next) {\n    try {\n      const { id } = req.params;\n      const chamados = await ChamadoModel.findByUsuarioId(id);\n      if (!chamados.length) {\n        return res.status(404).json({ erro: 'Nenhum chamado encontrado para este usuário.' });\n      }\n      res.json(chamados);\n    } catch (err) {\n      next(err);\n    }\n  }\n};\n\nmodule.exports = UserController;"],"mappings":"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","ignoreList":[]}},"mtime":1754590646184},"{\"assumptions\":{},\"sourceRoot\":\"/home/bernardo/sistema-atendimento-ti/ATNTI/src/models/\",\"caller\":{\"name\":\"@babel/register\"},\"cwd\":\"/home/bernardo/sistema-atendimento-ti/ATNTI\",\"filename\":\"/home/bernardo/sistema-atendimento-ti/ATNTI/src/models/userModel.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/home/bernardo/sistema-atendimento-ti/ATNTI\",\"rootMode\":\"root\",\"plugins\":[],\"presets\":[]}:7.28.0:development":{"value":{"code":"const db = require('../config/db');\nconst UserModel = {\n  async create({\n    nome,\n    email,\n    senha\n  }) {\n    // Verifica se o e-mail já está cadastrado\n    const emailExistente = await db.query('SELECT id FROM usuarios WHERE email = $1', [email]);\n    if (emailExistente.rowCount > 0) {\n      throw new Error('E-mail já cadastrado');\n    }\n    const query = `\n      INSERT INTO usuarios (nome, email, senha)\n      VALUES ($1, $2, $3)\n      RETURNING id, nome, email\n    `;\n    const values = [nome, email, senha];\n    const result = await db.query(query, values);\n    return result.rows[0];\n  },\n  async findByEmail(email) {\n    const result = await db.query('SELECT * FROM usuarios WHERE email = $1', [email]);\n    return result.rows[0];\n  },\n  async findAll() {\n    const result = await db.query('SELECT id, nome, email, tipo FROM usuarios');\n    return result.rows;\n  },\n  async findById(id) {\n    const result = await db.query('SELECT id, nome, email, senha FROM usuarios WHERE id = $1', [id]);\n    return result.rows[0];\n  },\n  async update(id, {\n    nome,\n    email\n  }) {\n    const result = await db.query('UPDATE usuarios SET nome = $1, email = $2 WHERE id = $3 RETURNING id, nome, email', [nome, email, id]);\n    return result.rows[0];\n  },\n  // NOVO: Método para atualizar apenas a senha\n  async updatePassword(id, novaSenha) {\n    await db.query('UPDATE usuarios SET senha = $1 WHERE id = $2', [novaSenha, id]);\n  },\n  async delete(id) {\n    await db.query('DELETE FROM usuarios WHERE id = $1', [id]);\n  }\n};\nmodule.exports = UserModel;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJkYiIsInJlcXVpcmUiLCJVc2VyTW9kZWwiLCJjcmVhdGUiLCJub21lIiwiZW1haWwiLCJzZW5oYSIsImVtYWlsRXhpc3RlbnRlIiwicXVlcnkiLCJyb3dDb3VudCIsIkVycm9yIiwidmFsdWVzIiwicmVzdWx0Iiwicm93cyIsImZpbmRCeUVtYWlsIiwiZmluZEFsbCIsImZpbmRCeUlkIiwiaWQiLCJ1cGRhdGUiLCJ1cGRhdGVQYXNzd29yZCIsIm5vdmFTZW5oYSIsImRlbGV0ZSIsIm1vZHVsZSIsImV4cG9ydHMiXSwic291cmNlUm9vdCI6Ii9ob21lL2Jlcm5hcmRvL3Npc3RlbWEtYXRlbmRpbWVudG8tdGkvQVROVEkvc3JjL21vZGVscy8iLCJzb3VyY2VzIjpbInVzZXJNb2RlbC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBkYiA9IHJlcXVpcmUoJy4uL2NvbmZpZy9kYicpO1xuXG5jb25zdCBVc2VyTW9kZWwgPSB7XG4gIGFzeW5jIGNyZWF0ZSh7IG5vbWUsIGVtYWlsLCBzZW5oYSB9KSB7XG4gICAgLy8gVmVyaWZpY2Egc2UgbyBlLW1haWwgasOhIGVzdMOhIGNhZGFzdHJhZG9cbiAgICBjb25zdCBlbWFpbEV4aXN0ZW50ZSA9IGF3YWl0IGRiLnF1ZXJ5KFxuICAgICAgJ1NFTEVDVCBpZCBGUk9NIHVzdWFyaW9zIFdIRVJFIGVtYWlsID0gJDEnLFxuICAgICAgW2VtYWlsXVxuICAgICk7XG4gICAgaWYgKGVtYWlsRXhpc3RlbnRlLnJvd0NvdW50ID4gMCkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdFLW1haWwgasOhIGNhZGFzdHJhZG8nKTtcbiAgICB9XG5cbiAgICBjb25zdCBxdWVyeSA9IGBcbiAgICAgIElOU0VSVCBJTlRPIHVzdWFyaW9zIChub21lLCBlbWFpbCwgc2VuaGEpXG4gICAgICBWQUxVRVMgKCQxLCAkMiwgJDMpXG4gICAgICBSRVRVUk5JTkcgaWQsIG5vbWUsIGVtYWlsXG4gICAgYDtcbiAgICBjb25zdCB2YWx1ZXMgPSBbbm9tZSwgZW1haWwsIHNlbmhhXTtcbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBkYi5xdWVyeShxdWVyeSwgdmFsdWVzKTtcbiAgICByZXR1cm4gcmVzdWx0LnJvd3NbMF07XG4gIH0sXG5cbiAgYXN5bmMgZmluZEJ5RW1haWwoZW1haWwpIHtcbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBkYi5xdWVyeShcbiAgICAgICdTRUxFQ1QgKiBGUk9NIHVzdWFyaW9zIFdIRVJFIGVtYWlsID0gJDEnLFxuICAgICAgW2VtYWlsXVxuICAgICk7XG4gICAgcmV0dXJuIHJlc3VsdC5yb3dzWzBdO1xuICB9LFxuXG4gIGFzeW5jIGZpbmRBbGwoKSB7XG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZGIucXVlcnkoJ1NFTEVDVCBpZCwgbm9tZSwgZW1haWwsIHRpcG8gRlJPTSB1c3VhcmlvcycpO1xuICAgIHJldHVybiByZXN1bHQucm93cztcbiAgfSxcblxuICBhc3luYyBmaW5kQnlJZChpZCkge1xuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGRiLnF1ZXJ5KCdTRUxFQ1QgaWQsIG5vbWUsIGVtYWlsLCBzZW5oYSBGUk9NIHVzdWFyaW9zIFdIRVJFIGlkID0gJDEnLCBbaWRdKTtcbiAgICByZXR1cm4gcmVzdWx0LnJvd3NbMF07XG4gIH0sXG5cbiAgYXN5bmMgdXBkYXRlKGlkLCB7IG5vbWUsIGVtYWlsIH0pIHtcbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBkYi5xdWVyeShcbiAgICAgICdVUERBVEUgdXN1YXJpb3MgU0VUIG5vbWUgPSAkMSwgZW1haWwgPSAkMiBXSEVSRSBpZCA9ICQzIFJFVFVSTklORyBpZCwgbm9tZSwgZW1haWwnLFxuICAgICAgW25vbWUsIGVtYWlsLCBpZF1cbiAgICApO1xuICAgIHJldHVybiByZXN1bHQucm93c1swXTtcbiAgfSxcbiAgXG4gIC8vIE5PVk86IE3DqXRvZG8gcGFyYSBhdHVhbGl6YXIgYXBlbmFzIGEgc2VuaGFcbiAgYXN5bmMgdXBkYXRlUGFzc3dvcmQoaWQsIG5vdmFTZW5oYSkge1xuICAgIGF3YWl0IGRiLnF1ZXJ5KFxuICAgICAgJ1VQREFURSB1c3VhcmlvcyBTRVQgc2VuaGEgPSAkMSBXSEVSRSBpZCA9ICQyJyxcbiAgICAgIFtub3ZhU2VuaGEsIGlkXVxuICAgICk7XG4gIH0sXG5cbiAgYXN5bmMgZGVsZXRlKGlkKSB7XG4gICAgYXdhaXQgZGIucXVlcnkoJ0RFTEVURSBGUk9NIHVzdWFyaW9zIFdIRVJFIGlkID0gJDEnLCBbaWRdKTtcbiAgfVxufTtcblxubW9kdWxlLmV4cG9ydHMgPSBVc2VyTW9kZWw7Il0sIm1hcHBpbmdzIjoiQUFBQSxNQUFNQSxFQUFFLEdBQUdDLE9BQU8sQ0FBQyxjQUFjLENBQUM7QUFFbEMsTUFBTUMsU0FBUyxHQUFHO0VBQ2hCLE1BQU1DLE1BQU1BLENBQUM7SUFBRUMsSUFBSTtJQUFFQyxLQUFLO0lBQUVDO0VBQU0sQ0FBQyxFQUFFO0lBQ25DO0lBQ0EsTUFBTUMsY0FBYyxHQUFHLE1BQU1QLEVBQUUsQ0FBQ1EsS0FBSyxDQUNuQywwQ0FBMEMsRUFDMUMsQ0FBQ0gsS0FBSyxDQUNSLENBQUM7SUFDRCxJQUFJRSxjQUFjLENBQUNFLFFBQVEsR0FBRyxDQUFDLEVBQUU7TUFDL0IsTUFBTSxJQUFJQyxLQUFLLENBQUMsc0JBQXNCLENBQUM7SUFDekM7SUFFQSxNQUFNRixLQUFLLEdBQUc7QUFDbEI7QUFDQTtBQUNBO0FBQ0EsS0FBSztJQUNELE1BQU1HLE1BQU0sR0FBRyxDQUFDUCxJQUFJLEVBQUVDLEtBQUssRUFBRUMsS0FBSyxDQUFDO0lBQ25DLE1BQU1NLE1BQU0sR0FBRyxNQUFNWixFQUFFLENBQUNRLEtBQUssQ0FBQ0EsS0FBSyxFQUFFRyxNQUFNLENBQUM7SUFDNUMsT0FBT0MsTUFBTSxDQUFDQyxJQUFJLENBQUMsQ0FBQyxDQUFDO0VBQ3ZCLENBQUM7RUFFRCxNQUFNQyxXQUFXQSxDQUFDVCxLQUFLLEVBQUU7SUFDdkIsTUFBTU8sTUFBTSxHQUFHLE1BQU1aLEVBQUUsQ0FBQ1EsS0FBSyxDQUMzQix5Q0FBeUMsRUFDekMsQ0FBQ0gsS0FBSyxDQUNSLENBQUM7SUFDRCxPQUFPTyxNQUFNLENBQUNDLElBQUksQ0FBQyxDQUFDLENBQUM7RUFDdkIsQ0FBQztFQUVELE1BQU1FLE9BQU9BLENBQUEsRUFBRztJQUNkLE1BQU1ILE1BQU0sR0FBRyxNQUFNWixFQUFFLENBQUNRLEtBQUssQ0FBQyw0Q0FBNEMsQ0FBQztJQUMzRSxPQUFPSSxNQUFNLENBQUNDLElBQUk7RUFDcEIsQ0FBQztFQUVELE1BQU1HLFFBQVFBLENBQUNDLEVBQUUsRUFBRTtJQUNqQixNQUFNTCxNQUFNLEdBQUcsTUFBTVosRUFBRSxDQUFDUSxLQUFLLENBQUMsMkRBQTJELEVBQUUsQ0FBQ1MsRUFBRSxDQUFDLENBQUM7SUFDaEcsT0FBT0wsTUFBTSxDQUFDQyxJQUFJLENBQUMsQ0FBQyxDQUFDO0VBQ3ZCLENBQUM7RUFFRCxNQUFNSyxNQUFNQSxDQUFDRCxFQUFFLEVBQUU7SUFBRWIsSUFBSTtJQUFFQztFQUFNLENBQUMsRUFBRTtJQUNoQyxNQUFNTyxNQUFNLEdBQUcsTUFBTVosRUFBRSxDQUFDUSxLQUFLLENBQzNCLG1GQUFtRixFQUNuRixDQUFDSixJQUFJLEVBQUVDLEtBQUssRUFBRVksRUFBRSxDQUNsQixDQUFDO0lBQ0QsT0FBT0wsTUFBTSxDQUFDQyxJQUFJLENBQUMsQ0FBQyxDQUFDO0VBQ3ZCLENBQUM7RUFFRDtFQUNBLE1BQU1NLGNBQWNBLENBQUNGLEVBQUUsRUFBRUcsU0FBUyxFQUFFO0lBQ2xDLE1BQU1wQixFQUFFLENBQUNRLEtBQUssQ0FDWiw4Q0FBOEMsRUFDOUMsQ0FBQ1ksU0FBUyxFQUFFSCxFQUFFLENBQ2hCLENBQUM7RUFDSCxDQUFDO0VBRUQsTUFBTUksTUFBTUEsQ0FBQ0osRUFBRSxFQUFFO0lBQ2YsTUFBTWpCLEVBQUUsQ0FBQ1EsS0FBSyxDQUFDLG9DQUFvQyxFQUFFLENBQUNTLEVBQUUsQ0FBQyxDQUFDO0VBQzVEO0FBQ0YsQ0FBQztBQUVESyxNQUFNLENBQUNDLE9BQU8sR0FBR3JCLFNBQVMiLCJpZ25vcmVMaXN0IjpbXX0=","map":{"version":3,"names":["db","require","UserModel","create","nome","email","senha","emailExistente","query","rowCount","Error","values","result","rows","findByEmail","findAll","findById","id","update","updatePassword","novaSenha","delete","module","exports"],"sourceRoot":"/home/bernardo/sistema-atendimento-ti/ATNTI/src/models/","sources":["userModel.js"],"sourcesContent":["const db = require('../config/db');\n\nconst UserModel = {\n  async create({ nome, email, senha }) {\n    // Verifica se o e-mail já está cadastrado\n    const emailExistente = await db.query(\n      'SELECT id FROM usuarios WHERE email = $1',\n      [email]\n    );\n    if (emailExistente.rowCount > 0) {\n      throw new Error('E-mail já cadastrado');\n    }\n\n    const query = `\n      INSERT INTO usuarios (nome, email, senha)\n      VALUES ($1, $2, $3)\n      RETURNING id, nome, email\n    `;\n    const values = [nome, email, senha];\n    const result = await db.query(query, values);\n    return result.rows[0];\n  },\n\n  async findByEmail(email) {\n    const result = await db.query(\n      'SELECT * FROM usuarios WHERE email = $1',\n      [email]\n    );\n    return result.rows[0];\n  },\n\n  async findAll() {\n    const result = await db.query('SELECT id, nome, email, tipo FROM usuarios');\n    return result.rows;\n  },\n\n  async findById(id) {\n    const result = await db.query('SELECT id, nome, email, senha FROM usuarios WHERE id = $1', [id]);\n    return result.rows[0];\n  },\n\n  async update(id, { nome, email }) {\n    const result = await db.query(\n      'UPDATE usuarios SET nome = $1, email = $2 WHERE id = $3 RETURNING id, nome, email',\n      [nome, email, id]\n    );\n    return result.rows[0];\n  },\n  \n  // NOVO: Método para atualizar apenas a senha\n  async updatePassword(id, novaSenha) {\n    await db.query(\n      'UPDATE usuarios SET senha = $1 WHERE id = $2',\n      [novaSenha, id]\n    );\n  },\n\n  async delete(id) {\n    await db.query('DELETE FROM usuarios WHERE id = $1', [id]);\n  }\n};\n\nmodule.exports = UserModel;"],"mappings":"AAAA,MAAMA,EAAE,GAAGC,OAAO,CAAC,cAAc,CAAC;AAElC,MAAMC,SAAS,GAAG;EAChB,MAAMC,MAAMA,CAAC;IAAEC,IAAI;IAAEC,KAAK;IAAEC;EAAM,CAAC,EAAE;IACnC;IACA,MAAMC,cAAc,GAAG,MAAMP,EAAE,CAACQ,KAAK,CACnC,0CAA0C,EAC1C,CAACH,KAAK,CACR,CAAC;IACD,IAAIE,cAAc,CAACE,QAAQ,GAAG,CAAC,EAAE;MAC/B,MAAM,IAAIC,KAAK,CAAC,sBAAsB,CAAC;IACzC;IAEA,MAAMF,KAAK,GAAG;AAClB;AACA;AACA;AACA,KAAK;IACD,MAAMG,MAAM,GAAG,CAACP,IAAI,EAAEC,KAAK,EAAEC,KAAK,CAAC;IACnC,MAAMM,MAAM,GAAG,MAAMZ,EAAE,CAACQ,KAAK,CAACA,KAAK,EAAEG,MAAM,CAAC;IAC5C,OAAOC,MAAM,CAACC,IAAI,CAAC,CAAC,CAAC;EACvB,CAAC;EAED,MAAMC,WAAWA,CAACT,KAAK,EAAE;IACvB,MAAMO,MAAM,GAAG,MAAMZ,EAAE,CAACQ,KAAK,CAC3B,yCAAyC,EACzC,CAACH,KAAK,CACR,CAAC;IACD,OAAOO,MAAM,CAACC,IAAI,CAAC,CAAC,CAAC;EACvB,CAAC;EAED,MAAME,OAAOA,CAAA,EAAG;IACd,MAAMH,MAAM,GAAG,MAAMZ,EAAE,CAACQ,KAAK,CAAC,4CAA4C,CAAC;IAC3E,OAAOI,MAAM,CAACC,IAAI;EACpB,CAAC;EAED,MAAMG,QAAQA,CAACC,EAAE,EAAE;IACjB,MAAML,MAAM,GAAG,MAAMZ,EAAE,CAACQ,KAAK,CAAC,2DAA2D,EAAE,CAACS,EAAE,CAAC,CAAC;IAChG,OAAOL,MAAM,CAACC,IAAI,CAAC,CAAC,CAAC;EACvB,CAAC;EAED,MAAMK,MAAMA,CAACD,EAAE,EAAE;IAAEb,IAAI;IAAEC;EAAM,CAAC,EAAE;IAChC,MAAMO,MAAM,GAAG,MAAMZ,EAAE,CAACQ,KAAK,CAC3B,mFAAmF,EACnF,CAACJ,IAAI,EAAEC,KAAK,EAAEY,EAAE,CAClB,CAAC;IACD,OAAOL,MAAM,CAACC,IAAI,CAAC,CAAC,CAAC;EACvB,CAAC;EAED;EACA,MAAMM,cAAcA,CAACF,EAAE,EAAEG,SAAS,EAAE;IAClC,MAAMpB,EAAE,CAACQ,KAAK,CACZ,8CAA8C,EAC9C,CAACY,SAAS,EAAEH,EAAE,CAChB,CAAC;EACH,CAAC;EAED,MAAMI,MAAMA,CAACJ,EAAE,EAAE;IACf,MAAMjB,EAAE,CAACQ,KAAK,CAAC,oCAAoC,EAAE,CAACS,EAAE,CAAC,CAAC;EAC5D;AACF,CAAC;AAEDK,MAAM,CAACC,OAAO,GAAGrB,SAAS","ignoreList":[]}},"mtime":1754577805252},"{\"assumptions\":{},\"sourceRoot\":\"/home/bernardo/sistema-atendimento-ti/ATNTI/src/models/\",\"caller\":{\"name\":\"@babel/register\"},\"cwd\":\"/home/bernardo/sistema-atendimento-ti/ATNTI\",\"filename\":\"/home/bernardo/sistema-atendimento-ti/ATNTI/src/models/chamadoModel.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/home/bernardo/sistema-atendimento-ti/ATNTI\",\"rootMode\":\"root\",\"plugins\":[],\"presets\":[]}:7.28.0:development":{"value":{"code":"const db = require('../config/db');\n\n// Gera um protocolo sequencial tipo ATN0001, ATN0002...\nasync function gerarProtocolo() {\n  const result = await db.query('SELECT MAX(id) AS max_id FROM chamados');\n  const numero = (result.rows[0].max_id || 0) + 1;\n  return `ATN${numero.toString().padStart(4, '0')}`;\n}\nconst ChamadoModel = {\n  async create({\n    usuario_id,\n    prioridade,\n    titulo,\n    descricao\n  }) {\n    const protocolo = await gerarProtocolo();\n    const query = `\n      INSERT INTO chamados (protocolo, usuario_id, prioridade, titulo, descricao)\n      VALUES ($1, $2, $3, $4, $5)\n      RETURNING *\n    `;\n    const values = [protocolo, usuario_id, prioridade, titulo, descricao];\n    const result = await db.query(query, values);\n    return result.rows[0];\n  },\n  async findAll() {\n    const result = await db.query(`\n      SELECT c.*, u.nome AS nome_usuario\n      FROM chamados c\n      JOIN usuarios u ON c.usuario_id = u.id\n      ORDER BY c.aberto_em DESC\n    `);\n    return result.rows;\n  },\n  async search(query) {\n    const termo = `%${query}%`;\n    const result = await db.query(`SELECT * FROM chamados\n       WHERE titulo ILIKE $1 OR descricao ILIKE $1 OR protocolo ILIKE $1`, [termo]);\n    return result.rows;\n  },\n  async findById(id) {\n    const result = await db.query(`\n      SELECT c.*, u.nome AS nome_usuario\n      FROM chamados c\n      JOIN usuarios u ON c.usuario_id = u.id\n      WHERE c.id = $1\n    `, [id]);\n    return result.rows[0];\n  },\n  // NOVO: Busca todos os chamados de um usuário\n  async findByUsuarioId(usuario_id) {\n    const result = await db.query(`SELECT c.* FROM chamados c WHERE usuario_id = $1 ORDER BY c.aberto_em DESC`, [usuario_id]);\n    return result.rows;\n  },\n  async update(id, {\n    prioridade,\n    titulo,\n    descricao\n  }) {\n    const result = await db.query(`UPDATE chamados\n       SET prioridade = $1,\n           titulo = $2,\n           descricao = $3\n       WHERE id = $4\n       RETURNING *`, [prioridade, titulo, descricao, id]);\n    return result.rows[0];\n  },\n  async atribuirResponsavel(id, responsavel_id) {\n    const result = await db.query(`UPDATE chamados\n       SET responsavel_id = $1\n       WHERE id = $2\n       RETURNING *`, [responsavel_id, id]);\n    return result.rows[0];\n  },\n  async delete(id) {\n    await db.query('DELETE FROM chamados WHERE id = $1', [id]);\n  }\n};\nmodule.exports = ChamadoModel;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJkYiIsInJlcXVpcmUiLCJnZXJhclByb3RvY29sbyIsInJlc3VsdCIsInF1ZXJ5IiwibnVtZXJvIiwicm93cyIsIm1heF9pZCIsInRvU3RyaW5nIiwicGFkU3RhcnQiLCJDaGFtYWRvTW9kZWwiLCJjcmVhdGUiLCJ1c3VhcmlvX2lkIiwicHJpb3JpZGFkZSIsInRpdHVsbyIsImRlc2NyaWNhbyIsInByb3RvY29sbyIsInZhbHVlcyIsImZpbmRBbGwiLCJzZWFyY2giLCJ0ZXJtbyIsImZpbmRCeUlkIiwiaWQiLCJmaW5kQnlVc3VhcmlvSWQiLCJ1cGRhdGUiLCJhdHJpYnVpclJlc3BvbnNhdmVsIiwicmVzcG9uc2F2ZWxfaWQiLCJkZWxldGUiLCJtb2R1bGUiLCJleHBvcnRzIl0sInNvdXJjZVJvb3QiOiIvaG9tZS9iZXJuYXJkby9zaXN0ZW1hLWF0ZW5kaW1lbnRvLXRpL0FUTlRJL3NyYy9tb2RlbHMvIiwic291cmNlcyI6WyJjaGFtYWRvTW9kZWwuanMiXSwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgZGIgPSByZXF1aXJlKCcuLi9jb25maWcvZGInKTtcblxuLy8gR2VyYSB1bSBwcm90b2NvbG8gc2VxdWVuY2lhbCB0aXBvIEFUTjAwMDEsIEFUTjAwMDIuLi5cbmFzeW5jIGZ1bmN0aW9uIGdlcmFyUHJvdG9jb2xvKCkge1xuICBjb25zdCByZXN1bHQgPSBhd2FpdCBkYi5xdWVyeSgnU0VMRUNUIE1BWChpZCkgQVMgbWF4X2lkIEZST00gY2hhbWFkb3MnKTtcbiAgY29uc3QgbnVtZXJvID0gKHJlc3VsdC5yb3dzWzBdLm1heF9pZCB8fCAwKSArIDE7XG4gIHJldHVybiBgQVROJHtudW1lcm8udG9TdHJpbmcoKS5wYWRTdGFydCg0LCAnMCcpfWA7XG59XG5cbmNvbnN0IENoYW1hZG9Nb2RlbCA9IHtcbiAgYXN5bmMgY3JlYXRlKHsgdXN1YXJpb19pZCwgcHJpb3JpZGFkZSwgdGl0dWxvLCBkZXNjcmljYW8gfSkge1xuICAgIGNvbnN0IHByb3RvY29sbyA9IGF3YWl0IGdlcmFyUHJvdG9jb2xvKCk7XG4gICAgY29uc3QgcXVlcnkgPSBgXG4gICAgICBJTlNFUlQgSU5UTyBjaGFtYWRvcyAocHJvdG9jb2xvLCB1c3VhcmlvX2lkLCBwcmlvcmlkYWRlLCB0aXR1bG8sIGRlc2NyaWNhbylcbiAgICAgIFZBTFVFUyAoJDEsICQyLCAkMywgJDQsICQ1KVxuICAgICAgUkVUVVJOSU5HICpcbiAgICBgO1xuICAgIGNvbnN0IHZhbHVlcyA9IFtwcm90b2NvbG8sIHVzdWFyaW9faWQsIHByaW9yaWRhZGUsIHRpdHVsbywgZGVzY3JpY2FvXTtcbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBkYi5xdWVyeShxdWVyeSwgdmFsdWVzKTtcbiAgICByZXR1cm4gcmVzdWx0LnJvd3NbMF07XG4gIH0sXG5cbiAgYXN5bmMgZmluZEFsbCgpIHtcbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBkYi5xdWVyeShgXG4gICAgICBTRUxFQ1QgYy4qLCB1Lm5vbWUgQVMgbm9tZV91c3VhcmlvXG4gICAgICBGUk9NIGNoYW1hZG9zIGNcbiAgICAgIEpPSU4gdXN1YXJpb3MgdSBPTiBjLnVzdWFyaW9faWQgPSB1LmlkXG4gICAgICBPUkRFUiBCWSBjLmFiZXJ0b19lbSBERVNDXG4gICAgYCk7XG4gICAgcmV0dXJuIHJlc3VsdC5yb3dzO1xuICB9LFxuXG4gIGFzeW5jIHNlYXJjaChxdWVyeSkge1xuICAgIGNvbnN0IHRlcm1vID0gYCUke3F1ZXJ5fSVgO1xuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGRiLnF1ZXJ5KFxuICAgICAgYFNFTEVDVCAqIEZST00gY2hhbWFkb3NcbiAgICAgICBXSEVSRSB0aXR1bG8gSUxJS0UgJDEgT1IgZGVzY3JpY2FvIElMSUtFICQxIE9SIHByb3RvY29sbyBJTElLRSAkMWAsXG4gICAgICBbdGVybW9dXG4gICAgKTtcbiAgICByZXR1cm4gcmVzdWx0LnJvd3M7XG4gIH0sXG5cbiAgYXN5bmMgZmluZEJ5SWQoaWQpIHtcbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBkYi5xdWVyeShgXG4gICAgICBTRUxFQ1QgYy4qLCB1Lm5vbWUgQVMgbm9tZV91c3VhcmlvXG4gICAgICBGUk9NIGNoYW1hZG9zIGNcbiAgICAgIEpPSU4gdXN1YXJpb3MgdSBPTiBjLnVzdWFyaW9faWQgPSB1LmlkXG4gICAgICBXSEVSRSBjLmlkID0gJDFcbiAgICBgLCBbaWRdKTtcbiAgICByZXR1cm4gcmVzdWx0LnJvd3NbMF07XG4gIH0sXG4gIFxuICAvLyBOT1ZPOiBCdXNjYSB0b2RvcyBvcyBjaGFtYWRvcyBkZSB1bSB1c3XDoXJpb1xuICBhc3luYyBmaW5kQnlVc3VhcmlvSWQodXN1YXJpb19pZCkge1xuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGRiLnF1ZXJ5KFxuICAgICAgYFNFTEVDVCBjLiogRlJPTSBjaGFtYWRvcyBjIFdIRVJFIHVzdWFyaW9faWQgPSAkMSBPUkRFUiBCWSBjLmFiZXJ0b19lbSBERVNDYCxcbiAgICAgIFt1c3VhcmlvX2lkXVxuICAgICk7XG4gICAgcmV0dXJuIHJlc3VsdC5yb3dzO1xuICB9LFxuXG4gIGFzeW5jIHVwZGF0ZShpZCwgeyBwcmlvcmlkYWRlLCB0aXR1bG8sIGRlc2NyaWNhbyB9KSB7XG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZGIucXVlcnkoXG4gICAgICBgVVBEQVRFIGNoYW1hZG9zXG4gICAgICAgU0VUIHByaW9yaWRhZGUgPSAkMSxcbiAgICAgICAgICAgdGl0dWxvID0gJDIsXG4gICAgICAgICAgIGRlc2NyaWNhbyA9ICQzXG4gICAgICAgV0hFUkUgaWQgPSAkNFxuICAgICAgIFJFVFVSTklORyAqYCxcbiAgICAgIFtwcmlvcmlkYWRlLCB0aXR1bG8sIGRlc2NyaWNhbywgaWRdXG4gICAgKTtcbiAgICByZXR1cm4gcmVzdWx0LnJvd3NbMF07XG4gIH0sXG5cbiAgYXN5bmMgYXRyaWJ1aXJSZXNwb25zYXZlbChpZCwgcmVzcG9uc2F2ZWxfaWQpIHtcbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBkYi5xdWVyeShcbiAgICAgIGBVUERBVEUgY2hhbWFkb3NcbiAgICAgICBTRVQgcmVzcG9uc2F2ZWxfaWQgPSAkMVxuICAgICAgIFdIRVJFIGlkID0gJDJcbiAgICAgICBSRVRVUk5JTkcgKmAsXG4gICAgICBbcmVzcG9uc2F2ZWxfaWQsIGlkXVxuICAgICk7XG4gICAgcmV0dXJuIHJlc3VsdC5yb3dzWzBdO1xuICB9LFxuXG4gIGFzeW5jIGRlbGV0ZShpZCkge1xuICAgIGF3YWl0IGRiLnF1ZXJ5KCdERUxFVEUgRlJPTSBjaGFtYWRvcyBXSEVSRSBpZCA9ICQxJywgW2lkXSk7XG4gIH1cbn07XG5cbm1vZHVsZS5leHBvcnRzID0gQ2hhbWFkb01vZGVsOyJdLCJtYXBwaW5ncyI6IkFBQUEsTUFBTUEsRUFBRSxHQUFHQyxPQUFPLENBQUMsY0FBYyxDQUFDOztBQUVsQztBQUNBLGVBQWVDLGNBQWNBLENBQUEsRUFBRztFQUM5QixNQUFNQyxNQUFNLEdBQUcsTUFBTUgsRUFBRSxDQUFDSSxLQUFLLENBQUMsd0NBQXdDLENBQUM7RUFDdkUsTUFBTUMsTUFBTSxHQUFHLENBQUNGLE1BQU0sQ0FBQ0csSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDQyxNQUFNLElBQUksQ0FBQyxJQUFJLENBQUM7RUFDL0MsT0FBTyxNQUFNRixNQUFNLENBQUNHLFFBQVEsQ0FBQyxDQUFDLENBQUNDLFFBQVEsQ0FBQyxDQUFDLEVBQUUsR0FBRyxDQUFDLEVBQUU7QUFDbkQ7QUFFQSxNQUFNQyxZQUFZLEdBQUc7RUFDbkIsTUFBTUMsTUFBTUEsQ0FBQztJQUFFQyxVQUFVO0lBQUVDLFVBQVU7SUFBRUMsTUFBTTtJQUFFQztFQUFVLENBQUMsRUFBRTtJQUMxRCxNQUFNQyxTQUFTLEdBQUcsTUFBTWQsY0FBYyxDQUFDLENBQUM7SUFDeEMsTUFBTUUsS0FBSyxHQUFHO0FBQ2xCO0FBQ0E7QUFDQTtBQUNBLEtBQUs7SUFDRCxNQUFNYSxNQUFNLEdBQUcsQ0FBQ0QsU0FBUyxFQUFFSixVQUFVLEVBQUVDLFVBQVUsRUFBRUMsTUFBTSxFQUFFQyxTQUFTLENBQUM7SUFDckUsTUFBTVosTUFBTSxHQUFHLE1BQU1ILEVBQUUsQ0FBQ0ksS0FBSyxDQUFDQSxLQUFLLEVBQUVhLE1BQU0sQ0FBQztJQUM1QyxPQUFPZCxNQUFNLENBQUNHLElBQUksQ0FBQyxDQUFDLENBQUM7RUFDdkIsQ0FBQztFQUVELE1BQU1ZLE9BQU9BLENBQUEsRUFBRztJQUNkLE1BQU1mLE1BQU0sR0FBRyxNQUFNSCxFQUFFLENBQUNJLEtBQUssQ0FBQztBQUNsQztBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUssQ0FBQztJQUNGLE9BQU9ELE1BQU0sQ0FBQ0csSUFBSTtFQUNwQixDQUFDO0VBRUQsTUFBTWEsTUFBTUEsQ0FBQ2YsS0FBSyxFQUFFO0lBQ2xCLE1BQU1nQixLQUFLLEdBQUcsSUFBSWhCLEtBQUssR0FBRztJQUMxQixNQUFNRCxNQUFNLEdBQUcsTUFBTUgsRUFBRSxDQUFDSSxLQUFLLENBQzNCO0FBQ04seUVBQXlFLEVBQ25FLENBQUNnQixLQUFLLENBQ1IsQ0FBQztJQUNELE9BQU9qQixNQUFNLENBQUNHLElBQUk7RUFDcEIsQ0FBQztFQUVELE1BQU1lLFFBQVFBLENBQUNDLEVBQUUsRUFBRTtJQUNqQixNQUFNbkIsTUFBTSxHQUFHLE1BQU1ILEVBQUUsQ0FBQ0ksS0FBSyxDQUFDO0FBQ2xDO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSyxFQUFFLENBQUNrQixFQUFFLENBQUMsQ0FBQztJQUNSLE9BQU9uQixNQUFNLENBQUNHLElBQUksQ0FBQyxDQUFDLENBQUM7RUFDdkIsQ0FBQztFQUVEO0VBQ0EsTUFBTWlCLGVBQWVBLENBQUNYLFVBQVUsRUFBRTtJQUNoQyxNQUFNVCxNQUFNLEdBQUcsTUFBTUgsRUFBRSxDQUFDSSxLQUFLLENBQzNCLDRFQUE0RSxFQUM1RSxDQUFDUSxVQUFVLENBQ2IsQ0FBQztJQUNELE9BQU9ULE1BQU0sQ0FBQ0csSUFBSTtFQUNwQixDQUFDO0VBRUQsTUFBTWtCLE1BQU1BLENBQUNGLEVBQUUsRUFBRTtJQUFFVCxVQUFVO0lBQUVDLE1BQU07SUFBRUM7RUFBVSxDQUFDLEVBQUU7SUFDbEQsTUFBTVosTUFBTSxHQUFHLE1BQU1ILEVBQUUsQ0FBQ0ksS0FBSyxDQUMzQjtBQUNOO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbUJBQW1CLEVBQ2IsQ0FBQ1MsVUFBVSxFQUFFQyxNQUFNLEVBQUVDLFNBQVMsRUFBRU8sRUFBRSxDQUNwQyxDQUFDO0lBQ0QsT0FBT25CLE1BQU0sQ0FBQ0csSUFBSSxDQUFDLENBQUMsQ0FBQztFQUN2QixDQUFDO0VBRUQsTUFBTW1CLG1CQUFtQkEsQ0FBQ0gsRUFBRSxFQUFFSSxjQUFjLEVBQUU7SUFDNUMsTUFBTXZCLE1BQU0sR0FBRyxNQUFNSCxFQUFFLENBQUNJLEtBQUssQ0FDM0I7QUFDTjtBQUNBO0FBQ0EsbUJBQW1CLEVBQ2IsQ0FBQ3NCLGNBQWMsRUFBRUosRUFBRSxDQUNyQixDQUFDO0lBQ0QsT0FBT25CLE1BQU0sQ0FBQ0csSUFBSSxDQUFDLENBQUMsQ0FBQztFQUN2QixDQUFDO0VBRUQsTUFBTXFCLE1BQU1BLENBQUNMLEVBQUUsRUFBRTtJQUNmLE1BQU10QixFQUFFLENBQUNJLEtBQUssQ0FBQyxvQ0FBb0MsRUFBRSxDQUFDa0IsRUFBRSxDQUFDLENBQUM7RUFDNUQ7QUFDRixDQUFDO0FBRURNLE1BQU0sQ0FBQ0MsT0FBTyxHQUFHbkIsWUFBWSIsImlnbm9yZUxpc3QiOltdfQ==","map":{"version":3,"names":["db","require","gerarProtocolo","result","query","numero","rows","max_id","toString","padStart","ChamadoModel","create","usuario_id","prioridade","titulo","descricao","protocolo","values","findAll","search","termo","findById","id","findByUsuarioId","update","atribuirResponsavel","responsavel_id","delete","module","exports"],"sourceRoot":"/home/bernardo/sistema-atendimento-ti/ATNTI/src/models/","sources":["chamadoModel.js"],"sourcesContent":["const db = require('../config/db');\n\n// Gera um protocolo sequencial tipo ATN0001, ATN0002...\nasync function gerarProtocolo() {\n  const result = await db.query('SELECT MAX(id) AS max_id FROM chamados');\n  const numero = (result.rows[0].max_id || 0) + 1;\n  return `ATN${numero.toString().padStart(4, '0')}`;\n}\n\nconst ChamadoModel = {\n  async create({ usuario_id, prioridade, titulo, descricao }) {\n    const protocolo = await gerarProtocolo();\n    const query = `\n      INSERT INTO chamados (protocolo, usuario_id, prioridade, titulo, descricao)\n      VALUES ($1, $2, $3, $4, $5)\n      RETURNING *\n    `;\n    const values = [protocolo, usuario_id, prioridade, titulo, descricao];\n    const result = await db.query(query, values);\n    return result.rows[0];\n  },\n\n  async findAll() {\n    const result = await db.query(`\n      SELECT c.*, u.nome AS nome_usuario\n      FROM chamados c\n      JOIN usuarios u ON c.usuario_id = u.id\n      ORDER BY c.aberto_em DESC\n    `);\n    return result.rows;\n  },\n\n  async search(query) {\n    const termo = `%${query}%`;\n    const result = await db.query(\n      `SELECT * FROM chamados\n       WHERE titulo ILIKE $1 OR descricao ILIKE $1 OR protocolo ILIKE $1`,\n      [termo]\n    );\n    return result.rows;\n  },\n\n  async findById(id) {\n    const result = await db.query(`\n      SELECT c.*, u.nome AS nome_usuario\n      FROM chamados c\n      JOIN usuarios u ON c.usuario_id = u.id\n      WHERE c.id = $1\n    `, [id]);\n    return result.rows[0];\n  },\n  \n  // NOVO: Busca todos os chamados de um usuário\n  async findByUsuarioId(usuario_id) {\n    const result = await db.query(\n      `SELECT c.* FROM chamados c WHERE usuario_id = $1 ORDER BY c.aberto_em DESC`,\n      [usuario_id]\n    );\n    return result.rows;\n  },\n\n  async update(id, { prioridade, titulo, descricao }) {\n    const result = await db.query(\n      `UPDATE chamados\n       SET prioridade = $1,\n           titulo = $2,\n           descricao = $3\n       WHERE id = $4\n       RETURNING *`,\n      [prioridade, titulo, descricao, id]\n    );\n    return result.rows[0];\n  },\n\n  async atribuirResponsavel(id, responsavel_id) {\n    const result = await db.query(\n      `UPDATE chamados\n       SET responsavel_id = $1\n       WHERE id = $2\n       RETURNING *`,\n      [responsavel_id, id]\n    );\n    return result.rows[0];\n  },\n\n  async delete(id) {\n    await db.query('DELETE FROM chamados WHERE id = $1', [id]);\n  }\n};\n\nmodule.exports = ChamadoModel;"],"mappings":"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","ignoreList":[]}},"mtime":1754588935393},"{\"assumptions\":{},\"sourceRoot\":\"/home/bernardo/sistema-atendimento-ti/ATNTI/src/middlewares/\",\"caller\":{\"name\":\"@babel/register\"},\"cwd\":\"/home/bernardo/sistema-atendimento-ti/ATNTI\",\"filename\":\"/home/bernardo/sistema-atendimento-ti/ATNTI/src/middlewares/authMiddleware.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/home/bernardo/sistema-atendimento-ti/ATNTI\",\"rootMode\":\"root\",\"plugins\":[],\"presets\":[]}:7.28.0:development":{"value":{"code":"const jwt = require('jsonwebtoken');\nrequire('dotenv').config();\nfunction autenticarToken(req, res, next) {\n  const authHeader = req.headers['authorization'];\n  const token = authHeader && authHeader.split(' ')[1]; // Espera: Bearer <token>\n\n  if (!token) {\n    return res.status(401).json({\n      erro: 'Token não fornecido'\n    });\n  }\n  jwt.verify(token, process.env.JWT_SECRET, (err, usuario) => {\n    if (err) {\n      return res.status(403).json({\n        erro: 'Token inválido ou expirado'\n      });\n    }\n    req.usuario = usuario; // coloca o payload no req\n    next();\n  });\n}\nmodule.exports = autenticarToken;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJqd3QiLCJyZXF1aXJlIiwiY29uZmlnIiwiYXV0ZW50aWNhclRva2VuIiwicmVxIiwicmVzIiwibmV4dCIsImF1dGhIZWFkZXIiLCJoZWFkZXJzIiwidG9rZW4iLCJzcGxpdCIsInN0YXR1cyIsImpzb24iLCJlcnJvIiwidmVyaWZ5IiwicHJvY2VzcyIsImVudiIsIkpXVF9TRUNSRVQiLCJlcnIiLCJ1c3VhcmlvIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJzb3VyY2VSb290IjoiL2hvbWUvYmVybmFyZG8vc2lzdGVtYS1hdGVuZGltZW50by10aS9BVE5USS9zcmMvbWlkZGxld2FyZXMvIiwic291cmNlcyI6WyJhdXRoTWlkZGxld2FyZS5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBqd3QgPSByZXF1aXJlKCdqc29ud2VidG9rZW4nKTtcbnJlcXVpcmUoJ2RvdGVudicpLmNvbmZpZygpO1xuXG5mdW5jdGlvbiBhdXRlbnRpY2FyVG9rZW4ocmVxLCByZXMsIG5leHQpIHtcbiAgY29uc3QgYXV0aEhlYWRlciA9IHJlcS5oZWFkZXJzWydhdXRob3JpemF0aW9uJ107XG4gIGNvbnN0IHRva2VuID0gYXV0aEhlYWRlciAmJiBhdXRoSGVhZGVyLnNwbGl0KCcgJylbMV07IC8vIEVzcGVyYTogQmVhcmVyIDx0b2tlbj5cblxuICBpZiAoIXRva2VuKSB7XG4gICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAxKS5qc29uKHsgZXJybzogJ1Rva2VuIG7Do28gZm9ybmVjaWRvJyB9KTtcbiAgfVxuXG4gIGp3dC52ZXJpZnkodG9rZW4sIHByb2Nlc3MuZW52LkpXVF9TRUNSRVQsIChlcnIsIHVzdWFyaW8pID0+IHtcbiAgICBpZiAoZXJyKSB7XG4gICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDMpLmpzb24oeyBlcnJvOiAnVG9rZW4gaW52w6FsaWRvIG91IGV4cGlyYWRvJyB9KTtcbiAgICB9XG5cbiAgICByZXEudXN1YXJpbyA9IHVzdWFyaW87IC8vIGNvbG9jYSBvIHBheWxvYWQgbm8gcmVxXG4gICAgbmV4dCgpO1xuICB9KTtcbn1cblxubW9kdWxlLmV4cG9ydHMgPSBhdXRlbnRpY2FyVG9rZW47XG4iXSwibWFwcGluZ3MiOiJBQUFBLE1BQU1BLEdBQUcsR0FBR0MsT0FBTyxDQUFDLGNBQWMsQ0FBQztBQUNuQ0EsT0FBTyxDQUFDLFFBQVEsQ0FBQyxDQUFDQyxNQUFNLENBQUMsQ0FBQztBQUUxQixTQUFTQyxlQUFlQSxDQUFDQyxHQUFHLEVBQUVDLEdBQUcsRUFBRUMsSUFBSSxFQUFFO0VBQ3ZDLE1BQU1DLFVBQVUsR0FBR0gsR0FBRyxDQUFDSSxPQUFPLENBQUMsZUFBZSxDQUFDO0VBQy9DLE1BQU1DLEtBQUssR0FBR0YsVUFBVSxJQUFJQSxVQUFVLENBQUNHLEtBQUssQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDOztFQUV0RCxJQUFJLENBQUNELEtBQUssRUFBRTtJQUNWLE9BQU9KLEdBQUcsQ0FBQ00sTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDQyxJQUFJLENBQUM7TUFBRUMsSUFBSSxFQUFFO0lBQXNCLENBQUMsQ0FBQztFQUM5RDtFQUVBYixHQUFHLENBQUNjLE1BQU0sQ0FBQ0wsS0FBSyxFQUFFTSxPQUFPLENBQUNDLEdBQUcsQ0FBQ0MsVUFBVSxFQUFFLENBQUNDLEdBQUcsRUFBRUMsT0FBTyxLQUFLO0lBQzFELElBQUlELEdBQUcsRUFBRTtNQUNQLE9BQU9iLEdBQUcsQ0FBQ00sTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDQyxJQUFJLENBQUM7UUFBRUMsSUFBSSxFQUFFO01BQTZCLENBQUMsQ0FBQztJQUNyRTtJQUVBVCxHQUFHLENBQUNlLE9BQU8sR0FBR0EsT0FBTyxDQUFDLENBQUM7SUFDdkJiLElBQUksQ0FBQyxDQUFDO0VBQ1IsQ0FBQyxDQUFDO0FBQ0o7QUFFQWMsTUFBTSxDQUFDQyxPQUFPLEdBQUdsQixlQUFlIiwiaWdub3JlTGlzdCI6W119","map":{"version":3,"names":["jwt","require","config","autenticarToken","req","res","next","authHeader","headers","token","split","status","json","erro","verify","process","env","JWT_SECRET","err","usuario","module","exports"],"sourceRoot":"/home/bernardo/sistema-atendimento-ti/ATNTI/src/middlewares/","sources":["authMiddleware.js"],"sourcesContent":["const jwt = require('jsonwebtoken');\nrequire('dotenv').config();\n\nfunction autenticarToken(req, res, next) {\n  const authHeader = req.headers['authorization'];\n  const token = authHeader && authHeader.split(' ')[1]; // Espera: Bearer <token>\n\n  if (!token) {\n    return res.status(401).json({ erro: 'Token não fornecido' });\n  }\n\n  jwt.verify(token, process.env.JWT_SECRET, (err, usuario) => {\n    if (err) {\n      return res.status(403).json({ erro: 'Token inválido ou expirado' });\n    }\n\n    req.usuario = usuario; // coloca o payload no req\n    next();\n  });\n}\n\nmodule.exports = autenticarToken;\n"],"mappings":"AAAA,MAAMA,GAAG,GAAGC,OAAO,CAAC,cAAc,CAAC;AACnCA,OAAO,CAAC,QAAQ,CAAC,CAACC,MAAM,CAAC,CAAC;AAE1B,SAASC,eAAeA,CAACC,GAAG,EAAEC,GAAG,EAAEC,IAAI,EAAE;EACvC,MAAMC,UAAU,GAAGH,GAAG,CAACI,OAAO,CAAC,eAAe,CAAC;EAC/C,MAAMC,KAAK,GAAGF,UAAU,IAAIA,UAAU,CAACG,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;;EAEtD,IAAI,CAACD,KAAK,EAAE;IACV,OAAOJ,GAAG,CAACM,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;MAAEC,IAAI,EAAE;IAAsB,CAAC,CAAC;EAC9D;EAEAb,GAAG,CAACc,MAAM,CAACL,KAAK,EAAEM,OAAO,CAACC,GAAG,CAACC,UAAU,EAAE,CAACC,GAAG,EAAEC,OAAO,KAAK;IAC1D,IAAID,GAAG,EAAE;MACP,OAAOb,GAAG,CAACM,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;QAAEC,IAAI,EAAE;MAA6B,CAAC,CAAC;IACrE;IAEAT,GAAG,CAACe,OAAO,GAAGA,OAAO,CAAC,CAAC;IACvBb,IAAI,CAAC,CAAC;EACR,CAAC,CAAC;AACJ;AAEAc,MAAM,CAACC,OAAO,GAAGlB,eAAe","ignoreList":[]}},"mtime":1754576033490},"{\"assumptions\":{},\"sourceRoot\":\"/home/bernardo/sistema-atendimento-ti/ATNTI/src/middlewares/\",\"caller\":{\"name\":\"@babel/register\"},\"cwd\":\"/home/bernardo/sistema-atendimento-ti/ATNTI\",\"filename\":\"/home/bernardo/sistema-atendimento-ti/ATNTI/src/middlewares/isAdmin.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/home/bernardo/sistema-atendimento-ti/ATNTI\",\"rootMode\":\"root\",\"plugins\":[],\"presets\":[]}:7.28.0:development":{"value":{"code":"function verificarAdmin(req, res, next) {\n  if (req.usuario.tipo !== 'admin') {\n    return res.status(403).json({\n      erro: 'Acesso restrito a administradores.'\n    });\n  }\n  next();\n}\nmodule.exports = verificarAdmin;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJ2ZXJpZmljYXJBZG1pbiIsInJlcSIsInJlcyIsIm5leHQiLCJ1c3VhcmlvIiwidGlwbyIsInN0YXR1cyIsImpzb24iLCJlcnJvIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJzb3VyY2VSb290IjoiL2hvbWUvYmVybmFyZG8vc2lzdGVtYS1hdGVuZGltZW50by10aS9BVE5USS9zcmMvbWlkZGxld2FyZXMvIiwic291cmNlcyI6WyJpc0FkbWluLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImZ1bmN0aW9uIHZlcmlmaWNhckFkbWluKHJlcSwgcmVzLCBuZXh0KSB7XG4gIGlmIChyZXEudXN1YXJpby50aXBvICE9PSAnYWRtaW4nKSB7XG4gICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAzKS5qc29uKHsgZXJybzogJ0FjZXNzbyByZXN0cml0byBhIGFkbWluaXN0cmFkb3Jlcy4nIH0pO1xuICB9XG4gIG5leHQoKTtcbn1cblxubW9kdWxlLmV4cG9ydHMgPSB2ZXJpZmljYXJBZG1pbjtcbiJdLCJtYXBwaW5ncyI6IkFBQUEsU0FBU0EsY0FBY0EsQ0FBQ0MsR0FBRyxFQUFFQyxHQUFHLEVBQUVDLElBQUksRUFBRTtFQUN0QyxJQUFJRixHQUFHLENBQUNHLE9BQU8sQ0FBQ0MsSUFBSSxLQUFLLE9BQU8sRUFBRTtJQUNoQyxPQUFPSCxHQUFHLENBQUNJLE1BQU0sQ0FBQyxHQUFHLENBQUMsQ0FBQ0MsSUFBSSxDQUFDO01BQUVDLElBQUksRUFBRTtJQUFxQyxDQUFDLENBQUM7RUFDN0U7RUFDQUwsSUFBSSxDQUFDLENBQUM7QUFDUjtBQUVBTSxNQUFNLENBQUNDLE9BQU8sR0FBR1YsY0FBYyIsImlnbm9yZUxpc3QiOltdfQ==","map":{"version":3,"names":["verificarAdmin","req","res","next","usuario","tipo","status","json","erro","module","exports"],"sourceRoot":"/home/bernardo/sistema-atendimento-ti/ATNTI/src/middlewares/","sources":["isAdmin.js"],"sourcesContent":["function verificarAdmin(req, res, next) {\n  if (req.usuario.tipo !== 'admin') {\n    return res.status(403).json({ erro: 'Acesso restrito a administradores.' });\n  }\n  next();\n}\n\nmodule.exports = verificarAdmin;\n"],"mappings":"AAAA,SAASA,cAAcA,CAACC,GAAG,EAAEC,GAAG,EAAEC,IAAI,EAAE;EACtC,IAAIF,GAAG,CAACG,OAAO,CAACC,IAAI,KAAK,OAAO,EAAE;IAChC,OAAOH,GAAG,CAACI,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;MAAEC,IAAI,EAAE;IAAqC,CAAC,CAAC;EAC7E;EACAL,IAAI,CAAC,CAAC;AACR;AAEAM,MAAM,CAACC,OAAO,GAAGV,cAAc","ignoreList":[]}},"mtime":1754576033491},"{\"assumptions\":{},\"sourceRoot\":\"/home/bernardo/sistema-atendimento-ti/ATNTI/src/validators/\",\"caller\":{\"name\":\"@babel/register\"},\"cwd\":\"/home/bernardo/sistema-atendimento-ti/ATNTI\",\"filename\":\"/home/bernardo/sistema-atendimento-ti/ATNTI/src/validators/usuarioValidator.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/home/bernardo/sistema-atendimento-ti/ATNTI\",\"rootMode\":\"root\",\"plugins\":[],\"presets\":[]}:7.28.0:development":{"value":{"code":"const Joi = require('joi');\nconst schemaUsuarioCreate = Joi.object({\n  nome: Joi.string().min(3).max(100).required(),\n  email: Joi.string().email().required(),\n  senha: Joi.string().min(6).required(),\n  tipo: Joi.string().valid('comum', 'admin').required()\n});\nconst schemaUsuarioUpdate = Joi.object({\n  nome: Joi.string().min(3).max(100).required(),\n  email: Joi.string().email().required()\n});\n\n// Novo esquema para alteração de senha\nconst schemaSenhaUpdate = Joi.object({\n  senhaAntiga: Joi.string().min(6).required(),\n  novaSenha: Joi.string().min(6).required()\n});\nmodule.exports = {\n  schemaUsuarioCreate,\n  schemaUsuarioUpdate,\n  schemaSenhaUpdate\n};\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJKb2kiLCJyZXF1aXJlIiwic2NoZW1hVXN1YXJpb0NyZWF0ZSIsIm9iamVjdCIsIm5vbWUiLCJzdHJpbmciLCJtaW4iLCJtYXgiLCJyZXF1aXJlZCIsImVtYWlsIiwic2VuaGEiLCJ0aXBvIiwidmFsaWQiLCJzY2hlbWFVc3VhcmlvVXBkYXRlIiwic2NoZW1hU2VuaGFVcGRhdGUiLCJzZW5oYUFudGlnYSIsIm5vdmFTZW5oYSIsIm1vZHVsZSIsImV4cG9ydHMiXSwic291cmNlUm9vdCI6Ii9ob21lL2Jlcm5hcmRvL3Npc3RlbWEtYXRlbmRpbWVudG8tdGkvQVROVEkvc3JjL3ZhbGlkYXRvcnMvIiwic291cmNlcyI6WyJ1c3VhcmlvVmFsaWRhdG9yLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImNvbnN0IEpvaSA9IHJlcXVpcmUoJ2pvaScpO1xuXG5jb25zdCBzY2hlbWFVc3VhcmlvQ3JlYXRlID0gSm9pLm9iamVjdCh7XG4gIG5vbWU6IEpvaS5zdHJpbmcoKS5taW4oMykubWF4KDEwMCkucmVxdWlyZWQoKSxcbiAgZW1haWw6IEpvaS5zdHJpbmcoKS5lbWFpbCgpLnJlcXVpcmVkKCksXG4gIHNlbmhhOiBKb2kuc3RyaW5nKCkubWluKDYpLnJlcXVpcmVkKCksXG4gIHRpcG86IEpvaS5zdHJpbmcoKS52YWxpZCgnY29tdW0nLCAnYWRtaW4nKS5yZXF1aXJlZCgpXG59KTtcblxuY29uc3Qgc2NoZW1hVXN1YXJpb1VwZGF0ZSA9IEpvaS5vYmplY3Qoe1xuICBub21lOiBKb2kuc3RyaW5nKCkubWluKDMpLm1heCgxMDApLnJlcXVpcmVkKCksXG4gIGVtYWlsOiBKb2kuc3RyaW5nKCkuZW1haWwoKS5yZXF1aXJlZCgpXG59KTtcblxuLy8gTm92byBlc3F1ZW1hIHBhcmEgYWx0ZXJhw6fDo28gZGUgc2VuaGFcbmNvbnN0IHNjaGVtYVNlbmhhVXBkYXRlID0gSm9pLm9iamVjdCh7XG4gIHNlbmhhQW50aWdhOiBKb2kuc3RyaW5nKCkubWluKDYpLnJlcXVpcmVkKCksXG4gIG5vdmFTZW5oYTogSm9pLnN0cmluZygpLm1pbig2KS5yZXF1aXJlZCgpXG59KTtcblxubW9kdWxlLmV4cG9ydHMgPSB7XG4gIHNjaGVtYVVzdWFyaW9DcmVhdGUsXG4gIHNjaGVtYVVzdWFyaW9VcGRhdGUsXG4gIHNjaGVtYVNlbmhhVXBkYXRlXG59OyJdLCJtYXBwaW5ncyI6IkFBQUEsTUFBTUEsR0FBRyxHQUFHQyxPQUFPLENBQUMsS0FBSyxDQUFDO0FBRTFCLE1BQU1DLG1CQUFtQixHQUFHRixHQUFHLENBQUNHLE1BQU0sQ0FBQztFQUNyQ0MsSUFBSSxFQUFFSixHQUFHLENBQUNLLE1BQU0sQ0FBQyxDQUFDLENBQUNDLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQ0MsR0FBRyxDQUFDLEdBQUcsQ0FBQyxDQUFDQyxRQUFRLENBQUMsQ0FBQztFQUM3Q0MsS0FBSyxFQUFFVCxHQUFHLENBQUNLLE1BQU0sQ0FBQyxDQUFDLENBQUNJLEtBQUssQ0FBQyxDQUFDLENBQUNELFFBQVEsQ0FBQyxDQUFDO0VBQ3RDRSxLQUFLLEVBQUVWLEdBQUcsQ0FBQ0ssTUFBTSxDQUFDLENBQUMsQ0FBQ0MsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDRSxRQUFRLENBQUMsQ0FBQztFQUNyQ0csSUFBSSxFQUFFWCxHQUFHLENBQUNLLE1BQU0sQ0FBQyxDQUFDLENBQUNPLEtBQUssQ0FBQyxPQUFPLEVBQUUsT0FBTyxDQUFDLENBQUNKLFFBQVEsQ0FBQztBQUN0RCxDQUFDLENBQUM7QUFFRixNQUFNSyxtQkFBbUIsR0FBR2IsR0FBRyxDQUFDRyxNQUFNLENBQUM7RUFDckNDLElBQUksRUFBRUosR0FBRyxDQUFDSyxNQUFNLENBQUMsQ0FBQyxDQUFDQyxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUNDLEdBQUcsQ0FBQyxHQUFHLENBQUMsQ0FBQ0MsUUFBUSxDQUFDLENBQUM7RUFDN0NDLEtBQUssRUFBRVQsR0FBRyxDQUFDSyxNQUFNLENBQUMsQ0FBQyxDQUFDSSxLQUFLLENBQUMsQ0FBQyxDQUFDRCxRQUFRLENBQUM7QUFDdkMsQ0FBQyxDQUFDOztBQUVGO0FBQ0EsTUFBTU0saUJBQWlCLEdBQUdkLEdBQUcsQ0FBQ0csTUFBTSxDQUFDO0VBQ25DWSxXQUFXLEVBQUVmLEdBQUcsQ0FBQ0ssTUFBTSxDQUFDLENBQUMsQ0FBQ0MsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDRSxRQUFRLENBQUMsQ0FBQztFQUMzQ1EsU0FBUyxFQUFFaEIsR0FBRyxDQUFDSyxNQUFNLENBQUMsQ0FBQyxDQUFDQyxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUNFLFFBQVEsQ0FBQztBQUMxQyxDQUFDLENBQUM7QUFFRlMsTUFBTSxDQUFDQyxPQUFPLEdBQUc7RUFDZmhCLG1CQUFtQjtFQUNuQlcsbUJBQW1CO0VBQ25CQztBQUNGLENBQUMiLCJpZ25vcmVMaXN0IjpbXX0=","map":{"version":3,"names":["Joi","require","schemaUsuarioCreate","object","nome","string","min","max","required","email","senha","tipo","valid","schemaUsuarioUpdate","schemaSenhaUpdate","senhaAntiga","novaSenha","module","exports"],"sourceRoot":"/home/bernardo/sistema-atendimento-ti/ATNTI/src/validators/","sources":["usuarioValidator.js"],"sourcesContent":["const Joi = require('joi');\n\nconst schemaUsuarioCreate = Joi.object({\n  nome: Joi.string().min(3).max(100).required(),\n  email: Joi.string().email().required(),\n  senha: Joi.string().min(6).required(),\n  tipo: Joi.string().valid('comum', 'admin').required()\n});\n\nconst schemaUsuarioUpdate = Joi.object({\n  nome: Joi.string().min(3).max(100).required(),\n  email: Joi.string().email().required()\n});\n\n// Novo esquema para alteração de senha\nconst schemaSenhaUpdate = Joi.object({\n  senhaAntiga: Joi.string().min(6).required(),\n  novaSenha: Joi.string().min(6).required()\n});\n\nmodule.exports = {\n  schemaUsuarioCreate,\n  schemaUsuarioUpdate,\n  schemaSenhaUpdate\n};"],"mappings":"AAAA,MAAMA,GAAG,GAAGC,OAAO,CAAC,KAAK,CAAC;AAE1B,MAAMC,mBAAmB,GAAGF,GAAG,CAACG,MAAM,CAAC;EACrCC,IAAI,EAAEJ,GAAG,CAACK,MAAM,CAAC,CAAC,CAACC,GAAG,CAAC,CAAC,CAAC,CAACC,GAAG,CAAC,GAAG,CAAC,CAACC,QAAQ,CAAC,CAAC;EAC7CC,KAAK,EAAET,GAAG,CAACK,MAAM,CAAC,CAAC,CAACI,KAAK,CAAC,CAAC,CAACD,QAAQ,CAAC,CAAC;EACtCE,KAAK,EAAEV,GAAG,CAACK,MAAM,CAAC,CAAC,CAACC,GAAG,CAAC,CAAC,CAAC,CAACE,QAAQ,CAAC,CAAC;EACrCG,IAAI,EAAEX,GAAG,CAACK,MAAM,CAAC,CAAC,CAACO,KAAK,CAAC,OAAO,EAAE,OAAO,CAAC,CAACJ,QAAQ,CAAC;AACtD,CAAC,CAAC;AAEF,MAAMK,mBAAmB,GAAGb,GAAG,CAACG,MAAM,CAAC;EACrCC,IAAI,EAAEJ,GAAG,CAACK,MAAM,CAAC,CAAC,CAACC,GAAG,CAAC,CAAC,CAAC,CAACC,GAAG,CAAC,GAAG,CAAC,CAACC,QAAQ,CAAC,CAAC;EAC7CC,KAAK,EAAET,GAAG,CAACK,MAAM,CAAC,CAAC,CAACI,KAAK,CAAC,CAAC,CAACD,QAAQ,CAAC;AACvC,CAAC,CAAC;;AAEF;AACA,MAAMM,iBAAiB,GAAGd,GAAG,CAACG,MAAM,CAAC;EACnCY,WAAW,EAAEf,GAAG,CAACK,MAAM,CAAC,CAAC,CAACC,GAAG,CAAC,CAAC,CAAC,CAACE,QAAQ,CAAC,CAAC;EAC3CQ,SAAS,EAAEhB,GAAG,CAACK,MAAM,CAAC,CAAC,CAACC,GAAG,CAAC,CAAC,CAAC,CAACE,QAAQ,CAAC;AAC1C,CAAC,CAAC;AAEFS,MAAM,CAACC,OAAO,GAAG;EACfhB,mBAAmB;EACnBW,mBAAmB;EACnBC;AACF,CAAC","ignoreList":[]}},"mtime":1754577657391},"{\"assumptions\":{},\"sourceRoot\":\"/home/bernardo/sistema-atendimento-ti/ATNTI/src/routes/\",\"caller\":{\"name\":\"@babel/register\"},\"cwd\":\"/home/bernardo/sistema-atendimento-ti/ATNTI\",\"filename\":\"/home/bernardo/sistema-atendimento-ti/ATNTI/src/routes/chamadoRoutes.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/home/bernardo/sistema-atendimento-ti/ATNTI\",\"rootMode\":\"root\",\"plugins\":[],\"presets\":[]}:7.28.0:development":{"value":{"code":"const express = require('express');\nconst router = express.Router();\nconst ChamadoController = require('../controllers/chamadoController');\nconst autenticarToken = require('../middlewares/authMiddleware');\nconst validarRequisicao = require('../middlewares/validarRequisicao');\nconst verificarAdmin = require('../middlewares/isAdmin');\nconst {\n  schemaChamadoCreate,\n  schemaChamadoUpdate,\n  schemaChamadoAtribuir\n} = require('../validators/chamadoValidator');\n\n/**\n * @swagger\n * tags:\n *   - name: Chamados\n *     description: Endpoints para gestão de chamados de TI\n *\n * paths:\n *   /chamados:\n *     post:\n *       summary: Cria um novo chamado\n *       tags: [Chamados]\n *       security:\n *         - bearerAuth: []\n *       requestBody:\n *         required: true\n *         content:\n *           application/json:\n *             schema:\n *               $ref: '#/components/schemas/NovoChamado'\n *       responses:\n *         '201': { description: Chamado criado com sucesso }\n *         '400': { description: Dados inválidos }\n *\n *     get:\n *       summary: Lista todos os chamados\n *       tags: [Chamados]\n *       security:\n *         - bearerAuth: []\n *       responses:\n *         '200': { description: Lista de chamados }\n *\n *   /chamados/search:\n *     get:\n *       summary: Busca chamados por título, descrição ou protocolo\n *       tags: [Chamados]\n *       security:\n *         - bearerAuth: []\n *       parameters:\n *         - in: query\n *           name: q\n *           required: true\n *           schema: { type: string }\n *           description: Termo de busca para título, descrição ou protocolo\n *       responses:\n *         '200': { description: Lista de chamados encontrados }\n *         '400': { description: Parâmetro de busca ausente }\n *\n *   /chamados/{id}:\n *     parameters:\n *       - in: path\n *         name: id\n *         required: true\n *         schema: { type: integer }\n *\n *     get:\n *       summary: Obtém detalhes de um chamado\n *       tags: [Chamados]\n *       security:\n *         - bearerAuth: []\n *       responses:\n *         '200': { description: Dados do chamado }\n *         '404': { description: Chamado não encontrado }\n *\n *     put:\n *       summary: Atualiza um chamado existente\n *       tags: [Chamados]\n *       security:\n *         - bearerAuth: []\n *       requestBody:\n *         required: true\n *         content:\n *           application/json:\n *             schema:\n *               $ref: '#/components/schemas/AtualizarChamado'\n *       responses:\n *         '200': { description: Chamado atualizado }\n *         '404': { description: Chamado não encontrado }\n *\n *     delete:\n *       summary: Remove um chamado\n *       tags: [Chamados]\n *       security:\n *         - bearerAuth: []\n *       responses:\n *         '204': { description: Chamado deletado }\n *         '404': { description: Chamado não encontrado }\n *\n *   /chamados/{id}/atribuir:\n *     put:\n *       summary: Atribui um chamado a um usuário responsável (apenas admin)\n *       tags: [Chamados]\n *       security:\n *         - bearerAuth: []\n *       parameters:\n *         - in: path\n *           name: id\n *           required: true\n *           schema: { type: integer }\n *       requestBody:\n *         required: true\n *         content:\n *           application/json:\n *             schema:\n *               type: object\n *               required: [responsavel_id]\n *               properties:\n *                 responsavel_id: { type: integer }\n *       responses:\n *         '200': { description: Chamado atribuído com sucesso }\n *         '403': { description: Acesso negado }\n *         '404': { description: Chamado não encontrado }\n *\n * components:\n *   schemas:\n *     NovoChamado:\n *       type: object\n *       required: [titulo, descricao, prioridade]\n *       properties:\n *         titulo:     { type: string }\n *         descricao:  { type: string }\n *         prioridade: { type: string, enum: [baixa, media, alta] }\n *\n */\n\n// Criar chamado\nrouter.post('/', autenticarToken, validarRequisicao(schemaChamadoCreate), ChamadoController.create);\n\n// Listar chamados\nrouter.get('/', autenticarToken, ChamadoController.index);\n\n// Buscar chamados\nrouter.get('/search', autenticarToken, ChamadoController.search);\n\n// Obter chamado por ID\nrouter.get('/:id', autenticarToken, ChamadoController.show);\n\n// Atualizar chamado\nrouter.put('/:id', autenticarToken, validarRequisicao(schemaChamadoUpdate), ChamadoController.update);\n\n// Deletar chamado\nrouter.delete('/:id', autenticarToken, ChamadoController.delete);\n\n// Atribuir chamado (admin)\nrouter.put('/:id/atribuir', autenticarToken, verificarAdmin, validarRequisicao(schemaChamadoAtribuir), ChamadoController.atribuir);\nmodule.exports = router;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJleHByZXNzIiwicmVxdWlyZSIsInJvdXRlciIsIlJvdXRlciIsIkNoYW1hZG9Db250cm9sbGVyIiwiYXV0ZW50aWNhclRva2VuIiwidmFsaWRhclJlcXVpc2ljYW8iLCJ2ZXJpZmljYXJBZG1pbiIsInNjaGVtYUNoYW1hZG9DcmVhdGUiLCJzY2hlbWFDaGFtYWRvVXBkYXRlIiwic2NoZW1hQ2hhbWFkb0F0cmlidWlyIiwicG9zdCIsImNyZWF0ZSIsImdldCIsImluZGV4Iiwic2VhcmNoIiwic2hvdyIsInB1dCIsInVwZGF0ZSIsImRlbGV0ZSIsImF0cmlidWlyIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJzb3VyY2VSb290IjoiL2hvbWUvYmVybmFyZG8vc2lzdGVtYS1hdGVuZGltZW50by10aS9BVE5USS9zcmMvcm91dGVzLyIsInNvdXJjZXMiOlsiY2hhbWFkb1JvdXRlcy5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBleHByZXNzICAgICAgICAgICAgPSByZXF1aXJlKCdleHByZXNzJyk7XG5jb25zdCByb3V0ZXIgICAgICAgICAgICAgPSBleHByZXNzLlJvdXRlcigpO1xuXG5jb25zdCBDaGFtYWRvQ29udHJvbGxlciAgPSByZXF1aXJlKCcuLi9jb250cm9sbGVycy9jaGFtYWRvQ29udHJvbGxlcicpO1xuY29uc3QgYXV0ZW50aWNhclRva2VuICAgID0gcmVxdWlyZSgnLi4vbWlkZGxld2FyZXMvYXV0aE1pZGRsZXdhcmUnKTtcbmNvbnN0IHZhbGlkYXJSZXF1aXNpY2FvICA9IHJlcXVpcmUoJy4uL21pZGRsZXdhcmVzL3ZhbGlkYXJSZXF1aXNpY2FvJyk7XG5jb25zdCB2ZXJpZmljYXJBZG1pbiAgICAgPSByZXF1aXJlKCcuLi9taWRkbGV3YXJlcy9pc0FkbWluJyk7XG5jb25zdCB7XG4gIHNjaGVtYUNoYW1hZG9DcmVhdGUsXG4gIHNjaGVtYUNoYW1hZG9VcGRhdGUsXG4gIHNjaGVtYUNoYW1hZG9BdHJpYnVpcixcbn0gPSByZXF1aXJlKCcuLi92YWxpZGF0b3JzL2NoYW1hZG9WYWxpZGF0b3InKTtcblxuLyoqXG4gKiBAc3dhZ2dlclxuICogdGFnczpcbiAqICAgLSBuYW1lOiBDaGFtYWRvc1xuICogICAgIGRlc2NyaXB0aW9uOiBFbmRwb2ludHMgcGFyYSBnZXN0w6NvIGRlIGNoYW1hZG9zIGRlIFRJXG4gKlxuICogcGF0aHM6XG4gKiAgIC9jaGFtYWRvczpcbiAqICAgICBwb3N0OlxuICogICAgICAgc3VtbWFyeTogQ3JpYSB1bSBub3ZvIGNoYW1hZG9cbiAqICAgICAgIHRhZ3M6IFtDaGFtYWRvc11cbiAqICAgICAgIHNlY3VyaXR5OlxuICogICAgICAgICAtIGJlYXJlckF1dGg6IFtdXG4gKiAgICAgICByZXF1ZXN0Qm9keTpcbiAqICAgICAgICAgcmVxdWlyZWQ6IHRydWVcbiAqICAgICAgICAgY29udGVudDpcbiAqICAgICAgICAgICBhcHBsaWNhdGlvbi9qc29uOlxuICogICAgICAgICAgICAgc2NoZW1hOlxuICogICAgICAgICAgICAgICAkcmVmOiAnIy9jb21wb25lbnRzL3NjaGVtYXMvTm92b0NoYW1hZG8nXG4gKiAgICAgICByZXNwb25zZXM6XG4gKiAgICAgICAgICcyMDEnOiB7IGRlc2NyaXB0aW9uOiBDaGFtYWRvIGNyaWFkbyBjb20gc3VjZXNzbyB9XG4gKiAgICAgICAgICc0MDAnOiB7IGRlc2NyaXB0aW9uOiBEYWRvcyBpbnbDoWxpZG9zIH1cbiAqXG4gKiAgICAgZ2V0OlxuICogICAgICAgc3VtbWFyeTogTGlzdGEgdG9kb3Mgb3MgY2hhbWFkb3NcbiAqICAgICAgIHRhZ3M6IFtDaGFtYWRvc11cbiAqICAgICAgIHNlY3VyaXR5OlxuICogICAgICAgICAtIGJlYXJlckF1dGg6IFtdXG4gKiAgICAgICByZXNwb25zZXM6XG4gKiAgICAgICAgICcyMDAnOiB7IGRlc2NyaXB0aW9uOiBMaXN0YSBkZSBjaGFtYWRvcyB9XG4gKlxuICogICAvY2hhbWFkb3Mvc2VhcmNoOlxuICogICAgIGdldDpcbiAqICAgICAgIHN1bW1hcnk6IEJ1c2NhIGNoYW1hZG9zIHBvciB0w610dWxvLCBkZXNjcmnDp8OjbyBvdSBwcm90b2NvbG9cbiAqICAgICAgIHRhZ3M6IFtDaGFtYWRvc11cbiAqICAgICAgIHNlY3VyaXR5OlxuICogICAgICAgICAtIGJlYXJlckF1dGg6IFtdXG4gKiAgICAgICBwYXJhbWV0ZXJzOlxuICogICAgICAgICAtIGluOiBxdWVyeVxuICogICAgICAgICAgIG5hbWU6IHFcbiAqICAgICAgICAgICByZXF1aXJlZDogdHJ1ZVxuICogICAgICAgICAgIHNjaGVtYTogeyB0eXBlOiBzdHJpbmcgfVxuICogICAgICAgICAgIGRlc2NyaXB0aW9uOiBUZXJtbyBkZSBidXNjYSBwYXJhIHTDrXR1bG8sIGRlc2NyacOnw6NvIG91IHByb3RvY29sb1xuICogICAgICAgcmVzcG9uc2VzOlxuICogICAgICAgICAnMjAwJzogeyBkZXNjcmlwdGlvbjogTGlzdGEgZGUgY2hhbWFkb3MgZW5jb250cmFkb3MgfVxuICogICAgICAgICAnNDAwJzogeyBkZXNjcmlwdGlvbjogUGFyw6JtZXRybyBkZSBidXNjYSBhdXNlbnRlIH1cbiAqXG4gKiAgIC9jaGFtYWRvcy97aWR9OlxuICogICAgIHBhcmFtZXRlcnM6XG4gKiAgICAgICAtIGluOiBwYXRoXG4gKiAgICAgICAgIG5hbWU6IGlkXG4gKiAgICAgICAgIHJlcXVpcmVkOiB0cnVlXG4gKiAgICAgICAgIHNjaGVtYTogeyB0eXBlOiBpbnRlZ2VyIH1cbiAqXG4gKiAgICAgZ2V0OlxuICogICAgICAgc3VtbWFyeTogT2J0w6ltIGRldGFsaGVzIGRlIHVtIGNoYW1hZG9cbiAqICAgICAgIHRhZ3M6IFtDaGFtYWRvc11cbiAqICAgICAgIHNlY3VyaXR5OlxuICogICAgICAgICAtIGJlYXJlckF1dGg6IFtdXG4gKiAgICAgICByZXNwb25zZXM6XG4gKiAgICAgICAgICcyMDAnOiB7IGRlc2NyaXB0aW9uOiBEYWRvcyBkbyBjaGFtYWRvIH1cbiAqICAgICAgICAgJzQwNCc6IHsgZGVzY3JpcHRpb246IENoYW1hZG8gbsOjbyBlbmNvbnRyYWRvIH1cbiAqXG4gKiAgICAgcHV0OlxuICogICAgICAgc3VtbWFyeTogQXR1YWxpemEgdW0gY2hhbWFkbyBleGlzdGVudGVcbiAqICAgICAgIHRhZ3M6IFtDaGFtYWRvc11cbiAqICAgICAgIHNlY3VyaXR5OlxuICogICAgICAgICAtIGJlYXJlckF1dGg6IFtdXG4gKiAgICAgICByZXF1ZXN0Qm9keTpcbiAqICAgICAgICAgcmVxdWlyZWQ6IHRydWVcbiAqICAgICAgICAgY29udGVudDpcbiAqICAgICAgICAgICBhcHBsaWNhdGlvbi9qc29uOlxuICogICAgICAgICAgICAgc2NoZW1hOlxuICogICAgICAgICAgICAgICAkcmVmOiAnIy9jb21wb25lbnRzL3NjaGVtYXMvQXR1YWxpemFyQ2hhbWFkbydcbiAqICAgICAgIHJlc3BvbnNlczpcbiAqICAgICAgICAgJzIwMCc6IHsgZGVzY3JpcHRpb246IENoYW1hZG8gYXR1YWxpemFkbyB9XG4gKiAgICAgICAgICc0MDQnOiB7IGRlc2NyaXB0aW9uOiBDaGFtYWRvIG7Do28gZW5jb250cmFkbyB9XG4gKlxuICogICAgIGRlbGV0ZTpcbiAqICAgICAgIHN1bW1hcnk6IFJlbW92ZSB1bSBjaGFtYWRvXG4gKiAgICAgICB0YWdzOiBbQ2hhbWFkb3NdXG4gKiAgICAgICBzZWN1cml0eTpcbiAqICAgICAgICAgLSBiZWFyZXJBdXRoOiBbXVxuICogICAgICAgcmVzcG9uc2VzOlxuICogICAgICAgICAnMjA0JzogeyBkZXNjcmlwdGlvbjogQ2hhbWFkbyBkZWxldGFkbyB9XG4gKiAgICAgICAgICc0MDQnOiB7IGRlc2NyaXB0aW9uOiBDaGFtYWRvIG7Do28gZW5jb250cmFkbyB9XG4gKlxuICogICAvY2hhbWFkb3Mve2lkfS9hdHJpYnVpcjpcbiAqICAgICBwdXQ6XG4gKiAgICAgICBzdW1tYXJ5OiBBdHJpYnVpIHVtIGNoYW1hZG8gYSB1bSB1c3XDoXJpbyByZXNwb25zw6F2ZWwgKGFwZW5hcyBhZG1pbilcbiAqICAgICAgIHRhZ3M6IFtDaGFtYWRvc11cbiAqICAgICAgIHNlY3VyaXR5OlxuICogICAgICAgICAtIGJlYXJlckF1dGg6IFtdXG4gKiAgICAgICBwYXJhbWV0ZXJzOlxuICogICAgICAgICAtIGluOiBwYXRoXG4gKiAgICAgICAgICAgbmFtZTogaWRcbiAqICAgICAgICAgICByZXF1aXJlZDogdHJ1ZVxuICogICAgICAgICAgIHNjaGVtYTogeyB0eXBlOiBpbnRlZ2VyIH1cbiAqICAgICAgIHJlcXVlc3RCb2R5OlxuICogICAgICAgICByZXF1aXJlZDogdHJ1ZVxuICogICAgICAgICBjb250ZW50OlxuICogICAgICAgICAgIGFwcGxpY2F0aW9uL2pzb246XG4gKiAgICAgICAgICAgICBzY2hlbWE6XG4gKiAgICAgICAgICAgICAgIHR5cGU6IG9iamVjdFxuICogICAgICAgICAgICAgICByZXF1aXJlZDogW3Jlc3BvbnNhdmVsX2lkXVxuICogICAgICAgICAgICAgICBwcm9wZXJ0aWVzOlxuICogICAgICAgICAgICAgICAgIHJlc3BvbnNhdmVsX2lkOiB7IHR5cGU6IGludGVnZXIgfVxuICogICAgICAgcmVzcG9uc2VzOlxuICogICAgICAgICAnMjAwJzogeyBkZXNjcmlwdGlvbjogQ2hhbWFkbyBhdHJpYnXDrWRvIGNvbSBzdWNlc3NvIH1cbiAqICAgICAgICAgJzQwMyc6IHsgZGVzY3JpcHRpb246IEFjZXNzbyBuZWdhZG8gfVxuICogICAgICAgICAnNDA0JzogeyBkZXNjcmlwdGlvbjogQ2hhbWFkbyBuw6NvIGVuY29udHJhZG8gfVxuICpcbiAqIGNvbXBvbmVudHM6XG4gKiAgIHNjaGVtYXM6XG4gKiAgICAgTm92b0NoYW1hZG86XG4gKiAgICAgICB0eXBlOiBvYmplY3RcbiAqICAgICAgIHJlcXVpcmVkOiBbdGl0dWxvLCBkZXNjcmljYW8sIHByaW9yaWRhZGVdXG4gKiAgICAgICBwcm9wZXJ0aWVzOlxuICogICAgICAgICB0aXR1bG86ICAgICB7IHR5cGU6IHN0cmluZyB9XG4gKiAgICAgICAgIGRlc2NyaWNhbzogIHsgdHlwZTogc3RyaW5nIH1cbiAqICAgICAgICAgcHJpb3JpZGFkZTogeyB0eXBlOiBzdHJpbmcsIGVudW06IFtiYWl4YSwgbWVkaWEsIGFsdGFdIH1cbiAqXG4gKi9cblxuIC8vIENyaWFyIGNoYW1hZG9cbiByb3V0ZXIucG9zdChcbiAgICcvJyxcbiAgIGF1dGVudGljYXJUb2tlbixcbiAgIHZhbGlkYXJSZXF1aXNpY2FvKHNjaGVtYUNoYW1hZG9DcmVhdGUpLFxuICAgQ2hhbWFkb0NvbnRyb2xsZXIuY3JlYXRlXG4gKTtcblxuIC8vIExpc3RhciBjaGFtYWRvc1xuIHJvdXRlci5nZXQoJy8nLCBhdXRlbnRpY2FyVG9rZW4sIENoYW1hZG9Db250cm9sbGVyLmluZGV4KTtcblxuIC8vIEJ1c2NhciBjaGFtYWRvc1xuIHJvdXRlci5nZXQoJy9zZWFyY2gnLCBhdXRlbnRpY2FyVG9rZW4sIENoYW1hZG9Db250cm9sbGVyLnNlYXJjaCk7XG5cbiAvLyBPYnRlciBjaGFtYWRvIHBvciBJRFxuIHJvdXRlci5nZXQoJy86aWQnLCBhdXRlbnRpY2FyVG9rZW4sIENoYW1hZG9Db250cm9sbGVyLnNob3cpO1xuXG4gLy8gQXR1YWxpemFyIGNoYW1hZG9cbiByb3V0ZXIucHV0KFxuICAgJy86aWQnLFxuICAgYXV0ZW50aWNhclRva2VuLFxuICAgdmFsaWRhclJlcXVpc2ljYW8oc2NoZW1hQ2hhbWFkb1VwZGF0ZSksXG4gICBDaGFtYWRvQ29udHJvbGxlci51cGRhdGVcbiApO1xuXG4gLy8gRGVsZXRhciBjaGFtYWRvXG4gcm91dGVyLmRlbGV0ZSgnLzppZCcsIGF1dGVudGljYXJUb2tlbiwgQ2hhbWFkb0NvbnRyb2xsZXIuZGVsZXRlKTtcblxuIC8vIEF0cmlidWlyIGNoYW1hZG8gKGFkbWluKVxuIHJvdXRlci5wdXQoXG4gICAnLzppZC9hdHJpYnVpcicsXG4gICBhdXRlbnRpY2FyVG9rZW4sXG4gICB2ZXJpZmljYXJBZG1pbixcbiAgIHZhbGlkYXJSZXF1aXNpY2FvKHNjaGVtYUNoYW1hZG9BdHJpYnVpciksXG4gICBDaGFtYWRvQ29udHJvbGxlci5hdHJpYnVpclxuICk7XG5cbm1vZHVsZS5leHBvcnRzID0gcm91dGVyOyJdLCJtYXBwaW5ncyI6IkFBQUEsTUFBTUEsT0FBTyxHQUFjQyxPQUFPLENBQUMsU0FBUyxDQUFDO0FBQzdDLE1BQU1DLE1BQU0sR0FBZUYsT0FBTyxDQUFDRyxNQUFNLENBQUMsQ0FBQztBQUUzQyxNQUFNQyxpQkFBaUIsR0FBSUgsT0FBTyxDQUFDLGtDQUFrQyxDQUFDO0FBQ3RFLE1BQU1JLGVBQWUsR0FBTUosT0FBTyxDQUFDLCtCQUErQixDQUFDO0FBQ25FLE1BQU1LLGlCQUFpQixHQUFJTCxPQUFPLENBQUMsa0NBQWtDLENBQUM7QUFDdEUsTUFBTU0sY0FBYyxHQUFPTixPQUFPLENBQUMsd0JBQXdCLENBQUM7QUFDNUQsTUFBTTtFQUNKTyxtQkFBbUI7RUFDbkJDLG1CQUFtQjtFQUNuQkM7QUFDRixDQUFDLEdBQUdULE9BQU8sQ0FBQyxnQ0FBZ0MsQ0FBQzs7QUFFN0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVDO0FBQ0FDLE1BQU0sQ0FBQ1MsSUFBSSxDQUNULEdBQUcsRUFDSE4sZUFBZSxFQUNmQyxpQkFBaUIsQ0FBQ0UsbUJBQW1CLENBQUMsRUFDdENKLGlCQUFpQixDQUFDUSxNQUNwQixDQUFDOztBQUVEO0FBQ0FWLE1BQU0sQ0FBQ1csR0FBRyxDQUFDLEdBQUcsRUFBRVIsZUFBZSxFQUFFRCxpQkFBaUIsQ0FBQ1UsS0FBSyxDQUFDOztBQUV6RDtBQUNBWixNQUFNLENBQUNXLEdBQUcsQ0FBQyxTQUFTLEVBQUVSLGVBQWUsRUFBRUQsaUJBQWlCLENBQUNXLE1BQU0sQ0FBQzs7QUFFaEU7QUFDQWIsTUFBTSxDQUFDVyxHQUFHLENBQUMsTUFBTSxFQUFFUixlQUFlLEVBQUVELGlCQUFpQixDQUFDWSxJQUFJLENBQUM7O0FBRTNEO0FBQ0FkLE1BQU0sQ0FBQ2UsR0FBRyxDQUNSLE1BQU0sRUFDTlosZUFBZSxFQUNmQyxpQkFBaUIsQ0FBQ0csbUJBQW1CLENBQUMsRUFDdENMLGlCQUFpQixDQUFDYyxNQUNwQixDQUFDOztBQUVEO0FBQ0FoQixNQUFNLENBQUNpQixNQUFNLENBQUMsTUFBTSxFQUFFZCxlQUFlLEVBQUVELGlCQUFpQixDQUFDZSxNQUFNLENBQUM7O0FBRWhFO0FBQ0FqQixNQUFNLENBQUNlLEdBQUcsQ0FDUixlQUFlLEVBQ2ZaLGVBQWUsRUFDZkUsY0FBYyxFQUNkRCxpQkFBaUIsQ0FBQ0kscUJBQXFCLENBQUMsRUFDeENOLGlCQUFpQixDQUFDZ0IsUUFDcEIsQ0FBQztBQUVGQyxNQUFNLENBQUNDLE9BQU8sR0FBR3BCLE1BQU0iLCJpZ25vcmVMaXN0IjpbXX0=","map":{"version":3,"names":["express","require","router","Router","ChamadoController","autenticarToken","validarRequisicao","verificarAdmin","schemaChamadoCreate","schemaChamadoUpdate","schemaChamadoAtribuir","post","create","get","index","search","show","put","update","delete","atribuir","module","exports"],"sourceRoot":"/home/bernardo/sistema-atendimento-ti/ATNTI/src/routes/","sources":["chamadoRoutes.js"],"sourcesContent":["const express            = require('express');\nconst router             = express.Router();\n\nconst ChamadoController  = require('../controllers/chamadoController');\nconst autenticarToken    = require('../middlewares/authMiddleware');\nconst validarRequisicao  = require('../middlewares/validarRequisicao');\nconst verificarAdmin     = require('../middlewares/isAdmin');\nconst {\n  schemaChamadoCreate,\n  schemaChamadoUpdate,\n  schemaChamadoAtribuir,\n} = require('../validators/chamadoValidator');\n\n/**\n * @swagger\n * tags:\n *   - name: Chamados\n *     description: Endpoints para gestão de chamados de TI\n *\n * paths:\n *   /chamados:\n *     post:\n *       summary: Cria um novo chamado\n *       tags: [Chamados]\n *       security:\n *         - bearerAuth: []\n *       requestBody:\n *         required: true\n *         content:\n *           application/json:\n *             schema:\n *               $ref: '#/components/schemas/NovoChamado'\n *       responses:\n *         '201': { description: Chamado criado com sucesso }\n *         '400': { description: Dados inválidos }\n *\n *     get:\n *       summary: Lista todos os chamados\n *       tags: [Chamados]\n *       security:\n *         - bearerAuth: []\n *       responses:\n *         '200': { description: Lista de chamados }\n *\n *   /chamados/search:\n *     get:\n *       summary: Busca chamados por título, descrição ou protocolo\n *       tags: [Chamados]\n *       security:\n *         - bearerAuth: []\n *       parameters:\n *         - in: query\n *           name: q\n *           required: true\n *           schema: { type: string }\n *           description: Termo de busca para título, descrição ou protocolo\n *       responses:\n *         '200': { description: Lista de chamados encontrados }\n *         '400': { description: Parâmetro de busca ausente }\n *\n *   /chamados/{id}:\n *     parameters:\n *       - in: path\n *         name: id\n *         required: true\n *         schema: { type: integer }\n *\n *     get:\n *       summary: Obtém detalhes de um chamado\n *       tags: [Chamados]\n *       security:\n *         - bearerAuth: []\n *       responses:\n *         '200': { description: Dados do chamado }\n *         '404': { description: Chamado não encontrado }\n *\n *     put:\n *       summary: Atualiza um chamado existente\n *       tags: [Chamados]\n *       security:\n *         - bearerAuth: []\n *       requestBody:\n *         required: true\n *         content:\n *           application/json:\n *             schema:\n *               $ref: '#/components/schemas/AtualizarChamado'\n *       responses:\n *         '200': { description: Chamado atualizado }\n *         '404': { description: Chamado não encontrado }\n *\n *     delete:\n *       summary: Remove um chamado\n *       tags: [Chamados]\n *       security:\n *         - bearerAuth: []\n *       responses:\n *         '204': { description: Chamado deletado }\n *         '404': { description: Chamado não encontrado }\n *\n *   /chamados/{id}/atribuir:\n *     put:\n *       summary: Atribui um chamado a um usuário responsável (apenas admin)\n *       tags: [Chamados]\n *       security:\n *         - bearerAuth: []\n *       parameters:\n *         - in: path\n *           name: id\n *           required: true\n *           schema: { type: integer }\n *       requestBody:\n *         required: true\n *         content:\n *           application/json:\n *             schema:\n *               type: object\n *               required: [responsavel_id]\n *               properties:\n *                 responsavel_id: { type: integer }\n *       responses:\n *         '200': { description: Chamado atribuído com sucesso }\n *         '403': { description: Acesso negado }\n *         '404': { description: Chamado não encontrado }\n *\n * components:\n *   schemas:\n *     NovoChamado:\n *       type: object\n *       required: [titulo, descricao, prioridade]\n *       properties:\n *         titulo:     { type: string }\n *         descricao:  { type: string }\n *         prioridade: { type: string, enum: [baixa, media, alta] }\n *\n */\n\n // Criar chamado\n router.post(\n   '/',\n   autenticarToken,\n   validarRequisicao(schemaChamadoCreate),\n   ChamadoController.create\n );\n\n // Listar chamados\n router.get('/', autenticarToken, ChamadoController.index);\n\n // Buscar chamados\n router.get('/search', autenticarToken, ChamadoController.search);\n\n // Obter chamado por ID\n router.get('/:id', autenticarToken, ChamadoController.show);\n\n // Atualizar chamado\n router.put(\n   '/:id',\n   autenticarToken,\n   validarRequisicao(schemaChamadoUpdate),\n   ChamadoController.update\n );\n\n // Deletar chamado\n router.delete('/:id', autenticarToken, ChamadoController.delete);\n\n // Atribuir chamado (admin)\n router.put(\n   '/:id/atribuir',\n   autenticarToken,\n   verificarAdmin,\n   validarRequisicao(schemaChamadoAtribuir),\n   ChamadoController.atribuir\n );\n\nmodule.exports = router;"],"mappings":"AAAA,MAAMA,OAAO,GAAcC,OAAO,CAAC,SAAS,CAAC;AAC7C,MAAMC,MAAM,GAAeF,OAAO,CAACG,MAAM,CAAC,CAAC;AAE3C,MAAMC,iBAAiB,GAAIH,OAAO,CAAC,kCAAkC,CAAC;AACtE,MAAMI,eAAe,GAAMJ,OAAO,CAAC,+BAA+B,CAAC;AACnE,MAAMK,iBAAiB,GAAIL,OAAO,CAAC,kCAAkC,CAAC;AACtE,MAAMM,cAAc,GAAON,OAAO,CAAC,wBAAwB,CAAC;AAC5D,MAAM;EACJO,mBAAmB;EACnBC,mBAAmB;EACnBC;AACF,CAAC,GAAGT,OAAO,CAAC,gCAAgC,CAAC;;AAE7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEC;AACAC,MAAM,CAACS,IAAI,CACT,GAAG,EACHN,eAAe,EACfC,iBAAiB,CAACE,mBAAmB,CAAC,EACtCJ,iBAAiB,CAACQ,MACpB,CAAC;;AAED;AACAV,MAAM,CAACW,GAAG,CAAC,GAAG,EAAER,eAAe,EAAED,iBAAiB,CAACU,KAAK,CAAC;;AAEzD;AACAZ,MAAM,CAACW,GAAG,CAAC,SAAS,EAAER,eAAe,EAAED,iBAAiB,CAACW,MAAM,CAAC;;AAEhE;AACAb,MAAM,CAACW,GAAG,CAAC,MAAM,EAAER,eAAe,EAAED,iBAAiB,CAACY,IAAI,CAAC;;AAE3D;AACAd,MAAM,CAACe,GAAG,CACR,MAAM,EACNZ,eAAe,EACfC,iBAAiB,CAACG,mBAAmB,CAAC,EACtCL,iBAAiB,CAACc,MACpB,CAAC;;AAED;AACAhB,MAAM,CAACiB,MAAM,CAAC,MAAM,EAAEd,eAAe,EAAED,iBAAiB,CAACe,MAAM,CAAC;;AAEhE;AACAjB,MAAM,CAACe,GAAG,CACR,eAAe,EACfZ,eAAe,EACfE,cAAc,EACdD,iBAAiB,CAACI,qBAAqB,CAAC,EACxCN,iBAAiB,CAACgB,QACpB,CAAC;AAEFC,MAAM,CAACC,OAAO,GAAGpB,MAAM","ignoreList":[]}},"mtime":1754588748960},"{\"assumptions\":{},\"sourceRoot\":\"/home/bernardo/sistema-atendimento-ti/ATNTI/src/controllers/\",\"caller\":{\"name\":\"@babel/register\"},\"cwd\":\"/home/bernardo/sistema-atendimento-ti/ATNTI\",\"filename\":\"/home/bernardo/sistema-atendimento-ti/ATNTI/src/controllers/chamadoController.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/home/bernardo/sistema-atendimento-ti/ATNTI\",\"rootMode\":\"root\",\"plugins\":[],\"presets\":[]}:7.28.0:development":{"value":{"code":"const ChamadoModel = require('../models/chamadoModel');\nconst NotificacaoModel = require('../models/notificacaoModel');\nconst ChamadoController = {\n  async create(req, res, next) {\n    try {\n      const {\n        prioridade,\n        titulo,\n        descricao\n      } = req.body;\n      const usuario_id = req.usuario.id;\n      const chamado = await ChamadoModel.create({\n        usuario_id,\n        prioridade,\n        titulo,\n        descricao\n      });\n      await NotificacaoModel.add({\n        usuario_id: chamado.usuario_id,\n        chamado_id: chamado.id,\n        mensagem: `Seu chamado \"${chamado.titulo}\" foi aberto com sucesso.`\n      });\n      res.status(201).json(chamado);\n    } catch (err) {\n      next(err);\n    }\n  },\n  async index(req, res, next) {\n    try {\n      const chamados = await ChamadoModel.findAll();\n      res.json(chamados);\n    } catch (err) {\n      next(err);\n    }\n  },\n  async search(req, res, next) {\n    try {\n      const {\n        q\n      } = req.query;\n      if (!q) {\n        return res.status(400).json({\n          erro: 'Parâmetro de busca \"q\" é obrigatório.'\n        });\n      }\n      const chamados = await ChamadoModel.search(q);\n      res.json(chamados);\n    } catch (err) {\n      next(err);\n    }\n  },\n  async show(req, res, next) {\n    try {\n      const chamado = await ChamadoModel.findById(req.params.id);\n      if (!chamado) {\n        return res.status(404).json({\n          erro: 'Chamado não encontrado'\n        });\n      }\n      res.json(chamado);\n    } catch (err) {\n      next(err);\n    }\n  },\n  async update(req, res, next) {\n    try {\n      const {\n        id\n      } = req.params;\n      const {\n        prioridade,\n        titulo,\n        descricao\n      } = req.body;\n      const chamadoExistente = await ChamadoModel.findById(id);\n      if (!chamadoExistente) {\n        return res.status(404).json({\n          erro: 'Chamado não encontrado'\n        });\n      }\n      const chamadoAtualizado = await ChamadoModel.update(id, {\n        prioridade,\n        titulo,\n        descricao\n      });\n      await NotificacaoModel.add({\n        usuario_id: chamadoAtualizado.usuario_id,\n        chamado_id: chamadoAtualizado.id,\n        mensagem: `O chamado \"${chamadoAtualizado.titulo}\" foi atualizado.`\n      });\n      res.json(chamadoAtualizado);\n    } catch (err) {\n      next(err);\n    }\n  },\n  async atribuir(req, res, next) {\n    try {\n      const {\n        id\n      } = req.params;\n      const {\n        responsavel_id\n      } = req.body;\n      const chamadoExistente = await ChamadoModel.findById(id);\n      if (!chamadoExistente) {\n        return res.status(404).json({\n          erro: 'Chamado não encontrado'\n        });\n      }\n      const chamadoAtualizado = await ChamadoModel.atribuirResponsavel(id, responsavel_id);\n      await NotificacaoModel.add({\n        usuario_id: chamadoAtualizado.responsavel_id,\n        chamado_id: chamadoAtualizado.id,\n        mensagem: `Um novo chamado foi atribuído a você: \"${chamadoAtualizado.titulo}\".`\n      });\n      res.json(chamadoAtualizado);\n    } catch (err) {\n      next(err);\n    }\n  },\n  async delete(req, res, next) {\n    try {\n      const chamado = await ChamadoModel.findById(req.params.id);\n      if (!chamado) {\n        return res.status(404).json({\n          erro: 'Chamado não encontrado'\n        });\n      }\n      await ChamadoModel.delete(req.params.id);\n      res.status(204).send();\n    } catch (err) {\n      next(err);\n    }\n  }\n};\nmodule.exports = ChamadoController;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJDaGFtYWRvTW9kZWwiLCJyZXF1aXJlIiwiTm90aWZpY2FjYW9Nb2RlbCIsIkNoYW1hZG9Db250cm9sbGVyIiwiY3JlYXRlIiwicmVxIiwicmVzIiwibmV4dCIsInByaW9yaWRhZGUiLCJ0aXR1bG8iLCJkZXNjcmljYW8iLCJib2R5IiwidXN1YXJpb19pZCIsInVzdWFyaW8iLCJpZCIsImNoYW1hZG8iLCJhZGQiLCJjaGFtYWRvX2lkIiwibWVuc2FnZW0iLCJzdGF0dXMiLCJqc29uIiwiZXJyIiwiaW5kZXgiLCJjaGFtYWRvcyIsImZpbmRBbGwiLCJzZWFyY2giLCJxIiwicXVlcnkiLCJlcnJvIiwic2hvdyIsImZpbmRCeUlkIiwicGFyYW1zIiwidXBkYXRlIiwiY2hhbWFkb0V4aXN0ZW50ZSIsImNoYW1hZG9BdHVhbGl6YWRvIiwiYXRyaWJ1aXIiLCJyZXNwb25zYXZlbF9pZCIsImF0cmlidWlyUmVzcG9uc2F2ZWwiLCJkZWxldGUiLCJzZW5kIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJzb3VyY2VSb290IjoiL2hvbWUvYmVybmFyZG8vc2lzdGVtYS1hdGVuZGltZW50by10aS9BVE5USS9zcmMvY29udHJvbGxlcnMvIiwic291cmNlcyI6WyJjaGFtYWRvQ29udHJvbGxlci5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBDaGFtYWRvTW9kZWwgPSByZXF1aXJlKCcuLi9tb2RlbHMvY2hhbWFkb01vZGVsJyk7XG5jb25zdCBOb3RpZmljYWNhb01vZGVsID0gcmVxdWlyZSgnLi4vbW9kZWxzL25vdGlmaWNhY2FvTW9kZWwnKTtcblxuY29uc3QgQ2hhbWFkb0NvbnRyb2xsZXIgPSB7XG4gIGFzeW5jIGNyZWF0ZShyZXEsIHJlcywgbmV4dCkge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCB7IHByaW9yaWRhZGUsIHRpdHVsbywgZGVzY3JpY2FvIH0gPSByZXEuYm9keTtcbiAgICAgIGNvbnN0IHVzdWFyaW9faWQgPSByZXEudXN1YXJpby5pZDtcblxuICAgICAgY29uc3QgY2hhbWFkbyA9IGF3YWl0IENoYW1hZG9Nb2RlbC5jcmVhdGUoe1xuICAgICAgICB1c3VhcmlvX2lkLFxuICAgICAgICBwcmlvcmlkYWRlLFxuICAgICAgICB0aXR1bG8sXG4gICAgICAgIGRlc2NyaWNhb1xuICAgICAgfSk7XG4gICAgICBcbiAgICAgIGF3YWl0IE5vdGlmaWNhY2FvTW9kZWwuYWRkKHtcbiAgICAgICAgICB1c3VhcmlvX2lkOiBjaGFtYWRvLnVzdWFyaW9faWQsXG4gICAgICAgICAgY2hhbWFkb19pZDogY2hhbWFkby5pZCxcbiAgICAgICAgICBtZW5zYWdlbTogYFNldSBjaGFtYWRvIFwiJHtjaGFtYWRvLnRpdHVsb31cIiBmb2kgYWJlcnRvIGNvbSBzdWNlc3NvLmBcbiAgICAgIH0pO1xuXG4gICAgICByZXMuc3RhdHVzKDIwMSkuanNvbihjaGFtYWRvKTtcbiAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgIG5leHQoZXJyKTtcbiAgICB9XG4gIH0sXG5cbiAgYXN5bmMgaW5kZXgocmVxLCByZXMsIG5leHQpIHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgY2hhbWFkb3MgPSBhd2FpdCBDaGFtYWRvTW9kZWwuZmluZEFsbCgpO1xuICAgICAgcmVzLmpzb24oY2hhbWFkb3MpO1xuICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgbmV4dChlcnIpO1xuICAgIH1cbiAgfSxcblxuICBhc3luYyBzZWFyY2gocmVxLCByZXMsIG5leHQpIHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgeyBxIH0gPSByZXEucXVlcnk7XG4gICAgICBpZiAoIXEpIHtcbiAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAwKS5qc29uKHsgZXJybzogJ1BhcsOibWV0cm8gZGUgYnVzY2EgXCJxXCIgw6kgb2JyaWdhdMOzcmlvLicgfSk7XG4gICAgICB9XG4gICAgICBjb25zdCBjaGFtYWRvcyA9IGF3YWl0IENoYW1hZG9Nb2RlbC5zZWFyY2gocSk7XG4gICAgICByZXMuanNvbihjaGFtYWRvcyk7XG4gICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICBuZXh0KGVycik7XG4gICAgfVxuICB9LFxuXG4gIGFzeW5jIHNob3cocmVxLCByZXMsIG5leHQpIHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgY2hhbWFkbyA9IGF3YWl0IENoYW1hZG9Nb2RlbC5maW5kQnlJZChyZXEucGFyYW1zLmlkKTtcbiAgICAgIGlmICghY2hhbWFkbykge1xuICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDQpLmpzb24oeyBlcnJvOiAnQ2hhbWFkbyBuw6NvIGVuY29udHJhZG8nIH0pO1xuICAgICAgfVxuICAgICAgcmVzLmpzb24oY2hhbWFkbyk7XG4gICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICBuZXh0KGVycik7XG4gICAgfVxuICB9LFxuXG4gIGFzeW5jIHVwZGF0ZShyZXEsIHJlcywgbmV4dCkge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCB7IGlkIH0gPSByZXEucGFyYW1zO1xuICAgICAgY29uc3QgeyBwcmlvcmlkYWRlLCB0aXR1bG8sIGRlc2NyaWNhbyB9ID0gcmVxLmJvZHk7XG5cbiAgICAgIGNvbnN0IGNoYW1hZG9FeGlzdGVudGUgPSBhd2FpdCBDaGFtYWRvTW9kZWwuZmluZEJ5SWQoaWQpO1xuICAgICAgaWYgKCFjaGFtYWRvRXhpc3RlbnRlKSB7XG4gICAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwNCkuanNvbih7IGVycm86ICdDaGFtYWRvIG7Do28gZW5jb250cmFkbycgfSk7XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IGNoYW1hZG9BdHVhbGl6YWRvID0gYXdhaXQgQ2hhbWFkb01vZGVsLnVwZGF0ZShpZCwge1xuICAgICAgICBwcmlvcmlkYWRlLFxuICAgICAgICB0aXR1bG8sXG4gICAgICAgIGRlc2NyaWNhb1xuICAgICAgfSk7XG4gICAgICBcbiAgICAgIGF3YWl0IE5vdGlmaWNhY2FvTW9kZWwuYWRkKHtcbiAgICAgICAgdXN1YXJpb19pZDogY2hhbWFkb0F0dWFsaXphZG8udXN1YXJpb19pZCxcbiAgICAgICAgY2hhbWFkb19pZDogY2hhbWFkb0F0dWFsaXphZG8uaWQsXG4gICAgICAgIG1lbnNhZ2VtOiBgTyBjaGFtYWRvIFwiJHtjaGFtYWRvQXR1YWxpemFkby50aXR1bG99XCIgZm9pIGF0dWFsaXphZG8uYFxuICAgICAgfSk7XG5cbiAgICAgIHJlcy5qc29uKGNoYW1hZG9BdHVhbGl6YWRvKTtcbiAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgIG5leHQoZXJyKTtcbiAgICB9XG4gIH0sXG5cbiAgYXN5bmMgYXRyaWJ1aXIocmVxLCByZXMsIG5leHQpIHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgeyBpZCB9ID0gcmVxLnBhcmFtcztcbiAgICAgIGNvbnN0IHsgcmVzcG9uc2F2ZWxfaWQgfSA9IHJlcS5ib2R5O1xuXG4gICAgICBjb25zdCBjaGFtYWRvRXhpc3RlbnRlID0gYXdhaXQgQ2hhbWFkb01vZGVsLmZpbmRCeUlkKGlkKTtcbiAgICAgIGlmICghY2hhbWFkb0V4aXN0ZW50ZSkge1xuICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDQpLmpzb24oeyBlcnJvOiAnQ2hhbWFkbyBuw6NvIGVuY29udHJhZG8nIH0pO1xuICAgICAgfVxuXG4gICAgICBjb25zdCBjaGFtYWRvQXR1YWxpemFkbyA9IGF3YWl0IENoYW1hZG9Nb2RlbC5hdHJpYnVpclJlc3BvbnNhdmVsKGlkLCByZXNwb25zYXZlbF9pZCk7XG5cbiAgICAgIGF3YWl0IE5vdGlmaWNhY2FvTW9kZWwuYWRkKHtcbiAgICAgICAgICB1c3VhcmlvX2lkOiBjaGFtYWRvQXR1YWxpemFkby5yZXNwb25zYXZlbF9pZCxcbiAgICAgICAgICBjaGFtYWRvX2lkOiBjaGFtYWRvQXR1YWxpemFkby5pZCxcbiAgICAgICAgICBtZW5zYWdlbTogYFVtIG5vdm8gY2hhbWFkbyBmb2kgYXRyaWJ1w61kbyBhIHZvY8OqOiBcIiR7Y2hhbWFkb0F0dWFsaXphZG8udGl0dWxvfVwiLmBcbiAgICAgIH0pO1xuXG4gICAgICByZXMuanNvbihjaGFtYWRvQXR1YWxpemFkbyk7XG4gICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICBuZXh0KGVycik7XG4gICAgfVxuICB9LFxuXG4gIGFzeW5jIGRlbGV0ZShyZXEsIHJlcywgbmV4dCkge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCBjaGFtYWRvID0gYXdhaXQgQ2hhbWFkb01vZGVsLmZpbmRCeUlkKHJlcS5wYXJhbXMuaWQpO1xuICAgICAgaWYgKCFjaGFtYWRvKSB7XG4gICAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwNCkuanNvbih7IGVycm86ICdDaGFtYWRvIG7Do28gZW5jb250cmFkbycgfSk7XG4gICAgICB9XG5cbiAgICAgIGF3YWl0IENoYW1hZG9Nb2RlbC5kZWxldGUocmVxLnBhcmFtcy5pZCk7XG4gICAgICByZXMuc3RhdHVzKDIwNCkuc2VuZCgpO1xuICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgbmV4dChlcnIpO1xuICAgIH1cbiAgfVxufTtcblxubW9kdWxlLmV4cG9ydHMgPSBDaGFtYWRvQ29udHJvbGxlcjsiXSwibWFwcGluZ3MiOiJBQUFBLE1BQU1BLFlBQVksR0FBR0MsT0FBTyxDQUFDLHdCQUF3QixDQUFDO0FBQ3RELE1BQU1DLGdCQUFnQixHQUFHRCxPQUFPLENBQUMsNEJBQTRCLENBQUM7QUFFOUQsTUFBTUUsaUJBQWlCLEdBQUc7RUFDeEIsTUFBTUMsTUFBTUEsQ0FBQ0MsR0FBRyxFQUFFQyxHQUFHLEVBQUVDLElBQUksRUFBRTtJQUMzQixJQUFJO01BQ0YsTUFBTTtRQUFFQyxVQUFVO1FBQUVDLE1BQU07UUFBRUM7TUFBVSxDQUFDLEdBQUdMLEdBQUcsQ0FBQ00sSUFBSTtNQUNsRCxNQUFNQyxVQUFVLEdBQUdQLEdBQUcsQ0FBQ1EsT0FBTyxDQUFDQyxFQUFFO01BRWpDLE1BQU1DLE9BQU8sR0FBRyxNQUFNZixZQUFZLENBQUNJLE1BQU0sQ0FBQztRQUN4Q1EsVUFBVTtRQUNWSixVQUFVO1FBQ1ZDLE1BQU07UUFDTkM7TUFDRixDQUFDLENBQUM7TUFFRixNQUFNUixnQkFBZ0IsQ0FBQ2MsR0FBRyxDQUFDO1FBQ3ZCSixVQUFVLEVBQUVHLE9BQU8sQ0FBQ0gsVUFBVTtRQUM5QkssVUFBVSxFQUFFRixPQUFPLENBQUNELEVBQUU7UUFDdEJJLFFBQVEsRUFBRSxnQkFBZ0JILE9BQU8sQ0FBQ04sTUFBTTtNQUM1QyxDQUFDLENBQUM7TUFFRkgsR0FBRyxDQUFDYSxNQUFNLENBQUMsR0FBRyxDQUFDLENBQUNDLElBQUksQ0FBQ0wsT0FBTyxDQUFDO0lBQy9CLENBQUMsQ0FBQyxPQUFPTSxHQUFHLEVBQUU7TUFDWmQsSUFBSSxDQUFDYyxHQUFHLENBQUM7SUFDWDtFQUNGLENBQUM7RUFFRCxNQUFNQyxLQUFLQSxDQUFDakIsR0FBRyxFQUFFQyxHQUFHLEVBQUVDLElBQUksRUFBRTtJQUMxQixJQUFJO01BQ0YsTUFBTWdCLFFBQVEsR0FBRyxNQUFNdkIsWUFBWSxDQUFDd0IsT0FBTyxDQUFDLENBQUM7TUFDN0NsQixHQUFHLENBQUNjLElBQUksQ0FBQ0csUUFBUSxDQUFDO0lBQ3BCLENBQUMsQ0FBQyxPQUFPRixHQUFHLEVBQUU7TUFDWmQsSUFBSSxDQUFDYyxHQUFHLENBQUM7SUFDWDtFQUNGLENBQUM7RUFFRCxNQUFNSSxNQUFNQSxDQUFDcEIsR0FBRyxFQUFFQyxHQUFHLEVBQUVDLElBQUksRUFBRTtJQUMzQixJQUFJO01BQ0YsTUFBTTtRQUFFbUI7TUFBRSxDQUFDLEdBQUdyQixHQUFHLENBQUNzQixLQUFLO01BQ3ZCLElBQUksQ0FBQ0QsQ0FBQyxFQUFFO1FBQ04sT0FBT3BCLEdBQUcsQ0FBQ2EsTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDQyxJQUFJLENBQUM7VUFBRVEsSUFBSSxFQUFFO1FBQXdDLENBQUMsQ0FBQztNQUNoRjtNQUNBLE1BQU1MLFFBQVEsR0FBRyxNQUFNdkIsWUFBWSxDQUFDeUIsTUFBTSxDQUFDQyxDQUFDLENBQUM7TUFDN0NwQixHQUFHLENBQUNjLElBQUksQ0FBQ0csUUFBUSxDQUFDO0lBQ3BCLENBQUMsQ0FBQyxPQUFPRixHQUFHLEVBQUU7TUFDWmQsSUFBSSxDQUFDYyxHQUFHLENBQUM7SUFDWDtFQUNGLENBQUM7RUFFRCxNQUFNUSxJQUFJQSxDQUFDeEIsR0FBRyxFQUFFQyxHQUFHLEVBQUVDLElBQUksRUFBRTtJQUN6QixJQUFJO01BQ0YsTUFBTVEsT0FBTyxHQUFHLE1BQU1mLFlBQVksQ0FBQzhCLFFBQVEsQ0FBQ3pCLEdBQUcsQ0FBQzBCLE1BQU0sQ0FBQ2pCLEVBQUUsQ0FBQztNQUMxRCxJQUFJLENBQUNDLE9BQU8sRUFBRTtRQUNaLE9BQU9ULEdBQUcsQ0FBQ2EsTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDQyxJQUFJLENBQUM7VUFBRVEsSUFBSSxFQUFFO1FBQXlCLENBQUMsQ0FBQztNQUNqRTtNQUNBdEIsR0FBRyxDQUFDYyxJQUFJLENBQUNMLE9BQU8sQ0FBQztJQUNuQixDQUFDLENBQUMsT0FBT00sR0FBRyxFQUFFO01BQ1pkLElBQUksQ0FBQ2MsR0FBRyxDQUFDO0lBQ1g7RUFDRixDQUFDO0VBRUQsTUFBTVcsTUFBTUEsQ0FBQzNCLEdBQUcsRUFBRUMsR0FBRyxFQUFFQyxJQUFJLEVBQUU7SUFDM0IsSUFBSTtNQUNGLE1BQU07UUFBRU87TUFBRyxDQUFDLEdBQUdULEdBQUcsQ0FBQzBCLE1BQU07TUFDekIsTUFBTTtRQUFFdkIsVUFBVTtRQUFFQyxNQUFNO1FBQUVDO01BQVUsQ0FBQyxHQUFHTCxHQUFHLENBQUNNLElBQUk7TUFFbEQsTUFBTXNCLGdCQUFnQixHQUFHLE1BQU1qQyxZQUFZLENBQUM4QixRQUFRLENBQUNoQixFQUFFLENBQUM7TUFDeEQsSUFBSSxDQUFDbUIsZ0JBQWdCLEVBQUU7UUFDckIsT0FBTzNCLEdBQUcsQ0FBQ2EsTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDQyxJQUFJLENBQUM7VUFBRVEsSUFBSSxFQUFFO1FBQXlCLENBQUMsQ0FBQztNQUNqRTtNQUVBLE1BQU1NLGlCQUFpQixHQUFHLE1BQU1sQyxZQUFZLENBQUNnQyxNQUFNLENBQUNsQixFQUFFLEVBQUU7UUFDdEROLFVBQVU7UUFDVkMsTUFBTTtRQUNOQztNQUNGLENBQUMsQ0FBQztNQUVGLE1BQU1SLGdCQUFnQixDQUFDYyxHQUFHLENBQUM7UUFDekJKLFVBQVUsRUFBRXNCLGlCQUFpQixDQUFDdEIsVUFBVTtRQUN4Q0ssVUFBVSxFQUFFaUIsaUJBQWlCLENBQUNwQixFQUFFO1FBQ2hDSSxRQUFRLEVBQUUsY0FBY2dCLGlCQUFpQixDQUFDekIsTUFBTTtNQUNsRCxDQUFDLENBQUM7TUFFRkgsR0FBRyxDQUFDYyxJQUFJLENBQUNjLGlCQUFpQixDQUFDO0lBQzdCLENBQUMsQ0FBQyxPQUFPYixHQUFHLEVBQUU7TUFDWmQsSUFBSSxDQUFDYyxHQUFHLENBQUM7SUFDWDtFQUNGLENBQUM7RUFFRCxNQUFNYyxRQUFRQSxDQUFDOUIsR0FBRyxFQUFFQyxHQUFHLEVBQUVDLElBQUksRUFBRTtJQUM3QixJQUFJO01BQ0YsTUFBTTtRQUFFTztNQUFHLENBQUMsR0FBR1QsR0FBRyxDQUFDMEIsTUFBTTtNQUN6QixNQUFNO1FBQUVLO01BQWUsQ0FBQyxHQUFHL0IsR0FBRyxDQUFDTSxJQUFJO01BRW5DLE1BQU1zQixnQkFBZ0IsR0FBRyxNQUFNakMsWUFBWSxDQUFDOEIsUUFBUSxDQUFDaEIsRUFBRSxDQUFDO01BQ3hELElBQUksQ0FBQ21CLGdCQUFnQixFQUFFO1FBQ3JCLE9BQU8zQixHQUFHLENBQUNhLE1BQU0sQ0FBQyxHQUFHLENBQUMsQ0FBQ0MsSUFBSSxDQUFDO1VBQUVRLElBQUksRUFBRTtRQUF5QixDQUFDLENBQUM7TUFDakU7TUFFQSxNQUFNTSxpQkFBaUIsR0FBRyxNQUFNbEMsWUFBWSxDQUFDcUMsbUJBQW1CLENBQUN2QixFQUFFLEVBQUVzQixjQUFjLENBQUM7TUFFcEYsTUFBTWxDLGdCQUFnQixDQUFDYyxHQUFHLENBQUM7UUFDdkJKLFVBQVUsRUFBRXNCLGlCQUFpQixDQUFDRSxjQUFjO1FBQzVDbkIsVUFBVSxFQUFFaUIsaUJBQWlCLENBQUNwQixFQUFFO1FBQ2hDSSxRQUFRLEVBQUUsMENBQTBDZ0IsaUJBQWlCLENBQUN6QixNQUFNO01BQ2hGLENBQUMsQ0FBQztNQUVGSCxHQUFHLENBQUNjLElBQUksQ0FBQ2MsaUJBQWlCLENBQUM7SUFDN0IsQ0FBQyxDQUFDLE9BQU9iLEdBQUcsRUFBRTtNQUNaZCxJQUFJLENBQUNjLEdBQUcsQ0FBQztJQUNYO0VBQ0YsQ0FBQztFQUVELE1BQU1pQixNQUFNQSxDQUFDakMsR0FBRyxFQUFFQyxHQUFHLEVBQUVDLElBQUksRUFBRTtJQUMzQixJQUFJO01BQ0YsTUFBTVEsT0FBTyxHQUFHLE1BQU1mLFlBQVksQ0FBQzhCLFFBQVEsQ0FBQ3pCLEdBQUcsQ0FBQzBCLE1BQU0sQ0FBQ2pCLEVBQUUsQ0FBQztNQUMxRCxJQUFJLENBQUNDLE9BQU8sRUFBRTtRQUNaLE9BQU9ULEdBQUcsQ0FBQ2EsTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDQyxJQUFJLENBQUM7VUFBRVEsSUFBSSxFQUFFO1FBQXlCLENBQUMsQ0FBQztNQUNqRTtNQUVBLE1BQU01QixZQUFZLENBQUNzQyxNQUFNLENBQUNqQyxHQUFHLENBQUMwQixNQUFNLENBQUNqQixFQUFFLENBQUM7TUFDeENSLEdBQUcsQ0FBQ2EsTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDb0IsSUFBSSxDQUFDLENBQUM7SUFDeEIsQ0FBQyxDQUFDLE9BQU9sQixHQUFHLEVBQUU7TUFDWmQsSUFBSSxDQUFDYyxHQUFHLENBQUM7SUFDWDtFQUNGO0FBQ0YsQ0FBQztBQUVEbUIsTUFBTSxDQUFDQyxPQUFPLEdBQUd0QyxpQkFBaUIiLCJpZ25vcmVMaXN0IjpbXX0=","map":{"version":3,"names":["ChamadoModel","require","NotificacaoModel","ChamadoController","create","req","res","next","prioridade","titulo","descricao","body","usuario_id","usuario","id","chamado","add","chamado_id","mensagem","status","json","err","index","chamados","findAll","search","q","query","erro","show","findById","params","update","chamadoExistente","chamadoAtualizado","atribuir","responsavel_id","atribuirResponsavel","delete","send","module","exports"],"sourceRoot":"/home/bernardo/sistema-atendimento-ti/ATNTI/src/controllers/","sources":["chamadoController.js"],"sourcesContent":["const ChamadoModel = require('../models/chamadoModel');\nconst NotificacaoModel = require('../models/notificacaoModel');\n\nconst ChamadoController = {\n  async create(req, res, next) {\n    try {\n      const { prioridade, titulo, descricao } = req.body;\n      const usuario_id = req.usuario.id;\n\n      const chamado = await ChamadoModel.create({\n        usuario_id,\n        prioridade,\n        titulo,\n        descricao\n      });\n      \n      await NotificacaoModel.add({\n          usuario_id: chamado.usuario_id,\n          chamado_id: chamado.id,\n          mensagem: `Seu chamado \"${chamado.titulo}\" foi aberto com sucesso.`\n      });\n\n      res.status(201).json(chamado);\n    } catch (err) {\n      next(err);\n    }\n  },\n\n  async index(req, res, next) {\n    try {\n      const chamados = await ChamadoModel.findAll();\n      res.json(chamados);\n    } catch (err) {\n      next(err);\n    }\n  },\n\n  async search(req, res, next) {\n    try {\n      const { q } = req.query;\n      if (!q) {\n        return res.status(400).json({ erro: 'Parâmetro de busca \"q\" é obrigatório.' });\n      }\n      const chamados = await ChamadoModel.search(q);\n      res.json(chamados);\n    } catch (err) {\n      next(err);\n    }\n  },\n\n  async show(req, res, next) {\n    try {\n      const chamado = await ChamadoModel.findById(req.params.id);\n      if (!chamado) {\n        return res.status(404).json({ erro: 'Chamado não encontrado' });\n      }\n      res.json(chamado);\n    } catch (err) {\n      next(err);\n    }\n  },\n\n  async update(req, res, next) {\n    try {\n      const { id } = req.params;\n      const { prioridade, titulo, descricao } = req.body;\n\n      const chamadoExistente = await ChamadoModel.findById(id);\n      if (!chamadoExistente) {\n        return res.status(404).json({ erro: 'Chamado não encontrado' });\n      }\n\n      const chamadoAtualizado = await ChamadoModel.update(id, {\n        prioridade,\n        titulo,\n        descricao\n      });\n      \n      await NotificacaoModel.add({\n        usuario_id: chamadoAtualizado.usuario_id,\n        chamado_id: chamadoAtualizado.id,\n        mensagem: `O chamado \"${chamadoAtualizado.titulo}\" foi atualizado.`\n      });\n\n      res.json(chamadoAtualizado);\n    } catch (err) {\n      next(err);\n    }\n  },\n\n  async atribuir(req, res, next) {\n    try {\n      const { id } = req.params;\n      const { responsavel_id } = req.body;\n\n      const chamadoExistente = await ChamadoModel.findById(id);\n      if (!chamadoExistente) {\n        return res.status(404).json({ erro: 'Chamado não encontrado' });\n      }\n\n      const chamadoAtualizado = await ChamadoModel.atribuirResponsavel(id, responsavel_id);\n\n      await NotificacaoModel.add({\n          usuario_id: chamadoAtualizado.responsavel_id,\n          chamado_id: chamadoAtualizado.id,\n          mensagem: `Um novo chamado foi atribuído a você: \"${chamadoAtualizado.titulo}\".`\n      });\n\n      res.json(chamadoAtualizado);\n    } catch (err) {\n      next(err);\n    }\n  },\n\n  async delete(req, res, next) {\n    try {\n      const chamado = await ChamadoModel.findById(req.params.id);\n      if (!chamado) {\n        return res.status(404).json({ erro: 'Chamado não encontrado' });\n      }\n\n      await ChamadoModel.delete(req.params.id);\n      res.status(204).send();\n    } catch (err) {\n      next(err);\n    }\n  }\n};\n\nmodule.exports = ChamadoController;"],"mappings":"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","ignoreList":[]}},"mtime":1754590677902},"{\"assumptions\":{},\"sourceRoot\":\"/home/bernardo/sistema-atendimento-ti/ATNTI/src/models/\",\"caller\":{\"name\":\"@babel/register\"},\"cwd\":\"/home/bernardo/sistema-atendimento-ti/ATNTI\",\"filename\":\"/home/bernardo/sistema-atendimento-ti/ATNTI/src/models/notificacaoModel.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/home/bernardo/sistema-atendimento-ti/ATNTI\",\"rootMode\":\"root\",\"plugins\":[],\"presets\":[]}:7.28.0:development":{"value":{"code":"const db = require('../config/db');\nconst NotificacaoModel = {\n  async add({\n    usuario_id,\n    chamado_id,\n    mensagem\n  }) {\n    const query = `\n      INSERT INTO notificacoes (usuario_id, chamado_id, mensagem)\n      VALUES ($1, $2, $3)\n      RETURNING *\n    `;\n    const values = [usuario_id, chamado_id, mensagem];\n    const result = await db.query(query, values);\n    return result.rows[0];\n  },\n  async listByUsuario(usuario_id) {\n    const result = await db.query(`SELECT * FROM notificacoes WHERE usuario_id = $1 ORDER BY criado_em DESC`, [usuario_id]);\n    return result.rows;\n  },\n  async marcarComoLida(notificacao_id, usuario_id) {\n    const result = await db.query(`UPDATE notificacoes SET lida = TRUE WHERE id = $1 AND usuario_id = $2 RETURNING *`, [notificacao_id, usuario_id]);\n    return result.rows[0];\n  }\n};\nmodule.exports = NotificacaoModel;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJkYiIsInJlcXVpcmUiLCJOb3RpZmljYWNhb01vZGVsIiwiYWRkIiwidXN1YXJpb19pZCIsImNoYW1hZG9faWQiLCJtZW5zYWdlbSIsInF1ZXJ5IiwidmFsdWVzIiwicmVzdWx0Iiwicm93cyIsImxpc3RCeVVzdWFyaW8iLCJtYXJjYXJDb21vTGlkYSIsIm5vdGlmaWNhY2FvX2lkIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJzb3VyY2VSb290IjoiL2hvbWUvYmVybmFyZG8vc2lzdGVtYS1hdGVuZGltZW50by10aS9BVE5USS9zcmMvbW9kZWxzLyIsInNvdXJjZXMiOlsibm90aWZpY2FjYW9Nb2RlbC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBkYiA9IHJlcXVpcmUoJy4uL2NvbmZpZy9kYicpO1xuXG5jb25zdCBOb3RpZmljYWNhb01vZGVsID0ge1xuICBhc3luYyBhZGQoeyB1c3VhcmlvX2lkLCBjaGFtYWRvX2lkLCBtZW5zYWdlbSB9KSB7XG4gICAgY29uc3QgcXVlcnkgPSBgXG4gICAgICBJTlNFUlQgSU5UTyBub3RpZmljYWNvZXMgKHVzdWFyaW9faWQsIGNoYW1hZG9faWQsIG1lbnNhZ2VtKVxuICAgICAgVkFMVUVTICgkMSwgJDIsICQzKVxuICAgICAgUkVUVVJOSU5HICpcbiAgICBgO1xuICAgIGNvbnN0IHZhbHVlcyA9IFt1c3VhcmlvX2lkLCBjaGFtYWRvX2lkLCBtZW5zYWdlbV07XG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZGIucXVlcnkocXVlcnksIHZhbHVlcyk7XG4gICAgcmV0dXJuIHJlc3VsdC5yb3dzWzBdO1xuICB9LFxuXG4gIGFzeW5jIGxpc3RCeVVzdWFyaW8odXN1YXJpb19pZCkge1xuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGRiLnF1ZXJ5KFxuICAgICAgYFNFTEVDVCAqIEZST00gbm90aWZpY2Fjb2VzIFdIRVJFIHVzdWFyaW9faWQgPSAkMSBPUkRFUiBCWSBjcmlhZG9fZW0gREVTQ2AsXG4gICAgICBbdXN1YXJpb19pZF1cbiAgICApO1xuICAgIHJldHVybiByZXN1bHQucm93cztcbiAgfSxcblxuICBhc3luYyBtYXJjYXJDb21vTGlkYShub3RpZmljYWNhb19pZCwgdXN1YXJpb19pZCkge1xuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGRiLnF1ZXJ5KFxuICAgICAgYFVQREFURSBub3RpZmljYWNvZXMgU0VUIGxpZGEgPSBUUlVFIFdIRVJFIGlkID0gJDEgQU5EIHVzdWFyaW9faWQgPSAkMiBSRVRVUk5JTkcgKmAsXG4gICAgICBbbm90aWZpY2FjYW9faWQsIHVzdWFyaW9faWRdXG4gICAgKTtcbiAgICByZXR1cm4gcmVzdWx0LnJvd3NbMF07XG4gIH1cbn07XG5cbm1vZHVsZS5leHBvcnRzID0gTm90aWZpY2FjYW9Nb2RlbDsiXSwibWFwcGluZ3MiOiJBQUFBLE1BQU1BLEVBQUUsR0FBR0MsT0FBTyxDQUFDLGNBQWMsQ0FBQztBQUVsQyxNQUFNQyxnQkFBZ0IsR0FBRztFQUN2QixNQUFNQyxHQUFHQSxDQUFDO0lBQUVDLFVBQVU7SUFBRUMsVUFBVTtJQUFFQztFQUFTLENBQUMsRUFBRTtJQUM5QyxNQUFNQyxLQUFLLEdBQUc7QUFDbEI7QUFDQTtBQUNBO0FBQ0EsS0FBSztJQUNELE1BQU1DLE1BQU0sR0FBRyxDQUFDSixVQUFVLEVBQUVDLFVBQVUsRUFBRUMsUUFBUSxDQUFDO0lBQ2pELE1BQU1HLE1BQU0sR0FBRyxNQUFNVCxFQUFFLENBQUNPLEtBQUssQ0FBQ0EsS0FBSyxFQUFFQyxNQUFNLENBQUM7SUFDNUMsT0FBT0MsTUFBTSxDQUFDQyxJQUFJLENBQUMsQ0FBQyxDQUFDO0VBQ3ZCLENBQUM7RUFFRCxNQUFNQyxhQUFhQSxDQUFDUCxVQUFVLEVBQUU7SUFDOUIsTUFBTUssTUFBTSxHQUFHLE1BQU1ULEVBQUUsQ0FBQ08sS0FBSyxDQUMzQiwwRUFBMEUsRUFDMUUsQ0FBQ0gsVUFBVSxDQUNiLENBQUM7SUFDRCxPQUFPSyxNQUFNLENBQUNDLElBQUk7RUFDcEIsQ0FBQztFQUVELE1BQU1FLGNBQWNBLENBQUNDLGNBQWMsRUFBRVQsVUFBVSxFQUFFO0lBQy9DLE1BQU1LLE1BQU0sR0FBRyxNQUFNVCxFQUFFLENBQUNPLEtBQUssQ0FDM0IsbUZBQW1GLEVBQ25GLENBQUNNLGNBQWMsRUFBRVQsVUFBVSxDQUM3QixDQUFDO0lBQ0QsT0FBT0ssTUFBTSxDQUFDQyxJQUFJLENBQUMsQ0FBQyxDQUFDO0VBQ3ZCO0FBQ0YsQ0FBQztBQUVESSxNQUFNLENBQUNDLE9BQU8sR0FBR2IsZ0JBQWdCIiwiaWdub3JlTGlzdCI6W119","map":{"version":3,"names":["db","require","NotificacaoModel","add","usuario_id","chamado_id","mensagem","query","values","result","rows","listByUsuario","marcarComoLida","notificacao_id","module","exports"],"sourceRoot":"/home/bernardo/sistema-atendimento-ti/ATNTI/src/models/","sources":["notificacaoModel.js"],"sourcesContent":["const db = require('../config/db');\n\nconst NotificacaoModel = {\n  async add({ usuario_id, chamado_id, mensagem }) {\n    const query = `\n      INSERT INTO notificacoes (usuario_id, chamado_id, mensagem)\n      VALUES ($1, $2, $3)\n      RETURNING *\n    `;\n    const values = [usuario_id, chamado_id, mensagem];\n    const result = await db.query(query, values);\n    return result.rows[0];\n  },\n\n  async listByUsuario(usuario_id) {\n    const result = await db.query(\n      `SELECT * FROM notificacoes WHERE usuario_id = $1 ORDER BY criado_em DESC`,\n      [usuario_id]\n    );\n    return result.rows;\n  },\n\n  async marcarComoLida(notificacao_id, usuario_id) {\n    const result = await db.query(\n      `UPDATE notificacoes SET lida = TRUE WHERE id = $1 AND usuario_id = $2 RETURNING *`,\n      [notificacao_id, usuario_id]\n    );\n    return result.rows[0];\n  }\n};\n\nmodule.exports = NotificacaoModel;"],"mappings":"AAAA,MAAMA,EAAE,GAAGC,OAAO,CAAC,cAAc,CAAC;AAElC,MAAMC,gBAAgB,GAAG;EACvB,MAAMC,GAAGA,CAAC;IAAEC,UAAU;IAAEC,UAAU;IAAEC;EAAS,CAAC,EAAE;IAC9C,MAAMC,KAAK,GAAG;AAClB;AACA;AACA;AACA,KAAK;IACD,MAAMC,MAAM,GAAG,CAACJ,UAAU,EAAEC,UAAU,EAAEC,QAAQ,CAAC;IACjD,MAAMG,MAAM,GAAG,MAAMT,EAAE,CAACO,KAAK,CAACA,KAAK,EAAEC,MAAM,CAAC;IAC5C,OAAOC,MAAM,CAACC,IAAI,CAAC,CAAC,CAAC;EACvB,CAAC;EAED,MAAMC,aAAaA,CAACP,UAAU,EAAE;IAC9B,MAAMK,MAAM,GAAG,MAAMT,EAAE,CAACO,KAAK,CAC3B,0EAA0E,EAC1E,CAACH,UAAU,CACb,CAAC;IACD,OAAOK,MAAM,CAACC,IAAI;EACpB,CAAC;EAED,MAAME,cAAcA,CAACC,cAAc,EAAET,UAAU,EAAE;IAC/C,MAAMK,MAAM,GAAG,MAAMT,EAAE,CAACO,KAAK,CAC3B,mFAAmF,EACnF,CAACM,cAAc,EAAET,UAAU,CAC7B,CAAC;IACD,OAAOK,MAAM,CAACC,IAAI,CAAC,CAAC,CAAC;EACvB;AACF,CAAC;AAEDI,MAAM,CAACC,OAAO,GAAGb,gBAAgB","ignoreList":[]}},"mtime":1754589134279},"{\"assumptions\":{},\"sourceRoot\":\"/home/bernardo/sistema-atendimento-ti/ATNTI/src/validators/\",\"caller\":{\"name\":\"@babel/register\"},\"cwd\":\"/home/bernardo/sistema-atendimento-ti/ATNTI\",\"filename\":\"/home/bernardo/sistema-atendimento-ti/ATNTI/src/validators/chamadoValidator.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/home/bernardo/sistema-atendimento-ti/ATNTI\",\"rootMode\":\"root\",\"plugins\":[],\"presets\":[]}:7.28.0:development":{"value":{"code":"const Joi = require('joi');\nconst schemaChamadoCreate = Joi.object({\n  prioridade: Joi.string().valid('baixa', 'média', 'alta').required(),\n  titulo: Joi.string().min(3).max(100).required(),\n  descricao: Joi.string().min(5).required()\n});\nconst schemaChamadoUpdate = Joi.object({\n  prioridade: Joi.string().valid('baixa', 'média', 'alta').required(),\n  titulo: Joi.string().min(3).max(100).required(),\n  descricao: Joi.string().min(5).required()\n});\n\n// NOVO: Esquema de validação para atribuição de chamado\nconst schemaChamadoAtribuir = Joi.object({\n  responsavel_id: Joi.number().integer().required()\n});\nmodule.exports = {\n  schemaChamadoCreate,\n  schemaChamadoUpdate,\n  schemaChamadoAtribuir // exporte o novo esquema\n};\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJKb2kiLCJyZXF1aXJlIiwic2NoZW1hQ2hhbWFkb0NyZWF0ZSIsIm9iamVjdCIsInByaW9yaWRhZGUiLCJzdHJpbmciLCJ2YWxpZCIsInJlcXVpcmVkIiwidGl0dWxvIiwibWluIiwibWF4IiwiZGVzY3JpY2FvIiwic2NoZW1hQ2hhbWFkb1VwZGF0ZSIsInNjaGVtYUNoYW1hZG9BdHJpYnVpciIsInJlc3BvbnNhdmVsX2lkIiwibnVtYmVyIiwiaW50ZWdlciIsIm1vZHVsZSIsImV4cG9ydHMiXSwic291cmNlUm9vdCI6Ii9ob21lL2Jlcm5hcmRvL3Npc3RlbWEtYXRlbmRpbWVudG8tdGkvQVROVEkvc3JjL3ZhbGlkYXRvcnMvIiwic291cmNlcyI6WyJjaGFtYWRvVmFsaWRhdG9yLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImNvbnN0IEpvaSA9IHJlcXVpcmUoJ2pvaScpO1xuXG5jb25zdCBzY2hlbWFDaGFtYWRvQ3JlYXRlID0gSm9pLm9iamVjdCh7XG4gIHByaW9yaWRhZGU6IEpvaS5zdHJpbmcoKS52YWxpZCgnYmFpeGEnLCAnbcOpZGlhJywgJ2FsdGEnKS5yZXF1aXJlZCgpLFxuICB0aXR1bG86IEpvaS5zdHJpbmcoKS5taW4oMykubWF4KDEwMCkucmVxdWlyZWQoKSxcbiAgZGVzY3JpY2FvOiBKb2kuc3RyaW5nKCkubWluKDUpLnJlcXVpcmVkKClcbn0pO1xuXG5jb25zdCBzY2hlbWFDaGFtYWRvVXBkYXRlID0gSm9pLm9iamVjdCh7XG4gIHByaW9yaWRhZGU6IEpvaS5zdHJpbmcoKS52YWxpZCgnYmFpeGEnLCAnbcOpZGlhJywgJ2FsdGEnKS5yZXF1aXJlZCgpLFxuICB0aXR1bG86IEpvaS5zdHJpbmcoKS5taW4oMykubWF4KDEwMCkucmVxdWlyZWQoKSxcbiAgZGVzY3JpY2FvOiBKb2kuc3RyaW5nKCkubWluKDUpLnJlcXVpcmVkKClcbn0pO1xuXG4vLyBOT1ZPOiBFc3F1ZW1hIGRlIHZhbGlkYcOnw6NvIHBhcmEgYXRyaWJ1acOnw6NvIGRlIGNoYW1hZG9cbmNvbnN0IHNjaGVtYUNoYW1hZG9BdHJpYnVpciA9IEpvaS5vYmplY3Qoe1xuICByZXNwb25zYXZlbF9pZDogSm9pLm51bWJlcigpLmludGVnZXIoKS5yZXF1aXJlZCgpXG59KTtcblxubW9kdWxlLmV4cG9ydHMgPSB7XG4gIHNjaGVtYUNoYW1hZG9DcmVhdGUsXG4gIHNjaGVtYUNoYW1hZG9VcGRhdGUsXG4gIHNjaGVtYUNoYW1hZG9BdHJpYnVpciAvLyBleHBvcnRlIG8gbm92byBlc3F1ZW1hXG59OyJdLCJtYXBwaW5ncyI6IkFBQUEsTUFBTUEsR0FBRyxHQUFHQyxPQUFPLENBQUMsS0FBSyxDQUFDO0FBRTFCLE1BQU1DLG1CQUFtQixHQUFHRixHQUFHLENBQUNHLE1BQU0sQ0FBQztFQUNyQ0MsVUFBVSxFQUFFSixHQUFHLENBQUNLLE1BQU0sQ0FBQyxDQUFDLENBQUNDLEtBQUssQ0FBQyxPQUFPLEVBQUUsT0FBTyxFQUFFLE1BQU0sQ0FBQyxDQUFDQyxRQUFRLENBQUMsQ0FBQztFQUNuRUMsTUFBTSxFQUFFUixHQUFHLENBQUNLLE1BQU0sQ0FBQyxDQUFDLENBQUNJLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQ0MsR0FBRyxDQUFDLEdBQUcsQ0FBQyxDQUFDSCxRQUFRLENBQUMsQ0FBQztFQUMvQ0ksU0FBUyxFQUFFWCxHQUFHLENBQUNLLE1BQU0sQ0FBQyxDQUFDLENBQUNJLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQ0YsUUFBUSxDQUFDO0FBQzFDLENBQUMsQ0FBQztBQUVGLE1BQU1LLG1CQUFtQixHQUFHWixHQUFHLENBQUNHLE1BQU0sQ0FBQztFQUNyQ0MsVUFBVSxFQUFFSixHQUFHLENBQUNLLE1BQU0sQ0FBQyxDQUFDLENBQUNDLEtBQUssQ0FBQyxPQUFPLEVBQUUsT0FBTyxFQUFFLE1BQU0sQ0FBQyxDQUFDQyxRQUFRLENBQUMsQ0FBQztFQUNuRUMsTUFBTSxFQUFFUixHQUFHLENBQUNLLE1BQU0sQ0FBQyxDQUFDLENBQUNJLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQ0MsR0FBRyxDQUFDLEdBQUcsQ0FBQyxDQUFDSCxRQUFRLENBQUMsQ0FBQztFQUMvQ0ksU0FBUyxFQUFFWCxHQUFHLENBQUNLLE1BQU0sQ0FBQyxDQUFDLENBQUNJLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQ0YsUUFBUSxDQUFDO0FBQzFDLENBQUMsQ0FBQzs7QUFFRjtBQUNBLE1BQU1NLHFCQUFxQixHQUFHYixHQUFHLENBQUNHLE1BQU0sQ0FBQztFQUN2Q1csY0FBYyxFQUFFZCxHQUFHLENBQUNlLE1BQU0sQ0FBQyxDQUFDLENBQUNDLE9BQU8sQ0FBQyxDQUFDLENBQUNULFFBQVEsQ0FBQztBQUNsRCxDQUFDLENBQUM7QUFFRlUsTUFBTSxDQUFDQyxPQUFPLEdBQUc7RUFDZmhCLG1CQUFtQjtFQUNuQlUsbUJBQW1CO0VBQ25CQyxxQkFBcUIsQ0FBQztBQUN4QixDQUFDIiwiaWdub3JlTGlzdCI6W119","map":{"version":3,"names":["Joi","require","schemaChamadoCreate","object","prioridade","string","valid","required","titulo","min","max","descricao","schemaChamadoUpdate","schemaChamadoAtribuir","responsavel_id","number","integer","module","exports"],"sourceRoot":"/home/bernardo/sistema-atendimento-ti/ATNTI/src/validators/","sources":["chamadoValidator.js"],"sourcesContent":["const Joi = require('joi');\n\nconst schemaChamadoCreate = Joi.object({\n  prioridade: Joi.string().valid('baixa', 'média', 'alta').required(),\n  titulo: Joi.string().min(3).max(100).required(),\n  descricao: Joi.string().min(5).required()\n});\n\nconst schemaChamadoUpdate = Joi.object({\n  prioridade: Joi.string().valid('baixa', 'média', 'alta').required(),\n  titulo: Joi.string().min(3).max(100).required(),\n  descricao: Joi.string().min(5).required()\n});\n\n// NOVO: Esquema de validação para atribuição de chamado\nconst schemaChamadoAtribuir = Joi.object({\n  responsavel_id: Joi.number().integer().required()\n});\n\nmodule.exports = {\n  schemaChamadoCreate,\n  schemaChamadoUpdate,\n  schemaChamadoAtribuir // exporte o novo esquema\n};"],"mappings":"AAAA,MAAMA,GAAG,GAAGC,OAAO,CAAC,KAAK,CAAC;AAE1B,MAAMC,mBAAmB,GAAGF,GAAG,CAACG,MAAM,CAAC;EACrCC,UAAU,EAAEJ,GAAG,CAACK,MAAM,CAAC,CAAC,CAACC,KAAK,CAAC,OAAO,EAAE,OAAO,EAAE,MAAM,CAAC,CAACC,QAAQ,CAAC,CAAC;EACnEC,MAAM,EAAER,GAAG,CAACK,MAAM,CAAC,CAAC,CAACI,GAAG,CAAC,CAAC,CAAC,CAACC,GAAG,CAAC,GAAG,CAAC,CAACH,QAAQ,CAAC,CAAC;EAC/CI,SAAS,EAAEX,GAAG,CAACK,MAAM,CAAC,CAAC,CAACI,GAAG,CAAC,CAAC,CAAC,CAACF,QAAQ,CAAC;AAC1C,CAAC,CAAC;AAEF,MAAMK,mBAAmB,GAAGZ,GAAG,CAACG,MAAM,CAAC;EACrCC,UAAU,EAAEJ,GAAG,CAACK,MAAM,CAAC,CAAC,CAACC,KAAK,CAAC,OAAO,EAAE,OAAO,EAAE,MAAM,CAAC,CAACC,QAAQ,CAAC,CAAC;EACnEC,MAAM,EAAER,GAAG,CAACK,MAAM,CAAC,CAAC,CAACI,GAAG,CAAC,CAAC,CAAC,CAACC,GAAG,CAAC,GAAG,CAAC,CAACH,QAAQ,CAAC,CAAC;EAC/CI,SAAS,EAAEX,GAAG,CAACK,MAAM,CAAC,CAAC,CAACI,GAAG,CAAC,CAAC,CAAC,CAACF,QAAQ,CAAC;AAC1C,CAAC,CAAC;;AAEF;AACA,MAAMM,qBAAqB,GAAGb,GAAG,CAACG,MAAM,CAAC;EACvCW,cAAc,EAAEd,GAAG,CAACe,MAAM,CAAC,CAAC,CAACC,OAAO,CAAC,CAAC,CAACT,QAAQ,CAAC;AAClD,CAAC,CAAC;AAEFU,MAAM,CAACC,OAAO,GAAG;EACfhB,mBAAmB;EACnBU,mBAAmB;EACnBC,qBAAqB,CAAC;AACxB,CAAC","ignoreList":[]}},"mtime":1754584736032},"{\"assumptions\":{},\"sourceRoot\":\"/home/bernardo/sistema-atendimento-ti/ATNTI/src/routes/\",\"caller\":{\"name\":\"@babel/register\"},\"cwd\":\"/home/bernardo/sistema-atendimento-ti/ATNTI\",\"filename\":\"/home/bernardo/sistema-atendimento-ti/ATNTI/src/routes/statusRoutes.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/home/bernardo/sistema-atendimento-ti/ATNTI\",\"rootMode\":\"root\",\"plugins\":[],\"presets\":[]}:7.28.0:development":{"value":{"code":"const express = require('express');\nconst router = express.Router({\n  mergeParams: true\n});\nconst StatusController = require('../controllers/statusController');\nconst autenticarToken = require('../middlewares/authMiddleware');\nconst validarRequisicao = require('../middlewares/validarRequisicao');\nconst schemaStatus = require('../validators/statusValidator');\n\n// Criar novo status para o chamado\n/**\n * @swagger\n * /chamados/{chamado_id}/status:\n *   post:\n *     summary: Registra um novo status para um chamado\n *     tags: [Status]\n *     security:\n *       - bearerAuth: []\n *     parameters:\n *       - name: chamado_id\n *         in: path\n *         required: true\n *         schema:\n *           type: integer\n *     requestBody:\n *       required: true\n *       content:\n *         application/json:\n *           schema:\n *             type: object\n *             required: [status, comentario]\n *             properties:\n *               status:\n *                 type: string\n *                 enum: [em atendimento, pausado, finalizado]\n *               comentario:\n *                 type: string\n *     responses:\n *       201:\n *         description: Status registrado com sucesso\n *       400:\n *         description: Chamado já finalizado ou dados inválidos\n */\n\nrouter.post('/', autenticarToken, validarRequisicao(schemaStatus), StatusController.create);\n\n// Listar todos os status de um chamado\nrouter.get('/', autenticarToken, StatusController.list);\n\n// Obter o status atual do chamado\nrouter.get('/atual', autenticarToken, StatusController.getStatusAtual);\nmodule.exports = router;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJleHByZXNzIiwicmVxdWlyZSIsInJvdXRlciIsIlJvdXRlciIsIm1lcmdlUGFyYW1zIiwiU3RhdHVzQ29udHJvbGxlciIsImF1dGVudGljYXJUb2tlbiIsInZhbGlkYXJSZXF1aXNpY2FvIiwic2NoZW1hU3RhdHVzIiwicG9zdCIsImNyZWF0ZSIsImdldCIsImxpc3QiLCJnZXRTdGF0dXNBdHVhbCIsIm1vZHVsZSIsImV4cG9ydHMiXSwic291cmNlUm9vdCI6Ii9ob21lL2Jlcm5hcmRvL3Npc3RlbWEtYXRlbmRpbWVudG8tdGkvQVROVEkvc3JjL3JvdXRlcy8iLCJzb3VyY2VzIjpbInN0YXR1c1JvdXRlcy5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBleHByZXNzID0gcmVxdWlyZSgnZXhwcmVzcycpO1xuY29uc3Qgcm91dGVyID0gZXhwcmVzcy5Sb3V0ZXIoeyBtZXJnZVBhcmFtczogdHJ1ZSB9KTtcblxuY29uc3QgU3RhdHVzQ29udHJvbGxlciA9IHJlcXVpcmUoJy4uL2NvbnRyb2xsZXJzL3N0YXR1c0NvbnRyb2xsZXInKTtcbmNvbnN0IGF1dGVudGljYXJUb2tlbiA9IHJlcXVpcmUoJy4uL21pZGRsZXdhcmVzL2F1dGhNaWRkbGV3YXJlJyk7XG5jb25zdCB2YWxpZGFyUmVxdWlzaWNhbyA9IHJlcXVpcmUoJy4uL21pZGRsZXdhcmVzL3ZhbGlkYXJSZXF1aXNpY2FvJyk7XG5jb25zdCBzY2hlbWFTdGF0dXMgPSByZXF1aXJlKCcuLi92YWxpZGF0b3JzL3N0YXR1c1ZhbGlkYXRvcicpO1xuXG4vLyBDcmlhciBub3ZvIHN0YXR1cyBwYXJhIG8gY2hhbWFkb1xuLyoqXG4gKiBAc3dhZ2dlclxuICogL2NoYW1hZG9zL3tjaGFtYWRvX2lkfS9zdGF0dXM6XG4gKiAgIHBvc3Q6XG4gKiAgICAgc3VtbWFyeTogUmVnaXN0cmEgdW0gbm92byBzdGF0dXMgcGFyYSB1bSBjaGFtYWRvXG4gKiAgICAgdGFnczogW1N0YXR1c11cbiAqICAgICBzZWN1cml0eTpcbiAqICAgICAgIC0gYmVhcmVyQXV0aDogW11cbiAqICAgICBwYXJhbWV0ZXJzOlxuICogICAgICAgLSBuYW1lOiBjaGFtYWRvX2lkXG4gKiAgICAgICAgIGluOiBwYXRoXG4gKiAgICAgICAgIHJlcXVpcmVkOiB0cnVlXG4gKiAgICAgICAgIHNjaGVtYTpcbiAqICAgICAgICAgICB0eXBlOiBpbnRlZ2VyXG4gKiAgICAgcmVxdWVzdEJvZHk6XG4gKiAgICAgICByZXF1aXJlZDogdHJ1ZVxuICogICAgICAgY29udGVudDpcbiAqICAgICAgICAgYXBwbGljYXRpb24vanNvbjpcbiAqICAgICAgICAgICBzY2hlbWE6XG4gKiAgICAgICAgICAgICB0eXBlOiBvYmplY3RcbiAqICAgICAgICAgICAgIHJlcXVpcmVkOiBbc3RhdHVzLCBjb21lbnRhcmlvXVxuICogICAgICAgICAgICAgcHJvcGVydGllczpcbiAqICAgICAgICAgICAgICAgc3RhdHVzOlxuICogICAgICAgICAgICAgICAgIHR5cGU6IHN0cmluZ1xuICogICAgICAgICAgICAgICAgIGVudW06IFtlbSBhdGVuZGltZW50bywgcGF1c2FkbywgZmluYWxpemFkb11cbiAqICAgICAgICAgICAgICAgY29tZW50YXJpbzpcbiAqICAgICAgICAgICAgICAgICB0eXBlOiBzdHJpbmdcbiAqICAgICByZXNwb25zZXM6XG4gKiAgICAgICAyMDE6XG4gKiAgICAgICAgIGRlc2NyaXB0aW9uOiBTdGF0dXMgcmVnaXN0cmFkbyBjb20gc3VjZXNzb1xuICogICAgICAgNDAwOlxuICogICAgICAgICBkZXNjcmlwdGlvbjogQ2hhbWFkbyBqw6EgZmluYWxpemFkbyBvdSBkYWRvcyBpbnbDoWxpZG9zXG4gKi9cblxucm91dGVyLnBvc3QoJy8nLCBhdXRlbnRpY2FyVG9rZW4sIHZhbGlkYXJSZXF1aXNpY2FvKHNjaGVtYVN0YXR1cyksIFN0YXR1c0NvbnRyb2xsZXIuY3JlYXRlKTtcblxuLy8gTGlzdGFyIHRvZG9zIG9zIHN0YXR1cyBkZSB1bSBjaGFtYWRvXG5yb3V0ZXIuZ2V0KCcvJywgYXV0ZW50aWNhclRva2VuLCBTdGF0dXNDb250cm9sbGVyLmxpc3QpO1xuXG4vLyBPYnRlciBvIHN0YXR1cyBhdHVhbCBkbyBjaGFtYWRvXG5yb3V0ZXIuZ2V0KCcvYXR1YWwnLCBhdXRlbnRpY2FyVG9rZW4sIFN0YXR1c0NvbnRyb2xsZXIuZ2V0U3RhdHVzQXR1YWwpO1xuXG5tb2R1bGUuZXhwb3J0cyA9IHJvdXRlcjtcbiJdLCJtYXBwaW5ncyI6IkFBQUEsTUFBTUEsT0FBTyxHQUFHQyxPQUFPLENBQUMsU0FBUyxDQUFDO0FBQ2xDLE1BQU1DLE1BQU0sR0FBR0YsT0FBTyxDQUFDRyxNQUFNLENBQUM7RUFBRUMsV0FBVyxFQUFFO0FBQUssQ0FBQyxDQUFDO0FBRXBELE1BQU1DLGdCQUFnQixHQUFHSixPQUFPLENBQUMsaUNBQWlDLENBQUM7QUFDbkUsTUFBTUssZUFBZSxHQUFHTCxPQUFPLENBQUMsK0JBQStCLENBQUM7QUFDaEUsTUFBTU0saUJBQWlCLEdBQUdOLE9BQU8sQ0FBQyxrQ0FBa0MsQ0FBQztBQUNyRSxNQUFNTyxZQUFZLEdBQUdQLE9BQU8sQ0FBQywrQkFBK0IsQ0FBQzs7QUFFN0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUFDLE1BQU0sQ0FBQ08sSUFBSSxDQUFDLEdBQUcsRUFBRUgsZUFBZSxFQUFFQyxpQkFBaUIsQ0FBQ0MsWUFBWSxDQUFDLEVBQUVILGdCQUFnQixDQUFDSyxNQUFNLENBQUM7O0FBRTNGO0FBQ0FSLE1BQU0sQ0FBQ1MsR0FBRyxDQUFDLEdBQUcsRUFBRUwsZUFBZSxFQUFFRCxnQkFBZ0IsQ0FBQ08sSUFBSSxDQUFDOztBQUV2RDtBQUNBVixNQUFNLENBQUNTLEdBQUcsQ0FBQyxRQUFRLEVBQUVMLGVBQWUsRUFBRUQsZ0JBQWdCLENBQUNRLGNBQWMsQ0FBQztBQUV0RUMsTUFBTSxDQUFDQyxPQUFPLEdBQUdiLE1BQU0iLCJpZ25vcmVMaXN0IjpbXX0=","map":{"version":3,"names":["express","require","router","Router","mergeParams","StatusController","autenticarToken","validarRequisicao","schemaStatus","post","create","get","list","getStatusAtual","module","exports"],"sourceRoot":"/home/bernardo/sistema-atendimento-ti/ATNTI/src/routes/","sources":["statusRoutes.js"],"sourcesContent":["const express = require('express');\nconst router = express.Router({ mergeParams: true });\n\nconst StatusController = require('../controllers/statusController');\nconst autenticarToken = require('../middlewares/authMiddleware');\nconst validarRequisicao = require('../middlewares/validarRequisicao');\nconst schemaStatus = require('../validators/statusValidator');\n\n// Criar novo status para o chamado\n/**\n * @swagger\n * /chamados/{chamado_id}/status:\n *   post:\n *     summary: Registra um novo status para um chamado\n *     tags: [Status]\n *     security:\n *       - bearerAuth: []\n *     parameters:\n *       - name: chamado_id\n *         in: path\n *         required: true\n *         schema:\n *           type: integer\n *     requestBody:\n *       required: true\n *       content:\n *         application/json:\n *           schema:\n *             type: object\n *             required: [status, comentario]\n *             properties:\n *               status:\n *                 type: string\n *                 enum: [em atendimento, pausado, finalizado]\n *               comentario:\n *                 type: string\n *     responses:\n *       201:\n *         description: Status registrado com sucesso\n *       400:\n *         description: Chamado já finalizado ou dados inválidos\n */\n\nrouter.post('/', autenticarToken, validarRequisicao(schemaStatus), StatusController.create);\n\n// Listar todos os status de um chamado\nrouter.get('/', autenticarToken, StatusController.list);\n\n// Obter o status atual do chamado\nrouter.get('/atual', autenticarToken, StatusController.getStatusAtual);\n\nmodule.exports = router;\n"],"mappings":"AAAA,MAAMA,OAAO,GAAGC,OAAO,CAAC,SAAS,CAAC;AAClC,MAAMC,MAAM,GAAGF,OAAO,CAACG,MAAM,CAAC;EAAEC,WAAW,EAAE;AAAK,CAAC,CAAC;AAEpD,MAAMC,gBAAgB,GAAGJ,OAAO,CAAC,iCAAiC,CAAC;AACnE,MAAMK,eAAe,GAAGL,OAAO,CAAC,+BAA+B,CAAC;AAChE,MAAMM,iBAAiB,GAAGN,OAAO,CAAC,kCAAkC,CAAC;AACrE,MAAMO,YAAY,GAAGP,OAAO,CAAC,+BAA+B,CAAC;;AAE7D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEAC,MAAM,CAACO,IAAI,CAAC,GAAG,EAAEH,eAAe,EAAEC,iBAAiB,CAACC,YAAY,CAAC,EAAEH,gBAAgB,CAACK,MAAM,CAAC;;AAE3F;AACAR,MAAM,CAACS,GAAG,CAAC,GAAG,EAAEL,eAAe,EAAED,gBAAgB,CAACO,IAAI,CAAC;;AAEvD;AACAV,MAAM,CAACS,GAAG,CAAC,QAAQ,EAAEL,eAAe,EAAED,gBAAgB,CAACQ,cAAc,CAAC;AAEtEC,MAAM,CAACC,OAAO,GAAGb,MAAM","ignoreList":[]}},"mtime":1754576033491},"{\"assumptions\":{},\"sourceRoot\":\"/home/bernardo/sistema-atendimento-ti/ATNTI/src/controllers/\",\"caller\":{\"name\":\"@babel/register\"},\"cwd\":\"/home/bernardo/sistema-atendimento-ti/ATNTI\",\"filename\":\"/home/bernardo/sistema-atendimento-ti/ATNTI/src/controllers/statusController.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/home/bernardo/sistema-atendimento-ti/ATNTI\",\"rootMode\":\"root\",\"plugins\":[],\"presets\":[]}:7.28.0:development":{"value":{"code":"const StatusModel = require('../models/statusModel');\nconst NotificacaoModel = require('../models/notificacaoModel');\nconst StatusController = {\n  async create(req, res, next) {\n    try {\n      const {\n        chamado_id\n      } = req.params;\n      const {\n        status,\n        comentario\n      } = req.body;\n      const usuario_id = req.usuario.id;\n      const chamadoExiste = await StatusModel.verificarChamado(chamado_id);\n      if (!chamadoExiste) {\n        return res.status(404).json({\n          erro: 'Chamado não encontrado.'\n        });\n      }\n      const ultimoStatus = await StatusModel.getUltimoStatus(chamado_id);\n      if (ultimoStatus && ultimoStatus.status === 'finalizado') {\n        return res.status(400).json({\n          erro: 'Este chamado já está finalizado. Não é possível alterar o status.'\n        });\n      }\n      const novoStatus = await StatusModel.add({\n        chamado_id,\n        status,\n        comentario,\n        usuario_id\n      });\n      const chamado = await StatusModel.findChamadoById(chamado_id);\n      if (chamado) {\n        await NotificacaoModel.add({\n          usuario_id: chamado.usuario_id,\n          chamado_id: chamado.id,\n          mensagem: `O status do seu chamado \"${chamado.titulo}\" foi alterado para \"${status}\".`\n        });\n      }\n      res.status(201).json(novoStatus);\n    } catch (err) {\n      next(err);\n    }\n  },\n  async list(req, res, next) {\n    try {\n      const {\n        chamado_id\n      } = req.params;\n      const historico = await StatusModel.listByChamado(chamado_id);\n      res.json(historico);\n    } catch (err) {\n      next(err);\n    }\n  },\n  async getStatusAtual(req, res, next) {\n    try {\n      const {\n        chamado_id\n      } = req.params;\n      const status = await StatusModel.getUltimoStatus(chamado_id);\n      if (!status) {\n        return res.status(404).json({\n          erro: 'Chamado sem status registrado.'\n        });\n      }\n      res.json(status);\n    } catch (err) {\n      next(err);\n    }\n  }\n};\nmodule.exports = StatusController;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJTdGF0dXNNb2RlbCIsInJlcXVpcmUiLCJOb3RpZmljYWNhb01vZGVsIiwiU3RhdHVzQ29udHJvbGxlciIsImNyZWF0ZSIsInJlcSIsInJlcyIsIm5leHQiLCJjaGFtYWRvX2lkIiwicGFyYW1zIiwic3RhdHVzIiwiY29tZW50YXJpbyIsImJvZHkiLCJ1c3VhcmlvX2lkIiwidXN1YXJpbyIsImlkIiwiY2hhbWFkb0V4aXN0ZSIsInZlcmlmaWNhckNoYW1hZG8iLCJqc29uIiwiZXJybyIsInVsdGltb1N0YXR1cyIsImdldFVsdGltb1N0YXR1cyIsIm5vdm9TdGF0dXMiLCJhZGQiLCJjaGFtYWRvIiwiZmluZENoYW1hZG9CeUlkIiwibWVuc2FnZW0iLCJ0aXR1bG8iLCJlcnIiLCJsaXN0IiwiaGlzdG9yaWNvIiwibGlzdEJ5Q2hhbWFkbyIsImdldFN0YXR1c0F0dWFsIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJzb3VyY2VSb290IjoiL2hvbWUvYmVybmFyZG8vc2lzdGVtYS1hdGVuZGltZW50by10aS9BVE5USS9zcmMvY29udHJvbGxlcnMvIiwic291cmNlcyI6WyJzdGF0dXNDb250cm9sbGVyLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImNvbnN0IFN0YXR1c01vZGVsID0gcmVxdWlyZSgnLi4vbW9kZWxzL3N0YXR1c01vZGVsJyk7XG5jb25zdCBOb3RpZmljYWNhb01vZGVsID0gcmVxdWlyZSgnLi4vbW9kZWxzL25vdGlmaWNhY2FvTW9kZWwnKTtcblxuY29uc3QgU3RhdHVzQ29udHJvbGxlciA9IHtcbiAgYXN5bmMgY3JlYXRlKHJlcSwgcmVzLCBuZXh0KSB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHsgY2hhbWFkb19pZCB9ID0gcmVxLnBhcmFtcztcbiAgICAgIGNvbnN0IHsgc3RhdHVzLCBjb21lbnRhcmlvIH0gPSByZXEuYm9keTtcbiAgICAgIGNvbnN0IHVzdWFyaW9faWQgPSByZXEudXN1YXJpby5pZDtcblxuICAgICAgY29uc3QgY2hhbWFkb0V4aXN0ZSA9IGF3YWl0IFN0YXR1c01vZGVsLnZlcmlmaWNhckNoYW1hZG8oY2hhbWFkb19pZCk7XG4gICAgICBpZiAoIWNoYW1hZG9FeGlzdGUpIHtcbiAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDA0KS5qc29uKHsgZXJybzogJ0NoYW1hZG8gbsOjbyBlbmNvbnRyYWRvLicgfSk7XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IHVsdGltb1N0YXR1cyA9IGF3YWl0IFN0YXR1c01vZGVsLmdldFVsdGltb1N0YXR1cyhjaGFtYWRvX2lkKTtcbiAgICAgIGlmICh1bHRpbW9TdGF0dXMgJiYgdWx0aW1vU3RhdHVzLnN0YXR1cyA9PT0gJ2ZpbmFsaXphZG8nKSB7XG4gICAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuanNvbih7XG4gICAgICAgICAgZXJybzogJ0VzdGUgY2hhbWFkbyBqw6EgZXN0w6EgZmluYWxpemFkby4gTsOjbyDDqSBwb3Nzw612ZWwgYWx0ZXJhciBvIHN0YXR1cy4nXG4gICAgICAgIH0pO1xuICAgICAgfVxuXG4gICAgICBjb25zdCBub3ZvU3RhdHVzID0gYXdhaXQgU3RhdHVzTW9kZWwuYWRkKHtcbiAgICAgICAgY2hhbWFkb19pZCxcbiAgICAgICAgc3RhdHVzLFxuICAgICAgICBjb21lbnRhcmlvLFxuICAgICAgICB1c3VhcmlvX2lkXG4gICAgICB9KTtcbiAgICAgIFxuICAgICAgY29uc3QgY2hhbWFkbyA9IGF3YWl0IFN0YXR1c01vZGVsLmZpbmRDaGFtYWRvQnlJZChjaGFtYWRvX2lkKTtcbiAgICAgIGlmIChjaGFtYWRvKSB7XG4gICAgICAgIGF3YWl0IE5vdGlmaWNhY2FvTW9kZWwuYWRkKHtcbiAgICAgICAgICB1c3VhcmlvX2lkOiBjaGFtYWRvLnVzdWFyaW9faWQsXG4gICAgICAgICAgY2hhbWFkb19pZDogY2hhbWFkby5pZCxcbiAgICAgICAgICBtZW5zYWdlbTogYE8gc3RhdHVzIGRvIHNldSBjaGFtYWRvIFwiJHtjaGFtYWRvLnRpdHVsb31cIiBmb2kgYWx0ZXJhZG8gcGFyYSBcIiR7c3RhdHVzfVwiLmBcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgICBcbiAgICAgIHJlcy5zdGF0dXMoMjAxKS5qc29uKG5vdm9TdGF0dXMpO1xuICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgbmV4dChlcnIpO1xuICAgIH1cbiAgfSxcblxuICBhc3luYyBsaXN0KHJlcSwgcmVzLCBuZXh0KSB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHsgY2hhbWFkb19pZCB9ID0gcmVxLnBhcmFtcztcbiAgICAgIGNvbnN0IGhpc3RvcmljbyA9IGF3YWl0IFN0YXR1c01vZGVsLmxpc3RCeUNoYW1hZG8oY2hhbWFkb19pZCk7XG4gICAgICByZXMuanNvbihoaXN0b3JpY28pO1xuICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgbmV4dChlcnIpO1xuICAgIH1cbiAgfSxcblxuICBhc3luYyBnZXRTdGF0dXNBdHVhbChyZXEsIHJlcywgbmV4dCkge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCB7IGNoYW1hZG9faWQgfSA9IHJlcS5wYXJhbXM7XG4gICAgICBjb25zdCBzdGF0dXMgPSBhd2FpdCBTdGF0dXNNb2RlbC5nZXRVbHRpbW9TdGF0dXMoY2hhbWFkb19pZCk7XG4gICAgICBpZiAoIXN0YXR1cykge1xuICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDQpLmpzb24oeyBlcnJvOiAnQ2hhbWFkbyBzZW0gc3RhdHVzIHJlZ2lzdHJhZG8uJyB9KTtcbiAgICAgIH1cbiAgICAgIHJlcy5qc29uKHN0YXR1cyk7XG4gICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICBuZXh0KGVycik7XG4gICAgfVxuICB9XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IFN0YXR1c0NvbnRyb2xsZXI7Il0sIm1hcHBpbmdzIjoiQUFBQSxNQUFNQSxXQUFXLEdBQUdDLE9BQU8sQ0FBQyx1QkFBdUIsQ0FBQztBQUNwRCxNQUFNQyxnQkFBZ0IsR0FBR0QsT0FBTyxDQUFDLDRCQUE0QixDQUFDO0FBRTlELE1BQU1FLGdCQUFn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","map":{"version":3,"names":["StatusModel","require","NotificacaoModel","StatusController","create","req","res","next","chamado_id","params","status","comentario","body","usuario_id","usuario","id","chamadoExiste","verificarChamado","json","erro","ultimoStatus","getUltimoStatus","novoStatus","add","chamado","findChamadoById","mensagem","titulo","err","list","historico","listByChamado","getStatusAtual","module","exports"],"sourceRoot":"/home/bernardo/sistema-atendimento-ti/ATNTI/src/controllers/","sources":["statusController.js"],"sourcesContent":["const StatusModel = require('../models/statusModel');\nconst NotificacaoModel = require('../models/notificacaoModel');\n\nconst StatusController = {\n  async create(req, res, next) {\n    try {\n      const { chamado_id } = req.params;\n      const { status, comentario } = req.body;\n      const usuario_id = req.usuario.id;\n\n      const chamadoExiste = await StatusModel.verificarChamado(chamado_id);\n      if (!chamadoExiste) {\n        return res.status(404).json({ erro: 'Chamado não encontrado.' });\n      }\n\n      const ultimoStatus = await StatusModel.getUltimoStatus(chamado_id);\n      if (ultimoStatus && ultimoStatus.status === 'finalizado') {\n        return res.status(400).json({\n          erro: 'Este chamado já está finalizado. Não é possível alterar o status.'\n        });\n      }\n\n      const novoStatus = await StatusModel.add({\n        chamado_id,\n        status,\n        comentario,\n        usuario_id\n      });\n      \n      const chamado = await StatusModel.findChamadoById(chamado_id);\n      if (chamado) {\n        await NotificacaoModel.add({\n          usuario_id: chamado.usuario_id,\n          chamado_id: chamado.id,\n          mensagem: `O status do seu chamado \"${chamado.titulo}\" foi alterado para \"${status}\".`\n        });\n      }\n      \n      res.status(201).json(novoStatus);\n    } catch (err) {\n      next(err);\n    }\n  },\n\n  async list(req, res, next) {\n    try {\n      const { chamado_id } = req.params;\n      const historico = await StatusModel.listByChamado(chamado_id);\n      res.json(historico);\n    } catch (err) {\n      next(err);\n    }\n  },\n\n  async getStatusAtual(req, res, next) {\n    try {\n      const { chamado_id } = req.params;\n      const status = await StatusModel.getUltimoStatus(chamado_id);\n      if (!status) {\n        return res.status(404).json({ erro: 'Chamado sem status registrado.' });\n      }\n      res.json(status);\n    } catch (err) {\n      next(err);\n    }\n  }\n};\n\nmodule.exports = StatusController;"],"mappings":"AAAA,MAAMA,WAAW,GAAGC,OAAO,CAAC,uBAAuB,CAAC;AACpD,MAAMC,gBAAgB,GAAGD,OAAO,CAAC,4BAA4B,CAAC;AAE9D,MAAME,gBAAgB,GAAG;EACvB,MAAMC,MAAMA,CAACC,GAAG,EAAEC,GAAG,EAAEC,IAAI,EAAE;IAC3B,IAAI;MACF,MAAM;QAAEC;MAAW,CAAC,GAAGH,GAAG,CAACI,MAAM;MACjC,MAAM;QAAEC,MAAM;QAAEC;MAAW,CAAC,GAAGN,GAAG,CAACO,IAAI;MACvC,MAAMC,UAAU,GAAGR,GAAG,CAACS,OAAO,CAACC,EAAE;MAEjC,MAAMC,aAAa,GAAG,MAAMhB,WAAW,CAACiB,gBAAgB,CAACT,UAAU,CAAC;MACpE,IAAI,CAACQ,aAAa,EAAE;QAClB,OAAOV,GAAG,CAACI,MAAM,CAAC,GAAG,CAAC,CAACQ,IAAI,CAAC;UAAEC,IAAI,EAAE;QAA0B,CAAC,CAAC;MAClE;MAEA,MAAMC,YAAY,GAAG,MAAMpB,WAAW,CAACqB,eAAe,CAACb,UAAU,CAAC;MAClE,IAAIY,YAAY,IAAIA,YAAY,CAACV,MAAM,KAAK,YAAY,EAAE;QACxD,OAAOJ,GAAG,CAACI,MAAM,CAAC,GAAG,CAAC,CAACQ,IAAI,CAAC;UAC1BC,IAAI,EAAE;QACR,CAAC,CAAC;MACJ;MAEA,MAAMG,UAAU,GAAG,MAAMtB,WAAW,CAACuB,GAAG,CAAC;QACvCf,UAAU;QACVE,MAAM;QACNC,UAAU;QACVE;MACF,CAAC,CAAC;MAEF,MAAMW,OAAO,GAAG,MAAMxB,WAAW,CAACyB,eAAe,CAACjB,UAAU,CAAC;MAC7D,IAAIgB,OAAO,EAAE;QACX,MAAMtB,gBAAgB,CAACqB,GAAG,CAAC;UACzBV,UAAU,EAAEW,OAAO,CAACX,UAAU;UAC9BL,UAAU,EAAEgB,OAAO,CAACT,EAAE;UACtBW,QAAQ,EAAE,4BAA4BF,OAAO,CAACG,MAAM,wBAAwBjB,MAAM;QACpF,CAAC,CAAC;MACJ;MAEAJ,GAAG,CAACI,MAAM,CAAC,GAAG,CAAC,CAACQ,IAAI,CAACI,UAAU,CAAC;IAClC,CAAC,CAAC,OAAOM,GAAG,EAAE;MACZrB,IAAI,CAACqB,GAAG,CAAC;IACX;EACF,CAAC;EAED,MAAMC,IAAIA,CAACxB,GAAG,EAAEC,GAAG,EAAEC,IAAI,EAAE;IACzB,IAAI;MACF,MAAM;QAAEC;MAAW,CAAC,GAAGH,GAAG,CAACI,MAAM;MACjC,MAAMqB,SAAS,GAAG,MAAM9B,WAAW,CAAC+B,aAAa,CAACvB,UAAU,CAAC;MAC7DF,GAAG,CAACY,IAAI,CAACY,SAAS,CAAC;IACrB,CAAC,CAAC,OAAOF,GAAG,EAAE;MACZrB,IAAI,CAACqB,GAAG,CAAC;IACX;EACF,CAAC;EAED,MAAMI,cAAcA,CAAC3B,GAAG,EAAEC,GAAG,EAAEC,IAAI,EAAE;IACnC,IAAI;MACF,MAAM;QAAEC;MAAW,CAAC,GAAGH,GAAG,CAACI,MAAM;MACjC,MAAMC,MAAM,GAAG,MAAMV,WAAW,CAACqB,eAAe,CAACb,UAAU,CAAC;MAC5D,IAAI,CAACE,MAAM,EAAE;QACX,OAAOJ,GAAG,CAACI,MAAM,CAAC,GAAG,CAAC,CAACQ,IAAI,CAAC;UAAEC,IAAI,EAAE;QAAiC,CAAC,CAAC;MACzE;MACAb,GAAG,CAACY,IAAI,CAACR,MAAM,CAAC;IAClB,CAAC,CAAC,OAAOkB,GAAG,EAAE;MACZrB,IAAI,CAACqB,GAAG,CAAC;IACX;EACF;AACF,CAAC;AAEDK,MAAM,CAACC,OAAO,GAAG/B,gBAAgB","ignoreList":[]}},"mtime":1754590720801},"{\"assumptions\":{},\"sourceRoot\":\"/home/bernardo/sistema-atendimento-ti/ATNTI/src/models/\",\"caller\":{\"name\":\"@babel/register\"},\"cwd\":\"/home/bernardo/sistema-atendimento-ti/ATNTI\",\"filename\":\"/home/bernardo/sistema-atendimento-ti/ATNTI/src/models/statusModel.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/home/bernardo/sistema-atendimento-ti/ATNTI\",\"rootMode\":\"root\",\"plugins\":[],\"presets\":[]}:7.28.0:development":{"value":{"code":"const db = require('../config/db');\nconst StatusModel = {\n  async add({\n    chamado_id,\n    status,\n    comentario,\n    usuario_id\n  }) {\n    const query = `\n      INSERT INTO chamado_status (chamado_id, status, comentario, usuario_id)\n      VALUES ($1, $2, $3, $4)\n      RETURNING *\n    `;\n    const values = [chamado_id, status, comentario, usuario_id];\n    const result = await db.query(query, values);\n    return result.rows[0];\n  },\n  async listByChamado(chamado_id) {\n    const result = await db.query(`\n      SELECT s.*, u.nome AS nome_usuario\n      FROM chamado_status s\n      LEFT JOIN usuarios u ON u.id = s.usuario_id\n      WHERE chamado_id = $1\n      ORDER BY data_hora ASC\n    `, [chamado_id]);\n    return result.rows;\n  },\n  async getUltimoStatus(chamado_id) {\n    const result = await db.query(`\n      SELECT s.*, u.nome AS nome_usuario\n      FROM chamado_status s\n      LEFT JOIN usuarios u ON u.id = s.usuario_id\n      WHERE chamado_id = $1\n      ORDER BY data_hora DESC\n      LIMIT 1\n    `, [chamado_id]);\n    return result.rows[0];\n  },\n  async verificarChamado(chamado_id) {\n    const result = await db.query(`\n      SELECT 1 FROM chamados WHERE id = $1\n    `, [chamado_id]);\n    return result.rowCount > 0;\n  },\n  // NOVO: Método para buscar um chamado por ID\n  async findChamadoById(chamado_id) {\n    const result = await db.query(`\n      SELECT * FROM chamados WHERE id = $1\n    `, [chamado_id]);\n    return result.rows[0];\n  }\n};\nmodule.exports = StatusModel;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJkYiIsInJlcXVpcmUiLCJTdGF0dXNNb2RlbCIsImFkZCIsImNoYW1hZG9faWQiLCJzdGF0dXMiLCJjb21lbnRhcmlvIiwidXN1YXJpb19pZCIsInF1ZXJ5IiwidmFsdWVzIiwicmVzdWx0Iiwicm93cyIsImxpc3RCeUNoYW1hZG8iLCJnZXRVbHRpbW9TdGF0dXMiLCJ2ZXJpZmljYXJDaGFtYWRvIiwicm93Q291bnQiLCJmaW5kQ2hhbWFkb0J5SWQiLCJtb2R1bGUiLCJleHBvcnRzIl0sInNvdXJjZVJvb3QiOiIvaG9tZS9iZXJuYXJkby9zaXN0ZW1hLWF0ZW5kaW1lbnRvLXRpL0FUTlRJL3NyYy9tb2RlbHMvIiwic291cmNlcyI6WyJzdGF0dXNNb2RlbC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBkYiA9IHJlcXVpcmUoJy4uL2NvbmZpZy9kYicpO1xuXG5jb25zdCBTdGF0dXNNb2RlbCA9IHtcbiAgYXN5bmMgYWRkKHsgY2hhbWFkb19pZCwgc3RhdHVzLCBjb21lbnRhcmlvLCB1c3VhcmlvX2lkIH0pIHtcbiAgICBjb25zdCBxdWVyeSA9IGBcbiAgICAgIElOU0VSVCBJTlRPIGNoYW1hZG9fc3RhdHVzIChjaGFtYWRvX2lkLCBzdGF0dXMsIGNvbWVudGFyaW8sIHVzdWFyaW9faWQpXG4gICAgICBWQUxVRVMgKCQxLCAkMiwgJDMsICQ0KVxuICAgICAgUkVUVVJOSU5HICpcbiAgICBgO1xuICAgIGNvbnN0IHZhbHVlcyA9IFtjaGFtYWRvX2lkLCBzdGF0dXMsIGNvbWVudGFyaW8sIHVzdWFyaW9faWRdO1xuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGRiLnF1ZXJ5KHF1ZXJ5LCB2YWx1ZXMpO1xuICAgIHJldHVybiByZXN1bHQucm93c1swXTtcbiAgfSxcblxuICBhc3luYyBsaXN0QnlDaGFtYWRvKGNoYW1hZG9faWQpIHtcbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBkYi5xdWVyeShgXG4gICAgICBTRUxFQ1Qgcy4qLCB1Lm5vbWUgQVMgbm9tZV91c3VhcmlvXG4gICAgICBGUk9NIGNoYW1hZG9fc3RhdHVzIHNcbiAgICAgIExFRlQgSk9JTiB1c3VhcmlvcyB1IE9OIHUuaWQgPSBzLnVzdWFyaW9faWRcbiAgICAgIFdIRVJFIGNoYW1hZG9faWQgPSAkMVxuICAgICAgT1JERVIgQlkgZGF0YV9ob3JhIEFTQ1xuICAgIGAsIFtjaGFtYWRvX2lkXSk7XG4gICAgcmV0dXJuIHJlc3VsdC5yb3dzO1xuICB9LFxuXG4gIGFzeW5jIGdldFVsdGltb1N0YXR1cyhjaGFtYWRvX2lkKSB7XG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZGIucXVlcnkoYFxuICAgICAgU0VMRUNUIHMuKiwgdS5ub21lIEFTIG5vbWVfdXN1YXJpb1xuICAgICAgRlJPTSBjaGFtYWRvX3N0YXR1cyBzXG4gICAgICBMRUZUIEpPSU4gdXN1YXJpb3MgdSBPTiB1LmlkID0gcy51c3VhcmlvX2lkXG4gICAgICBXSEVSRSBjaGFtYWRvX2lkID0gJDFcbiAgICAgIE9SREVSIEJZIGRhdGFfaG9yYSBERVNDXG4gICAgICBMSU1JVCAxXG4gICAgYCwgW2NoYW1hZG9faWRdKTtcbiAgICByZXR1cm4gcmVzdWx0LnJvd3NbMF07XG4gIH0sXG5cbiAgYXN5bmMgdmVyaWZpY2FyQ2hhbWFkbyhjaGFtYWRvX2lkKSB7XG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZGIucXVlcnkoYFxuICAgICAgU0VMRUNUIDEgRlJPTSBjaGFtYWRvcyBXSEVSRSBpZCA9ICQxXG4gICAgYCwgW2NoYW1hZG9faWRdKTtcbiAgICByZXR1cm4gcmVzdWx0LnJvd0NvdW50ID4gMDtcbiAgfSxcbiAgXG4gIC8vIE5PVk86IE3DqXRvZG8gcGFyYSBidXNjYXIgdW0gY2hhbWFkbyBwb3IgSURcbiAgYXN5bmMgZmluZENoYW1hZG9CeUlkKGNoYW1hZG9faWQpIHtcbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBkYi5xdWVyeShgXG4gICAgICBTRUxFQ1QgKiBGUk9NIGNoYW1hZG9zIFdIRVJFIGlkID0gJDFcbiAgICBgLCBbY2hhbWFkb19pZF0pO1xuICAgIHJldHVybiByZXN1bHQucm93c1swXTtcbiAgfVxufTtcblxubW9kdWxlLmV4cG9ydHMgPSBTdGF0dXNNb2RlbDsiXSwibWFwcGluZ3MiOiJBQUFBLE1BQU1BLEVBQUUsR0FBR0MsT0FBTyxDQUFDLGNBQWMsQ0FBQztBQUVsQyxNQUFNQyxXQUFXLEdBQUc7RUFDbEIsTUFBTUMsR0FBR0EsQ0FBQztJQUFFQyxVQUFVO0lBQUVDLE1BQU07SUFBRUMsVUFBVTtJQUFFQztFQUFXLENBQUMsRUFBRTtJQUN4RCxNQUFNQyxLQUFLLEdBQUc7QUFDbEI7QUFDQTtBQUNBO0FBQ0EsS0FBSztJQUNELE1BQU1DLE1BQU0sR0FBRyxDQUFDTCxVQUFVLEVBQUVDLE1BQU0sRUFBRUMsVUFBVSxFQUFFQyxVQUFVLENBQUM7SUFDM0QsTUFBTUcsTUFBTSxHQUFHLE1BQU1WLEVBQUUsQ0FBQ1EsS0FBSyxDQUFDQSxLQUFLLEVBQUVDLE1BQU0sQ0FBQztJQUM1QyxPQUFPQyxNQUFNLENBQUNDLElBQUksQ0FBQyxDQUFDLENBQUM7RUFDdkIsQ0FBQztFQUVELE1BQU1DLGFBQWFBLENBQUNSLFVBQVUsRUFBRTtJQUM5QixNQUFNTSxNQUFNLEdBQUcsTUFBTVYsRUFBRSxDQUFDUSxLQUFLLENBQUM7QUFDbEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUssRUFBRSxDQUFDSixVQUFVLENBQUMsQ0FBQztJQUNoQixPQUFPTSxNQUFNLENBQUNDLElBQUk7RUFDcEIsQ0FBQztFQUVELE1BQU1FLGVBQWVBLENBQUNULFVBQVUsRUFBRTtJQUNoQyxNQUFNTSxNQUFNLEdBQUcsTUFBTVYsRUFBRSxDQUFDUSxLQUFLLENBQUM7QUFDbEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSyxFQUFFLENBQUNKLFVBQVUsQ0FBQyxDQUFDO0lBQ2hCLE9BQU9NLE1BQU0sQ0FBQ0MsSUFBSSxDQUFDLENBQUMsQ0FBQztFQUN2QixDQUFDO0VBRUQsTUFBTUcsZ0JBQWdCQSxDQUFDVixVQUFVLEVBQUU7SUFDakMsTUFBTU0sTUFBTSxHQUFHLE1BQU1WLEVBQUUsQ0FBQ1EsS0FBSyxDQUFDO0FBQ2xDO0FBQ0EsS0FBSyxFQUFFLENBQUNKLFVBQVUsQ0FBQyxDQUFDO0lBQ2hCLE9BQU9NLE1BQU0sQ0FBQ0ssUUFBUSxHQUFHLENBQUM7RUFDNUIsQ0FBQztFQUVEO0VBQ0EsTUFBTUMsZUFBZUEsQ0FBQ1osVUFBVSxFQUFFO0lBQ2hDLE1BQU1NLE1BQU0sR0FBRyxNQUFNVixFQUFFLENBQUNRLEtBQUssQ0FBQztBQUNsQztBQUNBLEtBQUssRUFBRSxDQUFDSixVQUFVLENBQUMsQ0FBQztJQUNoQixPQUFPTSxNQUFNLENBQUNDLElBQUksQ0FBQyxDQUFDLENBQUM7RUFDdkI7QUFDRixDQUFDO0FBRURNLE1BQU0sQ0FBQ0MsT0FBTyxHQUFHaEIsV0FBVyIsImlnbm9yZUxpc3QiOltdfQ==","map":{"version":3,"names":["db","require","StatusModel","add","chamado_id","status","comentario","usuario_id","query","values","result","rows","listByChamado","getUltimoStatus","verificarChamado","rowCount","findChamadoById","module","exports"],"sourceRoot":"/home/bernardo/sistema-atendimento-ti/ATNTI/src/models/","sources":["statusModel.js"],"sourcesContent":["const db = require('../config/db');\n\nconst StatusModel = {\n  async add({ chamado_id, status, comentario, usuario_id }) {\n    const query = `\n      INSERT INTO chamado_status (chamado_id, status, comentario, usuario_id)\n      VALUES ($1, $2, $3, $4)\n      RETURNING *\n    `;\n    const values = [chamado_id, status, comentario, usuario_id];\n    const result = await db.query(query, values);\n    return result.rows[0];\n  },\n\n  async listByChamado(chamado_id) {\n    const result = await db.query(`\n      SELECT s.*, u.nome AS nome_usuario\n      FROM chamado_status s\n      LEFT JOIN usuarios u ON u.id = s.usuario_id\n      WHERE chamado_id = $1\n      ORDER BY data_hora ASC\n    `, [chamado_id]);\n    return result.rows;\n  },\n\n  async getUltimoStatus(chamado_id) {\n    const result = await db.query(`\n      SELECT s.*, u.nome AS nome_usuario\n      FROM chamado_status s\n      LEFT JOIN usuarios u ON u.id = s.usuario_id\n      WHERE chamado_id = $1\n      ORDER BY data_hora DESC\n      LIMIT 1\n    `, [chamado_id]);\n    return result.rows[0];\n  },\n\n  async verificarChamado(chamado_id) {\n    const result = await db.query(`\n      SELECT 1 FROM chamados WHERE id = $1\n    `, [chamado_id]);\n    return result.rowCount > 0;\n  },\n  \n  // NOVO: Método para buscar um chamado por ID\n  async findChamadoById(chamado_id) {\n    const result = await db.query(`\n      SELECT * FROM chamados WHERE id = $1\n    `, [chamado_id]);\n    return result.rows[0];\n  }\n};\n\nmodule.exports = StatusModel;"],"mappings":"AAAA,MAAMA,EAAE,GAAGC,OAAO,CAAC,cAAc,CAAC;AAElC,MAAMC,WAAW,GAAG;EAClB,MAAMC,GAAGA,CAAC;IAAEC,UAAU;IAAEC,MAAM;IAAEC,UAAU;IAAEC;EAAW,CAAC,EAAE;IACxD,MAAMC,KAAK,GAAG;AAClB;AACA;AACA;AACA,KAAK;IACD,MAAMC,MAAM,GAAG,CAACL,UAAU,EAAEC,MAAM,EAAEC,UAAU,EAAEC,UAAU,CAAC;IAC3D,MAAMG,MAAM,GAAG,MAAMV,EAAE,CAACQ,KAAK,CAACA,KAAK,EAAEC,MAAM,CAAC;IAC5C,OAAOC,MAAM,CAACC,IAAI,CAAC,CAAC,CAAC;EACvB,CAAC;EAED,MAAMC,aAAaA,CAACR,UAAU,EAAE;IAC9B,MAAMM,MAAM,GAAG,MAAMV,EAAE,CAACQ,KAAK,CAAC;AAClC;AACA;AACA;AACA;AACA;AACA,KAAK,EAAE,CAACJ,UAAU,CAAC,CAAC;IAChB,OAAOM,MAAM,CAACC,IAAI;EACpB,CAAC;EAED,MAAME,eAAeA,CAACT,UAAU,EAAE;IAChC,MAAMM,MAAM,GAAG,MAAMV,EAAE,CAACQ,KAAK,CAAC;AAClC;AACA;AACA;AACA;AACA;AACA;AACA,KAAK,EAAE,CAACJ,UAAU,CAAC,CAAC;IAChB,OAAOM,MAAM,CAACC,IAAI,CAAC,CAAC,CAAC;EACvB,CAAC;EAED,MAAMG,gBAAgBA,CAACV,UAAU,EAAE;IACjC,MAAMM,MAAM,GAAG,MAAMV,EAAE,CAACQ,KAAK,CAAC;AAClC;AACA,KAAK,EAAE,CAACJ,UAAU,CAAC,CAAC;IAChB,OAAOM,MAAM,CAACK,QAAQ,GAAG,CAAC;EAC5B,CAAC;EAED;EACA,MAAMC,eAAeA,CAACZ,UAAU,EAAE;IAChC,MAAMM,MAAM,GAAG,MAAMV,EAAE,CAACQ,KAAK,CAAC;AAClC;AACA,KAAK,EAAE,CAACJ,UAAU,CAAC,CAAC;IAChB,OAAOM,MAAM,CAACC,IAAI,CAAC,CAAC,CAAC;EACvB;AACF,CAAC;AAEDM,MAAM,CAACC,OAAO,GAAGhB,WAAW","ignoreList":[]}},"mtime":1754589746272},"{\"assumptions\":{},\"sourceRoot\":\"/home/bernardo/sistema-atendimento-ti/ATNTI/src/validators/\",\"caller\":{\"name\":\"@babel/register\"},\"cwd\":\"/home/bernardo/sistema-atendimento-ti/ATNTI\",\"filename\":\"/home/bernardo/sistema-atendimento-ti/ATNTI/src/validators/statusValidator.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/home/bernardo/sistema-atendimento-ti/ATNTI\",\"rootMode\":\"root\",\"plugins\":[],\"presets\":[]}:7.28.0:development":{"value":{"code":"const Joi = require(\"joi\");\nconst schemaStatus = Joi.object({\n  status: Joi.string().valid(\"em atendimento\", \"pausado\", \"finalizado\", \"comentario\") // Adicione \"comentario\" aqui\n  .required().messages({\n    \"any.only\": \"Status deve ser 'em atendimento', 'pausado', 'finalizado' ou 'comentario'.\"\n  }),\n  comentario: Joi.string().min(3).required(),\n  usuario_id: Joi.number().integer().required()\n});\nmodule.exports = schemaStatus;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJKb2kiLCJyZXF1aXJlIiwic2NoZW1hU3RhdHVzIiwib2JqZWN0Iiwic3RhdHVzIiwic3RyaW5nIiwidmFsaWQiLCJyZXF1aXJlZCIsIm1lc3NhZ2VzIiwiY29tZW50YXJpbyIsIm1pbiIsInVzdWFyaW9faWQiLCJudW1iZXIiLCJpbnRlZ2VyIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJzb3VyY2VSb290IjoiL2hvbWUvYmVybmFyZG8vc2lzdGVtYS1hdGVuZGltZW50by10aS9BVE5USS9zcmMvdmFsaWRhdG9ycy8iLCJzb3VyY2VzIjpbInN0YXR1c1ZhbGlkYXRvci5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBKb2kgPSByZXF1aXJlKFwiam9pXCIpO1xuXG5jb25zdCBzY2hlbWFTdGF0dXMgPSBKb2kub2JqZWN0KHtcbiAgc3RhdHVzOiBKb2kuc3RyaW5nKClcbiAgICAudmFsaWQoXCJlbSBhdGVuZGltZW50b1wiLCBcInBhdXNhZG9cIiwgXCJmaW5hbGl6YWRvXCIsIFwiY29tZW50YXJpb1wiKSAvLyBBZGljaW9uZSBcImNvbWVudGFyaW9cIiBhcXVpXG4gICAgLnJlcXVpcmVkKClcbiAgICAubWVzc2FnZXMoe1xuICAgICAgXCJhbnkub25seVwiOiBcIlN0YXR1cyBkZXZlIHNlciAnZW0gYXRlbmRpbWVudG8nLCAncGF1c2FkbycsICdmaW5hbGl6YWRvJyBvdSAnY29tZW50YXJpbycuXCJcbiAgICB9KSxcbiAgY29tZW50YXJpbzogSm9pLnN0cmluZygpLm1pbigzKS5yZXF1aXJlZCgpLFxuICB1c3VhcmlvX2lkOiBKb2kubnVtYmVyKCkuaW50ZWdlcigpLnJlcXVpcmVkKClcbn0pO1xuXG5tb2R1bGUuZXhwb3J0cyA9IHNjaGVtYVN0YXR1czsiXSwibWFwcGluZ3MiOiJBQUFBLE1BQU1BLEdBQUcsR0FBR0MsT0FBTyxDQUFDLEtBQUssQ0FBQztBQUUxQixNQUFNQyxZQUFZLEdBQUdGLEdBQUcsQ0FBQ0csTUFBTSxDQUFDO0VBQzlCQyxNQUFNLEVBQUVKLEdBQUcsQ0FBQ0ssTUFBTSxDQUFDLENBQUMsQ0FDakJDLEtBQUssQ0FBQyxnQkFBZ0IsRUFBRSxTQUFTLEVBQUUsWUFBWSxFQUFFLFlBQVksQ0FBQyxDQUFDO0VBQUEsQ0FDL0RDLFFBQVEsQ0FBQyxDQUFDLENBQ1ZDLFFBQVEsQ0FBQztJQUNSLFVBQVUsRUFBRTtFQUNkLENBQUMsQ0FBQztFQUNKQyxVQUFVLEVBQUVULEdBQUcsQ0FBQ0ssTUFBTSxDQUFDLENBQUMsQ0FBQ0ssR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDSCxRQUFRLENBQUMsQ0FBQztFQUMxQ0ksVUFBVSxFQUFFWCxHQUFHLENBQUNZLE1BQU0sQ0FBQyxDQUFDLENBQUNDLE9BQU8sQ0FBQyxDQUFDLENBQUNOLFFBQVEsQ0FBQztBQUM5QyxDQUFDLENBQUM7QUFFRk8sTUFBTSxDQUFDQyxPQUFPLEdBQUdiLFlBQVkiLCJpZ25vcmVMaXN0IjpbXX0=","map":{"version":3,"names":["Joi","require","schemaStatus","object","status","string","valid","required","messages","comentario","min","usuario_id","number","integer","module","exports"],"sourceRoot":"/home/bernardo/sistema-atendimento-ti/ATNTI/src/validators/","sources":["statusValidator.js"],"sourcesContent":["const Joi = require(\"joi\");\n\nconst schemaStatus = Joi.object({\n  status: Joi.string()\n    .valid(\"em atendimento\", \"pausado\", \"finalizado\", \"comentario\") // Adicione \"comentario\" aqui\n    .required()\n    .messages({\n      \"any.only\": \"Status deve ser 'em atendimento', 'pausado', 'finalizado' ou 'comentario'.\"\n    }),\n  comentario: Joi.string().min(3).required(),\n  usuario_id: Joi.number().integer().required()\n});\n\nmodule.exports = schemaStatus;"],"mappings":"AAAA,MAAMA,GAAG,GAAGC,OAAO,CAAC,KAAK,CAAC;AAE1B,MAAMC,YAAY,GAAGF,GAAG,CAACG,MAAM,CAAC;EAC9BC,MAAM,EAAEJ,GAAG,CAACK,MAAM,CAAC,CAAC,CACjBC,KAAK,CAAC,gBAAgB,EAAE,SAAS,EAAE,YAAY,EAAE,YAAY,CAAC,CAAC;EAAA,CAC/DC,QAAQ,CAAC,CAAC,CACVC,QAAQ,CAAC;IACR,UAAU,EAAE;EACd,CAAC,CAAC;EACJC,UAAU,EAAET,GAAG,CAACK,MAAM,CAAC,CAAC,CAACK,GAAG,CAAC,CAAC,CAAC,CAACH,QAAQ,CAAC,CAAC;EAC1CI,UAAU,EAAEX,GAAG,CAACY,MAAM,CAAC,CAAC,CAACC,OAAO,CAAC,CAAC,CAACN,QAAQ,CAAC;AAC9C,CAAC,CAAC;AAEFO,MAAM,CAACC,OAAO,GAAGb,YAAY","ignoreList":[]}},"mtime":1754585154689},"{\"assumptions\":{},\"sourceRoot\":\"/home/bernardo/sistema-atendimento-ti/ATNTI/src/routes/\",\"caller\":{\"name\":\"@babel/register\"},\"cwd\":\"/home/bernardo/sistema-atendimento-ti/ATNTI\",\"filename\":\"/home/bernardo/sistema-atendimento-ti/ATNTI/src/routes/anexoRoutes.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/home/bernardo/sistema-atendimento-ti/ATNTI\",\"rootMode\":\"root\",\"plugins\":[],\"presets\":[]}:7.28.0:development":{"value":{"code":"const express = require('express');\nconst router = express.Router({\n  mergeParams: true\n});\nconst AnexoController = require('../controllers/anexoController');\nconst autenticarToken = require('../middlewares/authMiddleware');\nconst upload = require('../config/multer');\nrouter.post('/', autenticarToken, upload.single('anexo'),\n// Middleware do multer para um único arquivo\nAnexoController.upload);\nrouter.get('/', autenticarToken, AnexoController.list);\nrouter.get('/:id/download', autenticarToken, AnexoController.download);\nmodule.exports = router;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJleHByZXNzIiwicmVxdWlyZSIsInJvdXRlciIsIlJvdXRlciIsIm1lcmdlUGFyYW1zIiwiQW5leG9Db250cm9sbGVyIiwiYXV0ZW50aWNhclRva2VuIiwidXBsb2FkIiwicG9zdCIsInNpbmdsZSIsImdldCIsImxpc3QiLCJkb3dubG9hZCIsIm1vZHVsZSIsImV4cG9ydHMiXSwic291cmNlUm9vdCI6Ii9ob21lL2Jlcm5hcmRvL3Npc3RlbWEtYXRlbmRpbWVudG8tdGkvQVROVEkvc3JjL3JvdXRlcy8iLCJzb3VyY2VzIjpbImFuZXhvUm91dGVzLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImNvbnN0IGV4cHJlc3MgPSByZXF1aXJlKCdleHByZXNzJyk7XG5jb25zdCByb3V0ZXIgPSBleHByZXNzLlJvdXRlcih7IG1lcmdlUGFyYW1zOiB0cnVlIH0pO1xuXG5jb25zdCBBbmV4b0NvbnRyb2xsZXIgPSByZXF1aXJlKCcuLi9jb250cm9sbGVycy9hbmV4b0NvbnRyb2xsZXInKTtcbmNvbnN0IGF1dGVudGljYXJUb2tlbiA9IHJlcXVpcmUoJy4uL21pZGRsZXdhcmVzL2F1dGhNaWRkbGV3YXJlJyk7XG5jb25zdCB1cGxvYWQgPSByZXF1aXJlKCcuLi9jb25maWcvbXVsdGVyJyk7XG5cbnJvdXRlci5wb3N0KFxuICAnLycsXG4gIGF1dGVudGljYXJUb2tlbixcbiAgdXBsb2FkLnNpbmdsZSgnYW5leG8nKSwgLy8gTWlkZGxld2FyZSBkbyBtdWx0ZXIgcGFyYSB1bSDDum5pY28gYXJxdWl2b1xuICBBbmV4b0NvbnRyb2xsZXIudXBsb2FkXG4pO1xuXG5yb3V0ZXIuZ2V0KCcvJywgYXV0ZW50aWNhclRva2VuLCBBbmV4b0NvbnRyb2xsZXIubGlzdCk7XG5cbnJvdXRlci5nZXQoJy86aWQvZG93bmxvYWQnLCBhdXRlbnRpY2FyVG9rZW4sIEFuZXhvQ29udHJvbGxlci5kb3dubG9hZCk7XG5cbm1vZHVsZS5leHBvcnRzID0gcm91dGVyOyJdLCJtYXBwaW5ncyI6IkFBQUEsTUFBTUEsT0FBTyxHQUFHQyxPQUFPLENBQUMsU0FBUyxDQUFDO0FBQ2xDLE1BQU1DLE1BQU0sR0FBR0YsT0FBTyxDQUFDRyxNQUFNLENBQUM7RUFBRUMsV0FBVyxFQUFFO0FBQUssQ0FBQyxDQUFDO0FBRXBELE1BQU1DLGVBQWUsR0FBR0osT0FBTyxDQUFDLGdDQUFnQyxDQUFDO0FBQ2pFLE1BQU1LLGVBQWUsR0FBR0wsT0FBTyxDQUFDLCtCQUErQixDQUFDO0FBQ2hFLE1BQU1NLE1BQU0sR0FBR04sT0FBTyxDQUFDLGtCQUFrQixDQUFDO0FBRTFDQyxNQUFNLENBQUNNLElBQUksQ0FDVCxHQUFHLEVBQ0hGLGVBQWUsRUFDZkMsTUFBTSxDQUFDRSxNQUFNLENBQUMsT0FBTyxDQUFDO0FBQUU7QUFDeEJKLGVBQWUsQ0FBQ0UsTUFDbEIsQ0FBQztBQUVETCxNQUFNLENBQUNRLEdBQUcsQ0FBQyxHQUFHLEVBQUVKLGVBQWUsRUFBRUQsZUFBZSxDQUFDTSxJQUFJLENBQUM7QUFFdERULE1BQU0sQ0FBQ1EsR0FBRyxDQUFDLGVBQWUsRUFBRUosZUFBZSxFQUFFRCxlQUFlLENBQUNPLFFBQVEsQ0FBQztBQUV0RUMsTUFBTSxDQUFDQyxPQUFPLEdBQUdaLE1BQU0iLCJpZ25vcmVMaXN0IjpbXX0=","map":{"version":3,"names":["express","require","router","Router","mergeParams","AnexoController","autenticarToken","upload","post","single","get","list","download","module","exports"],"sourceRoot":"/home/bernardo/sistema-atendimento-ti/ATNTI/src/routes/","sources":["anexoRoutes.js"],"sourcesContent":["const express = require('express');\nconst router = express.Router({ mergeParams: true });\n\nconst AnexoController = require('../controllers/anexoController');\nconst autenticarToken = require('../middlewares/authMiddleware');\nconst upload = require('../config/multer');\n\nrouter.post(\n  '/',\n  autenticarToken,\n  upload.single('anexo'), // Middleware do multer para um único arquivo\n  AnexoController.upload\n);\n\nrouter.get('/', autenticarToken, AnexoController.list);\n\nrouter.get('/:id/download', autenticarToken, AnexoController.download);\n\nmodule.exports = router;"],"mappings":"AAAA,MAAMA,OAAO,GAAGC,OAAO,CAAC,SAAS,CAAC;AAClC,MAAMC,MAAM,GAAGF,OAAO,CAACG,MAAM,CAAC;EAAEC,WAAW,EAAE;AAAK,CAAC,CAAC;AAEpD,MAAMC,eAAe,GAAGJ,OAAO,CAAC,gCAAgC,CAAC;AACjE,MAAMK,eAAe,GAAGL,OAAO,CAAC,+BAA+B,CAAC;AAChE,MAAMM,MAAM,GAAGN,OAAO,CAAC,kBAAkB,CAAC;AAE1CC,MAAM,CAACM,IAAI,CACT,GAAG,EACHF,eAAe,EACfC,MAAM,CAACE,MAAM,CAAC,OAAO,CAAC;AAAE;AACxBJ,eAAe,CAACE,MAClB,CAAC;AAEDL,MAAM,CAACQ,GAAG,CAAC,GAAG,EAAEJ,eAAe,EAAED,eAAe,CAACM,IAAI,CAAC;AAEtDT,MAAM,CAACQ,GAAG,CAAC,eAAe,EAAEJ,eAAe,EAAED,eAAe,CAACO,QAAQ,CAAC;AAEtEC,MAAM,CAACC,OAAO,GAAGZ,MAAM","ignoreList":[]}},"mtime":1754586684855},"{\"assumptions\":{},\"sourceRoot\":\"/home/bernardo/sistema-atendimento-ti/ATNTI/src/controllers/\",\"caller\":{\"name\":\"@babel/register\"},\"cwd\":\"/home/bernardo/sistema-atendimento-ti/ATNTI\",\"filename\":\"/home/bernardo/sistema-atendimento-ti/ATNTI/src/controllers/anexoController.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/home/bernardo/sistema-atendimento-ti/ATNTI\",\"rootMode\":\"root\",\"plugins\":[],\"presets\":[]}:7.28.0:development":{"value":{"code":"const AnexoModel = require('../models/anexoModel');\nconst path = require('path');\nconst fs = require('fs');\nconst AnexoController = {\n  async upload(req, res, next) {\n    try {\n      const {\n        chamado_id\n      } = req.params;\n      if (!req.file) {\n        return res.status(400).json({\n          erro: 'Nenhum arquivo foi enviado.'\n        });\n      }\n      const {\n        filename,\n        originalname,\n        size,\n        path: filePath\n      } = req.file;\n      const usuario_id = req.usuario.id;\n      const anexo = await AnexoModel.add(chamado_id, originalname, filePath, size, usuario_id);\n      res.status(201).json({\n        mensagem: 'Anexo adicionado com sucesso',\n        anexo\n      });\n    } catch (err) {\n      next(err);\n    }\n  },\n  async list(req, res, next) {\n    try {\n      const {\n        chamado_id\n      } = req.params;\n      const anexos = await AnexoModel.findByChamado(chamado_id);\n      res.json(anexos);\n    } catch (err) {\n      next(err);\n    }\n  },\n  async download(req, res, next) {\n    try {\n      const anexo = await AnexoModel.findById(req.params.id);\n      if (!anexo) {\n        return res.status(404).json({\n          erro: 'Anexo não encontrado'\n        });\n      }\n      const filePath = path.resolve(anexo.caminho);\n      res.download(filePath, anexo.nome_arquivo, err => {\n        if (err) {\n          next(err);\n        }\n      });\n    } catch (err) {\n      next(err);\n    }\n  }\n};\nmodule.exports = AnexoController;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJBbmV4b01vZGVsIiwicmVxdWlyZSIsInBhdGgiLCJmcyIsIkFuZXhvQ29udHJvbGxlciIsInVwbG9hZCIsInJlcSIsInJlcyIsIm5leHQiLCJjaGFtYWRvX2lkIiwicGFyYW1zIiwiZmlsZSIsInN0YXR1cyIsImpzb24iLCJlcnJvIiwiZmlsZW5hbWUiLCJvcmlnaW5hbG5hbWUiLCJzaXplIiwiZmlsZVBhdGgiLCJ1c3VhcmlvX2lkIiwidXN1YXJpbyIsImlkIiwiYW5leG8iLCJhZGQiLCJtZW5zYWdlbSIsImVyciIsImxpc3QiLCJhbmV4b3MiLCJmaW5kQnlDaGFtYWRvIiwiZG93bmxvYWQiLCJmaW5kQnlJZCIsInJlc29sdmUiLCJjYW1pbmhvIiwibm9tZV9hcnF1aXZvIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJzb3VyY2VSb290IjoiL2hvbWUvYmVybmFyZG8vc2lzdGVtYS1hdGVuZGltZW50by10aS9BVE5USS9zcmMvY29udHJvbGxlcnMvIiwic291cmNlcyI6WyJhbmV4b0NvbnRyb2xsZXIuanMiXSwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgQW5leG9Nb2RlbCA9IHJlcXVpcmUoJy4uL21vZGVscy9hbmV4b01vZGVsJyk7XG5jb25zdCBwYXRoICAgICAgID0gcmVxdWlyZSgncGF0aCcpO1xuY29uc3QgZnMgICAgICAgICA9IHJlcXVpcmUoJ2ZzJyk7XG5cbmNvbnN0IEFuZXhvQ29udHJvbGxlciA9IHtcbiAgYXN5bmMgdXBsb2FkKHJlcSwgcmVzLCBuZXh0KSB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHsgY2hhbWFkb19pZCB9ID0gcmVxLnBhcmFtcztcbiAgICAgIFxuICAgICAgaWYgKCFyZXEuZmlsZSkge1xuICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLmpzb24oeyBlcnJvOiAnTmVuaHVtIGFycXVpdm8gZm9pIGVudmlhZG8uJyB9KTtcbiAgICAgIH1cblxuICAgICAgY29uc3QgeyBmaWxlbmFtZSwgb3JpZ2luYWxuYW1lLCBzaXplLCBwYXRoOiBmaWxlUGF0aCB9ID0gcmVxLmZpbGU7XG4gICAgICBjb25zdCB1c3VhcmlvX2lkID0gcmVxLnVzdWFyaW8uaWQ7XG5cbiAgICAgIGNvbnN0IGFuZXhvID0gYXdhaXQgQW5leG9Nb2RlbC5hZGQoXG4gICAgICAgIGNoYW1hZG9faWQsXG4gICAgICAgIG9yaWdpbmFsbmFtZSxcbiAgICAgICAgZmlsZVBhdGgsXG4gICAgICAgIHNpemUsXG4gICAgICAgIHVzdWFyaW9faWRcbiAgICAgICk7XG5cbiAgICAgIHJlcy5zdGF0dXMoMjAxKS5qc29uKHtcbiAgICAgICAgbWVuc2FnZW06ICdBbmV4byBhZGljaW9uYWRvIGNvbSBzdWNlc3NvJyxcbiAgICAgICAgYW5leG9cbiAgICAgIH0pO1xuICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgbmV4dChlcnIpO1xuICAgIH1cbiAgfSxcblxuICBhc3luYyBsaXN0KHJlcSwgcmVzLCBuZXh0KSB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHsgY2hhbWFkb19pZCB9ID0gcmVxLnBhcmFtcztcbiAgICAgIGNvbnN0IGFuZXhvcyA9IGF3YWl0IEFuZXhvTW9kZWwuZmluZEJ5Q2hhbWFkbyhjaGFtYWRvX2lkKTtcbiAgICAgIHJlcy5qc29uKGFuZXhvcyk7XG4gICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICBuZXh0KGVycik7XG4gICAgfVxuICB9LFxuXG4gIGFzeW5jIGRvd25sb2FkKHJlcSwgcmVzLCBuZXh0KSB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IGFuZXhvID0gYXdhaXQgQW5leG9Nb2RlbC5maW5kQnlJZChyZXEucGFyYW1zLmlkKTtcbiAgICAgIGlmICghYW5leG8pIHtcbiAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDA0KS5qc29uKHsgZXJybzogJ0FuZXhvIG7Do28gZW5jb250cmFkbycgfSk7XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IGZpbGVQYXRoID0gcGF0aC5yZXNvbHZlKGFuZXhvLmNhbWluaG8pO1xuICAgICAgcmVzLmRvd25sb2FkKGZpbGVQYXRoLCBhbmV4by5ub21lX2FycXVpdm8sIChlcnIpID0+IHtcbiAgICAgICAgaWYgKGVycikge1xuICAgICAgICAgIG5leHQoZXJyKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICBuZXh0KGVycik7XG4gICAgfVxuICB9XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IEFuZXhvQ29udHJvbGxlcjsiXSwibWFwcGluZ3MiOiJBQUFBLE1BQU1BLFVBQVUsR0FBR0MsT0FBTyxDQUFDLHNCQUFzQixDQUFDO0FBQ2xELE1BQU1DLElBQUksR0FBU0QsT0FBTyxDQUFDLE1BQU0sQ0FBQztBQUNsQyxNQUFNRSxFQUFFLEdBQVdGLE9BQU8sQ0FBQyxJQUFJLENBQUM7QUFFaEMsTUFBTUcsZUFBZSxHQUFHO0VBQ3RCLE1BQU1DLE1BQU1BLENBQUNDLEdBQUcsRUFBRUMsR0FBRyxFQUFFQyxJQUFJLEVBQUU7SUFDM0IsSUFBSTtNQUNGLE1BQU07UUFBRUM7TUFBVyxDQUFDLEdBQUdILEdBQUcsQ0FBQ0ksTUFBTTtNQUVqQyxJQUFJLENBQUNKLEdBQUcsQ0FBQ0ssSUFBSSxFQUFFO1FBQ2IsT0FBT0osR0FBRyxDQUFDSyxNQUFNLENBQUMsR0FBRyxDQUFDLENBQUNDLElBQUksQ0FBQztVQUFFQyxJQUFJLEVBQUU7UUFBOEIsQ0FBQyxDQUFDO01BQ3RFO01BRUEsTUFBTTtRQUFFQyxRQUFRO1FBQUVDLFlBQVk7UUFBRUMsSUFBSTtRQUFFZixJQUFJLEVBQUVnQjtNQUFTLENBQUMsR0FBR1osR0FBRyxDQUFDSyxJQUFJO01BQ2pFLE1BQU1RLFVBQVUsR0FBR2IsR0FBRyxDQUFDYyxPQUFPLENBQUNDLEVBQUU7TUFFakMsTUFBTUMsS0FBSyxHQUFHLE1BQU10QixVQUFVLENBQUN1QixHQUFHLENBQ2hDZCxVQUFVLEVBQ1ZPLFlBQVksRUFDWkUsUUFBUSxFQUNSRCxJQUFJLEVBQ0pFLFVBQ0YsQ0FBQztNQUVEWixHQUFHLENBQUNLLE1BQU0sQ0FBQyxHQUFHLENBQUMsQ0FBQ0MsSUFBSSxDQUFDO1FBQ25CVyxRQUFRLEVBQUUsOEJBQThCO1FBQ3hDRjtNQUNGLENBQUMsQ0FBQztJQUNKLENBQUMsQ0FBQyxPQUFPRyxHQUFHLEVBQUU7TUFDWmpCLElBQUksQ0FBQ2lCLEdBQUcsQ0FBQztJQUNYO0VBQ0YsQ0FBQztFQUVELE1BQU1DLElBQUlBLENBQUNwQixHQUFHLEVBQUVDLEdBQUcsRUFBRUMsSUFBSSxFQUFFO0lBQ3pCLElBQUk7TUFDRixNQUFNO1FBQUVDO01BQVcsQ0FBQyxHQUFHSCxHQUFHLENBQUNJLE1BQU07TUFDakMsTUFBTWlCLE1BQU0sR0FBRyxNQUFNM0IsVUFBVSxDQUFDNEIsYUFBYSxDQUFDbkIsVUFBVSxDQUFDO01BQ3pERixHQUFHLENBQUNNLElBQUksQ0FBQ2MsTUFBTSxDQUFDO0lBQ2xCLENBQUMsQ0FBQyxPQUFPRixHQUFHLEVBQUU7TUFDWmpCLElBQUksQ0FBQ2lCLEdBQUcsQ0FBQztJQUNYO0VBQ0YsQ0FBQztFQUVELE1BQU1JLFFBQVFBLENBQUN2QixHQUFHLEVBQUVDLEdBQUcsRUFBRUMsSUFBSSxFQUFFO0lBQzdCLElBQUk7TUFDRixNQUFNYyxLQUFLLEdBQUcsTUFBTXRCLFVBQVUsQ0FBQzhCLFFBQVEsQ0FBQ3hCLEdBQUcsQ0FBQ0ksTUFBTSxDQUFDVyxFQUFFLENBQUM7TUFDdEQsSUFBSSxDQUFDQyxLQUFLLEVBQUU7UUFDVixPQUFPZixHQUFHLENBQUNLLE1BQU0sQ0FBQyxHQUFHLENBQUMsQ0FBQ0MsSUFBSSxDQUFDO1VBQUVDLElBQUksRUFBRTtRQUF1QixDQUFDLENBQUM7TUFDL0Q7TUFFQSxNQUFNSSxRQUFRLEdBQUdoQixJQUFJLENBQUM2QixPQUFPLENBQUNULEtBQUssQ0FBQ1UsT0FBTyxDQUFDO01BQzVDekIsR0FBRyxDQUFDc0IsUUFBUSxDQUFDWCxRQUFRLEVBQUVJLEtBQUssQ0FBQ1csWUFBWSxFQUFHUixHQUFHLElBQUs7UUFDbEQsSUFBSUEsR0FBRyxFQUFFO1VBQ1BqQixJQUFJLENBQUNpQixHQUFHLENBQUM7UUFDWDtNQUNGLENBQUMsQ0FBQztJQUNKLENBQUMsQ0FBQyxPQUFPQSxHQUFHLEVBQUU7TUFDWmpCLElBQUksQ0FBQ2lCLEdBQUcsQ0FBQztJQUNYO0VBQ0Y7QUFDRixDQUFDO0FBRURTLE1BQU0sQ0FBQ0MsT0FBTyxHQUFHL0IsZUFBZSIsImlnbm9yZUxpc3QiOltdfQ==","map":{"version":3,"names":["AnexoModel","require","path","fs","AnexoController","upload","req","res","next","chamado_id","params","file","status","json","erro","filename","originalname","size","filePath","usuario_id","usuario","id","anexo","add","mensagem","err","list","anexos","findByChamado","download","findById","resolve","caminho","nome_arquivo","module","exports"],"sourceRoot":"/home/bernardo/sistema-atendimento-ti/ATNTI/src/controllers/","sources":["anexoController.js"],"sourcesContent":["const AnexoModel = require('../models/anexoModel');\nconst path       = require('path');\nconst fs         = require('fs');\n\nconst AnexoController = {\n  async upload(req, res, next) {\n    try {\n      const { chamado_id } = req.params;\n      \n      if (!req.file) {\n        return res.status(400).json({ erro: 'Nenhum arquivo foi enviado.' });\n      }\n\n      const { filename, originalname, size, path: filePath } = req.file;\n      const usuario_id = req.usuario.id;\n\n      const anexo = await AnexoModel.add(\n        chamado_id,\n        originalname,\n        filePath,\n        size,\n        usuario_id\n      );\n\n      res.status(201).json({\n        mensagem: 'Anexo adicionado com sucesso',\n        anexo\n      });\n    } catch (err) {\n      next(err);\n    }\n  },\n\n  async list(req, res, next) {\n    try {\n      const { chamado_id } = req.params;\n      const anexos = await AnexoModel.findByChamado(chamado_id);\n      res.json(anexos);\n    } catch (err) {\n      next(err);\n    }\n  },\n\n  async download(req, res, next) {\n    try {\n      const anexo = await AnexoModel.findById(req.params.id);\n      if (!anexo) {\n        return res.status(404).json({ erro: 'Anexo não encontrado' });\n      }\n\n      const filePath = path.resolve(anexo.caminho);\n      res.download(filePath, anexo.nome_arquivo, (err) => {\n        if (err) {\n          next(err);\n        }\n      });\n    } catch (err) {\n      next(err);\n    }\n  }\n};\n\nmodule.exports = AnexoController;"],"mappings":"AAAA,MAAMA,UAAU,GAAGC,OAAO,CAAC,sBAAsB,CAAC;AAClD,MAAMC,IAAI,GAASD,OAAO,CAAC,MAAM,CAAC;AAClC,MAAME,EAAE,GAAWF,OAAO,CAAC,IAAI,CAAC;AAEhC,MAAMG,eAAe,GAAG;EACtB,MAAMC,MAAMA,CAACC,GAAG,EAAEC,GAAG,EAAEC,IAAI,EAAE;IAC3B,IAAI;MACF,MAAM;QAAEC;MAAW,CAAC,GAAGH,GAAG,CAACI,MAAM;MAEjC,IAAI,CAACJ,GAAG,CAACK,IAAI,EAAE;QACb,OAAOJ,GAAG,CAACK,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;UAAEC,IAAI,EAAE;QAA8B,CAAC,CAAC;MACtE;MAEA,MAAM;QAAEC,QAAQ;QAAEC,YAAY;QAAEC,IAAI;QAAEf,IAAI,EAAEgB;MAAS,CAAC,GAAGZ,GAAG,CAACK,IAAI;MACjE,MAAMQ,UAAU,GAAGb,GAAG,CAACc,OAAO,CAACC,EAAE;MAEjC,MAAMC,KAAK,GAAG,MAAMtB,UAAU,CAACuB,GAAG,CAChCd,UAAU,EACVO,YAAY,EACZE,QAAQ,EACRD,IAAI,EACJE,UACF,CAAC;MAEDZ,GAAG,CAACK,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;QACnBW,QAAQ,EAAE,8BAA8B;QACxCF;MACF,CAAC,CAAC;IACJ,CAAC,CAAC,OAAOG,GAAG,EAAE;MACZjB,IAAI,CAACiB,GAAG,CAAC;IACX;EACF,CAAC;EAED,MAAMC,IAAIA,CAACpB,GAAG,EAAEC,GAAG,EAAEC,IAAI,EAAE;IACzB,IAAI;MACF,MAAM;QAAEC;MAAW,CAAC,GAAGH,GAAG,CAACI,MAAM;MACjC,MAAMiB,MAAM,GAAG,MAAM3B,UAAU,CAAC4B,aAAa,CAACnB,UAAU,CAAC;MACzDF,GAAG,CAACM,IAAI,CAACc,MAAM,CAAC;IAClB,CAAC,CAAC,OAAOF,GAAG,EAAE;MACZjB,IAAI,CAACiB,GAAG,CAAC;IACX;EACF,CAAC;EAED,MAAMI,QAAQA,CAACvB,GAAG,EAAEC,GAAG,EAAEC,IAAI,EAAE;IAC7B,IAAI;MACF,MAAMc,KAAK,GAAG,MAAMtB,UAAU,CAAC8B,QAAQ,CAACxB,GAAG,CAACI,MAAM,CAACW,EAAE,CAAC;MACtD,IAAI,CAACC,KAAK,EAAE;QACV,OAAOf,GAAG,CAACK,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;UAAEC,IAAI,EAAE;QAAuB,CAAC,CAAC;MAC/D;MAEA,MAAMI,QAAQ,GAAGhB,IAAI,CAAC6B,OAAO,CAACT,KAAK,CAACU,OAAO,CAAC;MAC5CzB,GAAG,CAACsB,QAAQ,CAACX,QAAQ,EAAEI,KAAK,CAACW,YAAY,EAAGR,GAAG,IAAK;QAClD,IAAIA,GAAG,EAAE;UACPjB,IAAI,CAACiB,GAAG,CAAC;QACX;MACF,CAAC,CAAC;IACJ,CAAC,CAAC,OAAOA,GAAG,EAAE;MACZjB,IAAI,CAACiB,GAAG,CAAC;IACX;EACF;AACF,CAAC;AAEDS,MAAM,CAACC,OAAO,GAAG/B,eAAe","ignoreList":[]}},"mtime":1754590737302},"{\"assumptions\":{},\"sourceRoot\":\"/home/bernardo/sistema-atendimento-ti/ATNTI/src/models/\",\"caller\":{\"name\":\"@babel/register\"},\"cwd\":\"/home/bernardo/sistema-atendimento-ti/ATNTI\",\"filename\":\"/home/bernardo/sistema-atendimento-ti/ATNTI/src/models/anexoModel.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/home/bernardo/sistema-atendimento-ti/ATNTI\",\"rootMode\":\"root\",\"plugins\":[],\"presets\":[]}:7.28.0:development":{"value":{"code":"const db = require('../config/db');\nconst AnexoModel = {\n  async add(chamado_id, nome_arquivo, caminho, tamanho, usuario_id) {\n    const query = `\n      INSERT INTO chamado_anexos (chamado_id, nome_arquivo, caminho, tamanho, usuario_id)\n      VALUES ($1, $2, $3, $4, $5)\n      RETURNING *\n    `;\n    const values = [chamado_id, nome_arquivo, caminho, tamanho, usuario_id];\n    const result = await db.query(query, values);\n    return result.rows[0];\n  },\n  async findByChamado(chamado_id) {\n    const result = await db.query(`SELECT * FROM chamado_anexos WHERE chamado_id = $1`, [chamado_id]);\n    return result.rows;\n  },\n  async findById(id) {\n    const result = await db.query(`SELECT * FROM chamado_anexos WHERE id = $1`, [id]);\n    return result.rows[0];\n  }\n};\nmodule.exports = AnexoModel;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJkYiIsInJlcXVpcmUiLCJBbmV4b01vZGVsIiwiYWRkIiwiY2hhbWFkb19pZCIsIm5vbWVfYXJxdWl2byIsImNhbWluaG8iLCJ0YW1hbmhvIiwidXN1YXJpb19pZCIsInF1ZXJ5IiwidmFsdWVzIiwicmVzdWx0Iiwicm93cyIsImZpbmRCeUNoYW1hZG8iLCJmaW5kQnlJZCIsImlkIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJzb3VyY2VSb290IjoiL2hvbWUvYmVybmFyZG8vc2lzdGVtYS1hdGVuZGltZW50by10aS9BVE5USS9zcmMvbW9kZWxzLyIsInNvdXJjZXMiOlsiYW5leG9Nb2RlbC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBkYiA9IHJlcXVpcmUoJy4uL2NvbmZpZy9kYicpO1xuXG5jb25zdCBBbmV4b01vZGVsID0ge1xuICBhc3luYyBhZGQoY2hhbWFkb19pZCwgbm9tZV9hcnF1aXZvLCBjYW1pbmhvLCB0YW1hbmhvLCB1c3VhcmlvX2lkKSB7XG4gICAgY29uc3QgcXVlcnkgPSBgXG4gICAgICBJTlNFUlQgSU5UTyBjaGFtYWRvX2FuZXhvcyAoY2hhbWFkb19pZCwgbm9tZV9hcnF1aXZvLCBjYW1pbmhvLCB0YW1hbmhvLCB1c3VhcmlvX2lkKVxuICAgICAgVkFMVUVTICgkMSwgJDIsICQzLCAkNCwgJDUpXG4gICAgICBSRVRVUk5JTkcgKlxuICAgIGA7XG4gICAgY29uc3QgdmFsdWVzID0gW2NoYW1hZG9faWQsIG5vbWVfYXJxdWl2bywgY2FtaW5obywgdGFtYW5obywgdXN1YXJpb19pZF07XG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZGIucXVlcnkocXVlcnksIHZhbHVlcyk7XG4gICAgcmV0dXJuIHJlc3VsdC5yb3dzWzBdO1xuICB9LFxuXG4gIGFzeW5jIGZpbmRCeUNoYW1hZG8oY2hhbWFkb19pZCkge1xuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGRiLnF1ZXJ5KFxuICAgICAgYFNFTEVDVCAqIEZST00gY2hhbWFkb19hbmV4b3MgV0hFUkUgY2hhbWFkb19pZCA9ICQxYCxcbiAgICAgIFtjaGFtYWRvX2lkXVxuICAgICk7XG4gICAgcmV0dXJuIHJlc3VsdC5yb3dzO1xuICB9LFxuICBcbiAgYXN5bmMgZmluZEJ5SWQoaWQpIHtcbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBkYi5xdWVyeShcbiAgICAgIGBTRUxFQ1QgKiBGUk9NIGNoYW1hZG9fYW5leG9zIFdIRVJFIGlkID0gJDFgLFxuICAgICAgW2lkXVxuICAgICk7XG4gICAgcmV0dXJuIHJlc3VsdC5yb3dzWzBdO1xuICB9XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IEFuZXhvTW9kZWw7Il0sIm1hcHBpbmdzIjoiQUFBQSxNQUFNQSxFQUFFLEdBQUdDLE9BQU8sQ0FBQyxjQUFjLENBQUM7QUFFbEMsTUFBTUMsVUFBVSxHQUFHO0VBQ2pCLE1BQU1DLEdBQUdBLENBQUNDLFVBQVUsRUFBRUMsWUFBWSxFQUFFQyxPQUFPLEVBQUVDLE9BQU8sRUFBRUMsVUFBVSxFQUFFO0lBQ2hFLE1BQU1DLEtBQUssR0FBRztBQUNsQjtBQUNBO0FBQ0E7QUFDQSxLQUFLO0lBQ0QsTUFBTUMsTUFBTSxHQUFHLENBQUNOLFVBQVUsRUFBRUMsWUFBWSxFQUFFQyxPQUFPLEVBQUVDLE9BQU8sRUFBRUMsVUFBVSxDQUFDO0lBQ3ZFLE1BQU1HLE1BQU0sR0FBRyxNQUFNWCxFQUFFLENBQUNTLEtBQUssQ0FBQ0EsS0FBSyxFQUFFQyxNQUFNLENBQUM7SUFDNUMsT0FBT0MsTUFBTSxDQUFDQyxJQUFJLENBQUMsQ0FBQyxDQUFDO0VBQ3ZCLENBQUM7RUFFRCxNQUFNQyxhQUFhQSxDQUFDVCxVQUFVLEVBQUU7SUFDOUIsTUFBTU8sTUFBTSxHQUFHLE1BQU1YLEVBQUUsQ0FBQ1MsS0FBSyxDQUMzQixvREFBb0QsRUFDcEQsQ0FBQ0wsVUFBVSxDQUNiLENBQUM7SUFDRCxPQUFPTyxNQUFNLENBQUNDLElBQUk7RUFDcEIsQ0FBQztFQUVELE1BQU1FLFFBQVFBLENBQUNDLEVBQUUsRUFBRTtJQUNqQixNQUFNSixNQUFNLEdBQUcsTUFBTVgsRUFBRSxDQUFDUyxLQUFLLENBQzNCLDRDQUE0QyxFQUM1QyxDQUFDTSxFQUFFLENBQ0wsQ0FBQztJQUNELE9BQU9KLE1BQU0sQ0FBQ0MsSUFBSSxDQUFDLENBQUMsQ0FBQztFQUN2QjtBQUNGLENBQUM7QUFFREksTUFBTSxDQUFDQyxPQUFPLEdBQUdmLFVBQVUiLCJpZ25vcmVMaXN0IjpbXX0=","map":{"version":3,"names":["db","require","AnexoModel","add","chamado_id","nome_arquivo","caminho","tamanho","usuario_id","query","values","result","rows","findByChamado","findById","id","module","exports"],"sourceRoot":"/home/bernardo/sistema-atendimento-ti/ATNTI/src/models/","sources":["anexoModel.js"],"sourcesContent":["const db = require('../config/db');\n\nconst AnexoModel = {\n  async add(chamado_id, nome_arquivo, caminho, tamanho, usuario_id) {\n    const query = `\n      INSERT INTO chamado_anexos (chamado_id, nome_arquivo, caminho, tamanho, usuario_id)\n      VALUES ($1, $2, $3, $4, $5)\n      RETURNING *\n    `;\n    const values = [chamado_id, nome_arquivo, caminho, tamanho, usuario_id];\n    const result = await db.query(query, values);\n    return result.rows[0];\n  },\n\n  async findByChamado(chamado_id) {\n    const result = await db.query(\n      `SELECT * FROM chamado_anexos WHERE chamado_id = $1`,\n      [chamado_id]\n    );\n    return result.rows;\n  },\n  \n  async findById(id) {\n    const result = await db.query(\n      `SELECT * FROM chamado_anexos WHERE id = $1`,\n      [id]\n    );\n    return result.rows[0];\n  }\n};\n\nmodule.exports = AnexoModel;"],"mappings":"AAAA,MAAMA,EAAE,GAAGC,OAAO,CAAC,cAAc,CAAC;AAElC,MAAMC,UAAU,GAAG;EACjB,MAAMC,GAAGA,CAACC,UAAU,EAAEC,YAAY,EAAEC,OAAO,EAAEC,OAAO,EAAEC,UAAU,EAAE;IAChE,MAAMC,KAAK,GAAG;AAClB;AACA;AACA;AACA,KAAK;IACD,MAAMC,MAAM,GAAG,CAACN,UAAU,EAAEC,YAAY,EAAEC,OAAO,EAAEC,OAAO,EAAEC,UAAU,CAAC;IACvE,MAAMG,MAAM,GAAG,MAAMX,EAAE,CAACS,KAAK,CAACA,KAAK,EAAEC,MAAM,CAAC;IAC5C,OAAOC,MAAM,CAACC,IAAI,CAAC,CAAC,CAAC;EACvB,CAAC;EAED,MAAMC,aAAaA,CAACT,UAAU,EAAE;IAC9B,MAAMO,MAAM,GAAG,MAAMX,EAAE,CAACS,KAAK,CAC3B,oDAAoD,EACpD,CAACL,UAAU,CACb,CAAC;IACD,OAAOO,MAAM,CAACC,IAAI;EACpB,CAAC;EAED,MAAME,QAAQA,CAACC,EAAE,EAAE;IACjB,MAAMJ,MAAM,GAAG,MAAMX,EAAE,CAACS,KAAK,CAC3B,4CAA4C,EAC5C,CAACM,EAAE,CACL,CAAC;IACD,OAAOJ,MAAM,CAACC,IAAI,CAAC,CAAC,CAAC;EACvB;AACF,CAAC;AAEDI,MAAM,CAACC,OAAO,GAAGf,UAAU","ignoreList":[]}},"mtime":1754586654292},"{\"assumptions\":{},\"sourceRoot\":\"/home/bernardo/sistema-atendimento-ti/ATNTI/src/config/\",\"caller\":{\"name\":\"@babel/register\"},\"cwd\":\"/home/bernardo/sistema-atendimento-ti/ATNTI\",\"filename\":\"/home/bernardo/sistema-atendimento-ti/ATNTI/src/config/multer.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/home/bernardo/sistema-atendimento-ti/ATNTI\",\"rootMode\":\"root\",\"plugins\":[],\"presets\":[]}:7.28.0:development":{"value":{"code":"const multer = require('multer');\nconst path = require('path');\nconst storage = multer.diskStorage({\n  destination: (req, file, cb) => {\n    cb(null, 'uploads/'); // Salva na pasta 'uploads' na raiz do projeto\n  },\n  filename: (req, file, cb) => {\n    // Renomeia o arquivo para evitar conflitos, mantendo a extensão original\n    cb(null, `${Date.now()}-${path.extname(file.originalname)}`);\n  }\n});\nconst upload = multer({\n  storage,\n  limits: {\n    // Ajusta o limite para 20 MB (20 * 1024 * 1024 bytes)\n    fileSize: 20 * 1024 * 1024\n  }\n});\nmodule.exports = upload;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJtdWx0ZXIiLCJyZXF1aXJlIiwicGF0aCIsInN0b3JhZ2UiLCJkaXNrU3RvcmFnZSIsImRlc3RpbmF0aW9uIiwicmVxIiwiZmlsZSIsImNiIiwiZmlsZW5hbWUiLCJEYXRlIiwibm93IiwiZXh0bmFtZSIsIm9yaWdpbmFsbmFtZSIsInVwbG9hZCIsImxpbWl0cyIsImZpbGVTaXplIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJzb3VyY2VSb290IjoiL2hvbWUvYmVybmFyZG8vc2lzdGVtYS1hdGVuZGltZW50by10aS9BVE5USS9zcmMvY29uZmlnLyIsInNvdXJjZXMiOlsibXVsdGVyLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImNvbnN0IG11bHRlciA9IHJlcXVpcmUoJ211bHRlcicpO1xuY29uc3QgcGF0aCAgID0gcmVxdWlyZSgncGF0aCcpO1xuXG5jb25zdCBzdG9yYWdlID0gbXVsdGVyLmRpc2tTdG9yYWdlKHtcbiAgZGVzdGluYXRpb246IChyZXEsIGZpbGUsIGNiKSA9PiB7XG4gICAgY2IobnVsbCwgJ3VwbG9hZHMvJyk7IC8vIFNhbHZhIG5hIHBhc3RhICd1cGxvYWRzJyBuYSByYWl6IGRvIHByb2pldG9cbiAgfSxcbiAgZmlsZW5hbWU6IChyZXEsIGZpbGUsIGNiKSA9PiB7XG4gICAgLy8gUmVub21laWEgbyBhcnF1aXZvIHBhcmEgZXZpdGFyIGNvbmZsaXRvcywgbWFudGVuZG8gYSBleHRlbnPDo28gb3JpZ2luYWxcbiAgICBjYihudWxsLCBgJHtEYXRlLm5vdygpfS0ke3BhdGguZXh0bmFtZShmaWxlLm9yaWdpbmFsbmFtZSl9YCk7XG4gIH1cbn0pO1xuXG5jb25zdCB1cGxvYWQgPSBtdWx0ZXIoe1xuICBzdG9yYWdlLFxuICBsaW1pdHM6IHtcbiAgICAvLyBBanVzdGEgbyBsaW1pdGUgcGFyYSAyMCBNQiAoMjAgKiAxMDI0ICogMTAyNCBieXRlcylcbiAgICBmaWxlU2l6ZTogMjAgKiAxMDI0ICogMTAyNFxuICB9LFxufSk7XG5cbm1vZHVsZS5leHBvcnRzID0gdXBsb2FkOyJdLCJtYXBwaW5ncyI6IkFBQUEsTUFBTUEsTUFBTSxHQUFHQyxPQUFPLENBQUMsUUFBUSxDQUFDO0FBQ2hDLE1BQU1DLElBQUksR0FBS0QsT0FBTyxDQUFDLE1BQU0sQ0FBQztBQUU5QixNQUFNRSxPQUFPLEdBQUdILE1BQU0sQ0FBQ0ksV0FBVyxDQUFDO0VBQ2pDQyxXQUFXLEVBQUVBLENBQUNDLEdBQUcsRUFBRUMsSUFBSSxFQUFFQyxFQUFFLEtBQUs7SUFDOUJBLEVBQUUsQ0FBQyxJQUFJLEVBQUUsVUFBVSxDQUFDLENBQUMsQ0FBQztFQUN4QixDQUFDO0VBQ0RDLFFBQVEsRUFBRUEsQ0FBQ0gsR0FBRyxFQUFFQyxJQUFJLEVBQUVDLEVBQUUsS0FBSztJQUMzQjtJQUNBQSxFQUFFLENBQUMsSUFBSSxFQUFFLEdBQUdFLElBQUksQ0FBQ0MsR0FBRyxDQUFDLENBQUMsSUFBSVQsSUFBSSxDQUFDVSxPQUFPLENBQUNMLElBQUksQ0FBQ00sWUFBWSxDQUFDLEVBQUUsQ0FBQztFQUM5RDtBQUNGLENBQUMsQ0FBQztBQUVGLE1BQU1DLE1BQU0sR0FBR2QsTUFBTSxDQUFDO0VBQ3BCRyxPQUFPO0VBQ1BZLE1BQU0sRUFBRTtJQUNOO0lBQ0FDLFFBQVEsRUFBRSxFQUFFLEdBQUcsSUFBSSxHQUFHO0VBQ3hCO0FBQ0YsQ0FBQyxDQUFDO0FBRUZDLE1BQU0sQ0FBQ0MsT0FBTyxHQUFHSixNQUFNIiwiaWdub3JlTGlzdCI6W119","map":{"version":3,"names":["multer","require","path","storage","diskStorage","destination","req","file","cb","filename","Date","now","extname","originalname","upload","limits","fileSize","module","exports"],"sourceRoot":"/home/bernardo/sistema-atendimento-ti/ATNTI/src/config/","sources":["multer.js"],"sourcesContent":["const multer = require('multer');\nconst path   = require('path');\n\nconst storage = multer.diskStorage({\n  destination: (req, file, cb) => {\n    cb(null, 'uploads/'); // Salva na pasta 'uploads' na raiz do projeto\n  },\n  filename: (req, file, cb) => {\n    // Renomeia o arquivo para evitar conflitos, mantendo a extensão original\n    cb(null, `${Date.now()}-${path.extname(file.originalname)}`);\n  }\n});\n\nconst upload = multer({\n  storage,\n  limits: {\n    // Ajusta o limite para 20 MB (20 * 1024 * 1024 bytes)\n    fileSize: 20 * 1024 * 1024\n  },\n});\n\nmodule.exports = upload;"],"mappings":"AAAA,MAAMA,MAAM,GAAGC,OAAO,CAAC,QAAQ,CAAC;AAChC,MAAMC,IAAI,GAAKD,OAAO,CAAC,MAAM,CAAC;AAE9B,MAAME,OAAO,GAAGH,MAAM,CAACI,WAAW,CAAC;EACjCC,WAAW,EAAEA,CAACC,GAAG,EAAEC,IAAI,EAAEC,EAAE,KAAK;IAC9BA,EAAE,CAAC,IAAI,EAAE,UAAU,CAAC,CAAC,CAAC;EACxB,CAAC;EACDC,QAAQ,EAAEA,CAACH,GAAG,EAAEC,IAAI,EAAEC,EAAE,KAAK;IAC3B;IACAA,EAAE,CAAC,IAAI,EAAE,GAAGE,IAAI,CAACC,GAAG,CAAC,CAAC,IAAIT,IAAI,CAACU,OAAO,CAACL,IAAI,CAACM,YAAY,CAAC,EAAE,CAAC;EAC9D;AACF,CAAC,CAAC;AAEF,MAAMC,MAAM,GAAGd,MAAM,CAAC;EACpBG,OAAO;EACPY,MAAM,EAAE;IACN;IACAC,QAAQ,EAAE,EAAE,GAAG,IAAI,GAAG;EACxB;AACF,CAAC,CAAC;AAEFC,MAAM,CAACC,OAAO,GAAGJ,MAAM","ignoreList":[]}},"mtime":1754587646052},"{\"assumptions\":{},\"sourceRoot\":\"/home/bernardo/sistema-atendimento-ti/ATNTI/src/routes/\",\"caller\":{\"name\":\"@babel/register\"},\"cwd\":\"/home/bernardo/sistema-atendimento-ti/ATNTI\",\"filename\":\"/home/bernardo/sistema-atendimento-ti/ATNTI/src/routes/notificacaoRoutes.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/home/bernardo/sistema-atendimento-ti/ATNTI\",\"rootMode\":\"root\",\"plugins\":[],\"presets\":[]}:7.28.0:development":{"value":{"code":"const express = require('express');\nconst router = express.Router();\nconst NotificacaoController = require('../controllers/notificacaoController');\nconst autenticarToken = require('../middlewares/authMiddleware');\n\n/**\n * @swagger\n * tags:\n *   - name: Notificações\n *     description: Endpoints para gerenciar notificações do usuário\n *\n * paths:\n *   /notificacoes:\n *     get:\n *       summary: Lista todas as notificações do usuário logado\n *       tags: [Notificações]\n *       security:\n *         - bearerAuth: []\n *       responses:\n *         '200': { description: Lista de notificações }\n *         '401': { description: Não autorizado }\n *\n *   /notificacoes/{id}/lida:\n *     put:\n *       summary: Marca uma notificação como lida\n *       tags: [Notificações]\n *       security:\n *         - bearerAuth: []\n *       parameters:\n *         - in: path\n *           name: id\n *           required: true\n *           schema: { type: integer }\n *           description: ID da notificação\n *       responses:\n *         '200': { description: Notificação marcada como lida }\n *         '401': { description: Não autorizado }\n *         '404': { description: Notificação não encontrada }\n */\n\n// Listar notificações do usuário logado\nrouter.get('/', autenticarToken, NotificacaoController.list);\n\n// Marcar notificação como lida\nrouter.put('/:id/lida', autenticarToken, NotificacaoController.marcarComoLida);\nmodule.exports = router;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJleHByZXNzIiwicmVxdWlyZSIsInJvdXRlciIsIlJvdXRlciIsIk5vdGlmaWNhY2FvQ29udHJvbGxlciIsImF1dGVudGljYXJUb2tlbiIsImdldCIsImxpc3QiLCJwdXQiLCJtYXJjYXJDb21vTGlkYSIsIm1vZHVsZSIsImV4cG9ydHMiXSwic291cmNlUm9vdCI6Ii9ob21lL2Jlcm5hcmRvL3Npc3RlbWEtYXRlbmRpbWVudG8tdGkvQVROVEkvc3JjL3JvdXRlcy8iLCJzb3VyY2VzIjpbIm5vdGlmaWNhY2FvUm91dGVzLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImNvbnN0IGV4cHJlc3MgPSByZXF1aXJlKCdleHByZXNzJyk7XG5jb25zdCByb3V0ZXIgPSBleHByZXNzLlJvdXRlcigpO1xuXG5jb25zdCBOb3RpZmljYWNhb0NvbnRyb2xsZXIgPSByZXF1aXJlKCcuLi9jb250cm9sbGVycy9ub3RpZmljYWNhb0NvbnRyb2xsZXInKTtcbmNvbnN0IGF1dGVudGljYXJUb2tlbiA9IHJlcXVpcmUoJy4uL21pZGRsZXdhcmVzL2F1dGhNaWRkbGV3YXJlJyk7XG5cbi8qKlxuICogQHN3YWdnZXJcbiAqIHRhZ3M6XG4gKiAgIC0gbmFtZTogTm90aWZpY2HDp8O1ZXNcbiAqICAgICBkZXNjcmlwdGlvbjogRW5kcG9pbnRzIHBhcmEgZ2VyZW5jaWFyIG5vdGlmaWNhw6fDtWVzIGRvIHVzdcOhcmlvXG4gKlxuICogcGF0aHM6XG4gKiAgIC9ub3RpZmljYWNvZXM6XG4gKiAgICAgZ2V0OlxuICogICAgICAgc3VtbWFyeTogTGlzdGEgdG9kYXMgYXMgbm90aWZpY2HDp8O1ZXMgZG8gdXN1w6FyaW8gbG9nYWRvXG4gKiAgICAgICB0YWdzOiBbTm90aWZpY2HDp8O1ZXNdXG4gKiAgICAgICBzZWN1cml0eTpcbiAqICAgICAgICAgLSBiZWFyZXJBdXRoOiBbXVxuICogICAgICAgcmVzcG9uc2VzOlxuICogICAgICAgICAnMjAwJzogeyBkZXNjcmlwdGlvbjogTGlzdGEgZGUgbm90aWZpY2HDp8O1ZXMgfVxuICogICAgICAgICAnNDAxJzogeyBkZXNjcmlwdGlvbjogTsOjbyBhdXRvcml6YWRvIH1cbiAqXG4gKiAgIC9ub3RpZmljYWNvZXMve2lkfS9saWRhOlxuICogICAgIHB1dDpcbiAqICAgICAgIHN1bW1hcnk6IE1hcmNhIHVtYSBub3RpZmljYcOnw6NvIGNvbW8gbGlkYVxuICogICAgICAgdGFnczogW05vdGlmaWNhw6fDtWVzXVxuICogICAgICAgc2VjdXJpdHk6XG4gKiAgICAgICAgIC0gYmVhcmVyQXV0aDogW11cbiAqICAgICAgIHBhcmFtZXRlcnM6XG4gKiAgICAgICAgIC0gaW46IHBhdGhcbiAqICAgICAgICAgICBuYW1lOiBpZFxuICogICAgICAgICAgIHJlcXVpcmVkOiB0cnVlXG4gKiAgICAgICAgICAgc2NoZW1hOiB7IHR5cGU6IGludGVnZXIgfVxuICogICAgICAgICAgIGRlc2NyaXB0aW9uOiBJRCBkYSBub3RpZmljYcOnw6NvXG4gKiAgICAgICByZXNwb25zZXM6XG4gKiAgICAgICAgICcyMDAnOiB7IGRlc2NyaXB0aW9uOiBOb3RpZmljYcOnw6NvIG1hcmNhZGEgY29tbyBsaWRhIH1cbiAqICAgICAgICAgJzQwMSc6IHsgZGVzY3JpcHRpb246IE7Do28gYXV0b3JpemFkbyB9XG4gKiAgICAgICAgICc0MDQnOiB7IGRlc2NyaXB0aW9uOiBOb3RpZmljYcOnw6NvIG7Do28gZW5jb250cmFkYSB9XG4gKi9cblxuXG4vLyBMaXN0YXIgbm90aWZpY2HDp8O1ZXMgZG8gdXN1w6FyaW8gbG9nYWRvXG5yb3V0ZXIuZ2V0KCcvJywgYXV0ZW50aWNhclRva2VuLCBOb3RpZmljYWNhb0NvbnRyb2xsZXIubGlzdCk7XG5cbi8vIE1hcmNhciBub3RpZmljYcOnw6NvIGNvbW8gbGlkYVxucm91dGVyLnB1dCgnLzppZC9saWRhJywgYXV0ZW50aWNhclRva2VuLCBOb3RpZmljYWNhb0NvbnRyb2xsZXIubWFyY2FyQ29tb0xpZGEpO1xuXG5tb2R1bGUuZXhwb3J0cyA9IHJvdXRlcjsiXSwibWFwcGluZ3MiOiJBQUFBLE1BQU1BLE9BQU8sR0FBR0MsT0FBTyxDQUFDLFNBQVMsQ0FBQztBQUNsQyxNQUFNQyxNQUFNLEdBQUdGLE9BQU8sQ0FBQ0csTUFBTSxDQUFDLENBQUM7QUFFL0IsTUFBTUMscUJBQXFCLEdBQUdILE9BQU8sQ0FBQyxzQ0FBc0MsQ0FBQztBQUM3RSxNQUFNSSxlQUFlLEdBQUdKLE9BQU8sQ0FBQywrQkFBK0IsQ0FBQzs7QUFFaEU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBR0E7QUFDQUMsTUFBTSxDQUFDSSxHQUFHLENBQUMsR0FBRyxFQUFFRCxlQUFlLEVBQUVELHFCQUFxQixDQUFDRyxJQUFJLENBQUM7O0FBRTVEO0FBQ0FMLE1BQU0sQ0FBQ00sR0FBRyxDQUFDLFdBQVcsRUFBRUgsZUFBZSxFQUFFRCxxQkFBcUIsQ0FBQ0ssY0FBYyxDQUFDO0FBRTlFQyxNQUFNLENBQUNDLE9BQU8sR0FBR1QsTUFBTSIsImlnbm9yZUxpc3QiOltdfQ==","map":{"version":3,"names":["express","require","router","Router","NotificacaoController","autenticarToken","get","list","put","marcarComoLida","module","exports"],"sourceRoot":"/home/bernardo/sistema-atendimento-ti/ATNTI/src/routes/","sources":["notificacaoRoutes.js"],"sourcesContent":["const express = require('express');\nconst router = express.Router();\n\nconst NotificacaoController = require('../controllers/notificacaoController');\nconst autenticarToken = require('../middlewares/authMiddleware');\n\n/**\n * @swagger\n * tags:\n *   - name: Notificações\n *     description: Endpoints para gerenciar notificações do usuário\n *\n * paths:\n *   /notificacoes:\n *     get:\n *       summary: Lista todas as notificações do usuário logado\n *       tags: [Notificações]\n *       security:\n *         - bearerAuth: []\n *       responses:\n *         '200': { description: Lista de notificações }\n *         '401': { description: Não autorizado }\n *\n *   /notificacoes/{id}/lida:\n *     put:\n *       summary: Marca uma notificação como lida\n *       tags: [Notificações]\n *       security:\n *         - bearerAuth: []\n *       parameters:\n *         - in: path\n *           name: id\n *           required: true\n *           schema: { type: integer }\n *           description: ID da notificação\n *       responses:\n *         '200': { description: Notificação marcada como lida }\n *         '401': { description: Não autorizado }\n *         '404': { description: Notificação não encontrada }\n */\n\n\n// Listar notificações do usuário logado\nrouter.get('/', autenticarToken, NotificacaoController.list);\n\n// Marcar notificação como lida\nrouter.put('/:id/lida', autenticarToken, NotificacaoController.marcarComoLida);\n\nmodule.exports = router;"],"mappings":"AAAA,MAAMA,OAAO,GAAGC,OAAO,CAAC,SAAS,CAAC;AAClC,MAAMC,MAAM,GAAGF,OAAO,CAACG,MAAM,CAAC,CAAC;AAE/B,MAAMC,qBAAqB,GAAGH,OAAO,CAAC,sCAAsC,CAAC;AAC7E,MAAMI,eAAe,GAAGJ,OAAO,CAAC,+BAA+B,CAAC;;AAEhE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAGA;AACAC,MAAM,CAACI,GAAG,CAAC,GAAG,EAAED,eAAe,EAAED,qBAAqB,CAACG,IAAI,CAAC;;AAE5D;AACAL,MAAM,CAACM,GAAG,CAAC,WAAW,EAAEH,eAAe,EAAED,qBAAqB,CAACK,cAAc,CAAC;AAE9EC,MAAM,CAACC,OAAO,GAAGT,MAAM","ignoreList":[]}},"mtime":1754589630737},"{\"assumptions\":{},\"sourceRoot\":\"/home/bernardo/sistema-atendimento-ti/ATNTI/src/controllers/\",\"caller\":{\"name\":\"@babel/register\"},\"cwd\":\"/home/bernardo/sistema-atendimento-ti/ATNTI\",\"filename\":\"/home/bernardo/sistema-atendimento-ti/ATNTI/src/controllers/notificacaoController.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/home/bernardo/sistema-atendimento-ti/ATNTI\",\"rootMode\":\"root\",\"plugins\":[],\"presets\":[]}:7.28.0:development":{"value":{"code":"const NotificacaoModel = require('../models/notificacaoModel');\nconst NotificacaoController = {\n  async list(req, res, next) {\n    try {\n      const usuario_id = req.usuario.id;\n      const notificacoes = await NotificacaoModel.listByUsuario(usuario_id);\n      res.json(notificacoes);\n    } catch (err) {\n      next(err);\n    }\n  },\n  async marcarComoLida(req, res, next) {\n    try {\n      const {\n        id\n      } = req.params;\n      const usuario_id = req.usuario.id;\n      const notificacao = await NotificacaoModel.marcarComoLida(id, usuario_id);\n      if (!notificacao) {\n        return res.status(404).json({\n          erro: 'Notificação não encontrada ou acesso negado'\n        });\n      }\n      res.status(200).json(notificacao);\n    } catch (err) {\n      next(err);\n    }\n  }\n};\nmodule.exports = NotificacaoController;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJOb3RpZmljYWNhb01vZGVsIiwicmVxdWlyZSIsIk5vdGlmaWNhY2FvQ29udHJvbGxlciIsImxpc3QiLCJyZXEiLCJyZXMiLCJuZXh0IiwidXN1YXJpb19pZCIsInVzdWFyaW8iLCJpZCIsIm5vdGlmaWNhY29lcyIsImxpc3RCeVVzdWFyaW8iLCJqc29uIiwiZXJyIiwibWFyY2FyQ29tb0xpZGEiLCJwYXJhbXMiLCJub3RpZmljYWNhbyIsInN0YXR1cyIsImVycm8iLCJtb2R1bGUiLCJleHBvcnRzIl0sInNvdXJjZVJvb3QiOiIvaG9tZS9iZXJuYXJkby9zaXN0ZW1hLWF0ZW5kaW1lbnRvLXRpL0FUTlRJL3NyYy9jb250cm9sbGVycy8iLCJzb3VyY2VzIjpbIm5vdGlmaWNhY2FvQ29udHJvbGxlci5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBOb3RpZmljYWNhb01vZGVsID0gcmVxdWlyZSgnLi4vbW9kZWxzL25vdGlmaWNhY2FvTW9kZWwnKTtcblxuY29uc3QgTm90aWZpY2FjYW9Db250cm9sbGVyID0ge1xuICBhc3luYyBsaXN0KHJlcSwgcmVzLCBuZXh0KSB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHVzdWFyaW9faWQgPSByZXEudXN1YXJpby5pZDtcbiAgICAgIGNvbnN0IG5vdGlmaWNhY29lcyA9IGF3YWl0IE5vdGlmaWNhY2FvTW9kZWwubGlzdEJ5VXN1YXJpbyh1c3VhcmlvX2lkKTtcbiAgICAgIHJlcy5qc29uKG5vdGlmaWNhY29lcyk7XG4gICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICBuZXh0KGVycik7XG4gICAgfVxuICB9LFxuXG4gIGFzeW5jIG1hcmNhckNvbW9MaWRhKHJlcSwgcmVzLCBuZXh0KSB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHsgaWQgfSA9IHJlcS5wYXJhbXM7XG4gICAgICBjb25zdCB1c3VhcmlvX2lkID0gcmVxLnVzdWFyaW8uaWQ7XG5cbiAgICAgIGNvbnN0IG5vdGlmaWNhY2FvID0gYXdhaXQgTm90aWZpY2FjYW9Nb2RlbC5tYXJjYXJDb21vTGlkYShpZCwgdXN1YXJpb19pZCk7XG4gICAgICBpZiAoIW5vdGlmaWNhY2FvKSB7XG4gICAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwNCkuanNvbih7IGVycm86ICdOb3RpZmljYcOnw6NvIG7Do28gZW5jb250cmFkYSBvdSBhY2Vzc28gbmVnYWRvJyB9KTtcbiAgICAgIH1cblxuICAgICAgcmVzLnN0YXR1cygyMDApLmpzb24obm90aWZpY2FjYW8pO1xuICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgbmV4dChlcnIpO1xuICAgIH1cbiAgfVxufTtcblxubW9kdWxlLmV4cG9ydHMgPSBOb3RpZmljYWNhb0NvbnRyb2xsZXI7Il0sIm1hcHBpbmdzIjoiQUFBQSxNQUFNQSxnQkFBZ0IsR0FBR0MsT0FBTyxDQUFDLDRCQUE0QixDQUFDO0FBRTlELE1BQU1DLHFCQUFxQixHQUFHO0VBQzVCLE1BQU1DLElBQUlBLENBQUNDLEdBQUcsRUFBRUMsR0FBRyxFQUFFQyxJQUFJLEVBQUU7SUFDekIsSUFBSTtNQUNGLE1BQU1DLFVBQVUsR0FBR0gsR0FBRyxDQUFDSSxPQUFPLENBQUNDLEVBQUU7TUFDakMsTUFBTUMsWUFBWSxHQUFHLE1BQU1WLGdCQUFnQixDQUFDVyxhQUFhLENBQUNKLFVBQVUsQ0FBQztNQUNyRUYsR0FBRyxDQUFDTyxJQUFJLENBQUNGLFlBQVksQ0FBQztJQUN4QixDQUFDLENBQUMsT0FBT0csR0FBRyxFQUFFO01BQ1pQLElBQUksQ0FBQ08sR0FBRyxDQUFDO0lBQ1g7RUFDRixDQUFDO0VBRUQsTUFBTUMsY0FBY0EsQ0FBQ1YsR0FBRyxFQUFFQyxHQUFHLEVBQUVDLElBQUksRUFBRTtJQUNuQyxJQUFJO01BQ0YsTUFBTTtRQUFFRztNQUFHLENBQUMsR0FBR0wsR0FBRyxDQUFDVyxNQUFNO01BQ3pCLE1BQU1SLFVBQVUsR0FBR0gsR0FBRyxDQUFDSSxPQUFPLENBQUNDLEVBQUU7TUFFakMsTUFBTU8sV0FBVyxHQUFHLE1BQU1oQixnQkFBZ0IsQ0FBQ2MsY0FBYyxDQUFDTCxFQUFFLEVBQUVGLFVBQVUsQ0FBQztNQUN6RSxJQUFJLENBQUNTLFdBQVcsRUFBRTtRQUNoQixPQUFPWCxHQUFHLENBQUNZLE1BQU0sQ0FBQyxHQUFHLENBQUMsQ0FBQ0wsSUFBSSxDQUFDO1VBQUVNLElBQUksRUFBRTtRQUE4QyxDQUFDLENBQUM7TUFDdEY7TUFFQWIsR0FBRyxDQUFDWSxNQUFNLENBQUMsR0FBRyxDQUFDLENBQUNMLElBQUksQ0FBQ0ksV0FBVyxDQUFDO0lBQ25DLENBQUMsQ0FBQyxPQUFPSCxHQUFHLEVBQUU7TUFDWlAsSUFBSSxDQUFDTyxHQUFHLENBQUM7SUFDWDtFQUNGO0FBQ0YsQ0FBQztBQUVETSxNQUFNLENBQUNDLE9BQU8sR0FBR2xCLHFCQUFxQiIsImlnbm9yZUxpc3QiOltdfQ==","map":{"version":3,"names":["NotificacaoModel","require","NotificacaoController","list","req","res","next","usuario_id","usuario","id","notificacoes","listByUsuario","json","err","marcarComoLida","params","notificacao","status","erro","module","exports"],"sourceRoot":"/home/bernardo/sistema-atendimento-ti/ATNTI/src/controllers/","sources":["notificacaoController.js"],"sourcesContent":["const NotificacaoModel = require('../models/notificacaoModel');\n\nconst NotificacaoController = {\n  async list(req, res, next) {\n    try {\n      const usuario_id = req.usuario.id;\n      const notificacoes = await NotificacaoModel.listByUsuario(usuario_id);\n      res.json(notificacoes);\n    } catch (err) {\n      next(err);\n    }\n  },\n\n  async marcarComoLida(req, res, next) {\n    try {\n      const { id } = req.params;\n      const usuario_id = req.usuario.id;\n\n      const notificacao = await NotificacaoModel.marcarComoLida(id, usuario_id);\n      if (!notificacao) {\n        return res.status(404).json({ erro: 'Notificação não encontrada ou acesso negado' });\n      }\n\n      res.status(200).json(notificacao);\n    } catch (err) {\n      next(err);\n    }\n  }\n};\n\nmodule.exports = NotificacaoController;"],"mappings":"AAAA,MAAMA,gBAAgB,GAAGC,OAAO,CAAC,4BAA4B,CAAC;AAE9D,MAAMC,qBAAqB,GAAG;EAC5B,MAAMC,IAAIA,CAACC,GAAG,EAAEC,GAAG,EAAEC,IAAI,EAAE;IACzB,IAAI;MACF,MAAMC,UAAU,GAAGH,GAAG,CAACI,OAAO,CAACC,EAAE;MACjC,MAAMC,YAAY,GAAG,MAAMV,gBAAgB,CAACW,aAAa,CAACJ,UAAU,CAAC;MACrEF,GAAG,CAACO,IAAI,CAACF,YAAY,CAAC;IACxB,CAAC,CAAC,OAAOG,GAAG,EAAE;MACZP,IAAI,CAACO,GAAG,CAAC;IACX;EACF,CAAC;EAED,MAAMC,cAAcA,CAACV,GAAG,EAAEC,GAAG,EAAEC,IAAI,EAAE;IACnC,IAAI;MACF,MAAM;QAAEG;MAAG,CAAC,GAAGL,GAAG,CAACW,MAAM;MACzB,MAAMR,UAAU,GAAGH,GAAG,CAACI,OAAO,CAACC,EAAE;MAEjC,MAAMO,WAAW,GAAG,MAAMhB,gBAAgB,CAACc,cAAc,CAACL,EAAE,EAAEF,UAAU,CAAC;MACzE,IAAI,CAACS,WAAW,EAAE;QAChB,OAAOX,GAAG,CAACY,MAAM,CAAC,GAAG,CAAC,CAACL,IAAI,CAAC;UAAEM,IAAI,EAAE;QAA8C,CAAC,CAAC;MACtF;MAEAb,GAAG,CAACY,MAAM,CAAC,GAAG,CAAC,CAACL,IAAI,CAACI,WAAW,CAAC;IACnC,CAAC,CAAC,OAAOH,GAAG,EAAE;MACZP,IAAI,CAACO,GAAG,CAAC;IACX;EACF;AACF,CAAC;AAEDM,MAAM,CAACC,OAAO,GAAGlB,qBAAqB","ignoreList":[]}},"mtime":1754590779171},"{\"assumptions\":{},\"sourceRoot\":\"/home/bernardo/sistema-atendimento-ti/ATNTI/src/middlewares/\",\"caller\":{\"name\":\"@babel/register\"},\"cwd\":\"/home/bernardo/sistema-atendimento-ti/ATNTI\",\"filename\":\"/home/bernardo/sistema-atendimento-ti/ATNTI/src/middlewares/errorMiddleware.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/home/bernardo/sistema-atendimento-ti/ATNTI\",\"rootMode\":\"root\",\"plugins\":[],\"presets\":[]}:7.28.0:development":{"value":{"code":"function errorMiddleware(err, req, res, next) {\n  console.error(err.stack); // Registra o erro no console\n\n  if (err.name === 'ValidationError') {\n    // Erro de validação Joi\n    return res.status(400).json({\n      erro: \"Validação falhou\",\n      detalhes: err.details.map(d => d.message)\n    });\n  }\n\n  // Resposta padrão para qualquer outro erro\n  res.status(500).json({\n    erro: 'Ocorreu um erro interno do servidor.'\n  });\n}\nmodule.exports = errorMiddleware;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJlcnJvck1pZGRsZXdhcmUiLCJlcnIiLCJyZXEiLCJyZXMiLCJuZXh0IiwiY29uc29sZSIsImVycm9yIiwic3RhY2siLCJuYW1lIiwic3RhdHVzIiwianNvbiIsImVycm8iLCJkZXRhbGhlcyIsImRldGFpbHMiLCJtYXAiLCJkIiwibWVzc2FnZSIsIm1vZHVsZSIsImV4cG9ydHMiXSwic291cmNlUm9vdCI6Ii9ob21lL2Jlcm5hcmRvL3Npc3RlbWEtYXRlbmRpbWVudG8tdGkvQVROVEkvc3JjL21pZGRsZXdhcmVzLyIsInNvdXJjZXMiOlsiZXJyb3JNaWRkbGV3YXJlLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImZ1bmN0aW9uIGVycm9yTWlkZGxld2FyZShlcnIsIHJlcSwgcmVzLCBuZXh0KSB7XG4gIGNvbnNvbGUuZXJyb3IoZXJyLnN0YWNrKTsgLy8gUmVnaXN0cmEgbyBlcnJvIG5vIGNvbnNvbGVcbiAgXG4gIGlmIChlcnIubmFtZSA9PT0gJ1ZhbGlkYXRpb25FcnJvcicpIHtcbiAgICAvLyBFcnJvIGRlIHZhbGlkYcOnw6NvIEpvaVxuICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuanNvbih7IFxuICAgICAgZXJybzogXCJWYWxpZGHDp8OjbyBmYWxob3VcIiwgXG4gICAgICBkZXRhbGhlczogZXJyLmRldGFpbHMubWFwKGQgPT4gZC5tZXNzYWdlKVxuICAgIH0pO1xuICB9XG5cbiAgLy8gUmVzcG9zdGEgcGFkcsOjbyBwYXJhIHF1YWxxdWVyIG91dHJvIGVycm9cbiAgcmVzLnN0YXR1cyg1MDApLmpzb24oe1xuICAgIGVycm86ICdPY29ycmV1IHVtIGVycm8gaW50ZXJubyBkbyBzZXJ2aWRvci4nXG4gIH0pO1xufVxuXG5tb2R1bGUuZXhwb3J0cyA9IGVycm9yTWlkZGxld2FyZTsiXSwibWFwcGluZ3MiOiJBQUFBLFNBQVNBLGVBQWVBLENBQUNDLEdBQUcsRUFBRUMsR0FBRyxFQUFFQyxHQUFHLEVBQUVDLElBQUksRUFBRTtFQUM1Q0MsT0FBTyxDQUFDQyxLQUFLLENBQUNMLEdBQUcsQ0FBQ00sS0FBSyxDQUFDLENBQUMsQ0FBQzs7RUFFMUIsSUFBSU4sR0FBRyxDQUFDTyxJQUFJLEtBQUssaUJBQWlCLEVBQUU7SUFDbEM7SUFDQSxPQUFPTCxHQUFHLENBQUNNLE1BQU0sQ0FBQyxHQUFHLENBQUMsQ0FBQ0MsSUFBSSxDQUFDO01BQzFCQyxJQUFJLEVBQUUsa0JBQWtCO01BQ3hCQyxRQUFRLEVBQUVYLEdBQUcsQ0FBQ1ksT0FBTyxDQUFDQyxHQUFHLENBQUNDLENBQUMsSUFBSUEsQ0FBQyxDQUFDQyxPQUFPO0lBQzFDLENBQUMsQ0FBQztFQUNKOztFQUVBO0VBQ0FiLEdBQUcsQ0FBQ00sTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDQyxJQUFJLENBQUM7SUFDbkJDLElBQUksRUFBRTtFQUNSLENBQUMsQ0FBQztBQUNKO0FBRUFNLE1BQU0sQ0FBQ0MsT0FBTyxHQUFHbEIsZUFBZSIsImlnbm9yZUxpc3QiOltdfQ==","map":{"version":3,"names":["errorMiddleware","err","req","res","next","console","error","stack","name","status","json","erro","detalhes","details","map","d","message","module","exports"],"sourceRoot":"/home/bernardo/sistema-atendimento-ti/ATNTI/src/middlewares/","sources":["errorMiddleware.js"],"sourcesContent":["function errorMiddleware(err, req, res, next) {\n  console.error(err.stack); // Registra o erro no console\n  \n  if (err.name === 'ValidationError') {\n    // Erro de validação Joi\n    return res.status(400).json({ \n      erro: \"Validação falhou\", \n      detalhes: err.details.map(d => d.message)\n    });\n  }\n\n  // Resposta padrão para qualquer outro erro\n  res.status(500).json({\n    erro: 'Ocorreu um erro interno do servidor.'\n  });\n}\n\nmodule.exports = errorMiddleware;"],"mappings":"AAAA,SAASA,eAAeA,CAACC,GAAG,EAAEC,GAAG,EAAEC,GAAG,EAAEC,IAAI,EAAE;EAC5CC,OAAO,CAACC,KAAK,CAACL,GAAG,CAACM,KAAK,CAAC,CAAC,CAAC;;EAE1B,IAAIN,GAAG,CAACO,IAAI,KAAK,iBAAiB,EAAE;IAClC;IACA,OAAOL,GAAG,CAACM,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;MAC1BC,IAAI,EAAE,kBAAkB;MACxBC,QAAQ,EAAEX,GAAG,CAACY,OAAO,CAACC,GAAG,CAACC,CAAC,IAAIA,CAAC,CAACC,OAAO;IAC1C,CAAC,CAAC;EACJ;;EAEA;EACAb,GAAG,CAACM,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;IACnBC,IAAI,EAAE;EACR,CAAC,CAAC;AACJ;AAEAM,MAAM,CAACC,OAAO,GAAGlB,eAAe","ignoreList":[]}},"mtime":1754590468676}}